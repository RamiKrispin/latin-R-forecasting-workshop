<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rami Krispin">
<meta name="dcterms.date" content="2025-12-01">

<title>Modeling Trend</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="05_modeling_trend_files/libs/clipboard/clipboard.min.js"></script>
<script src="05_modeling_trend_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="05_modeling_trend_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="05_modeling_trend_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="05_modeling_trend_files/libs/quarto-html/popper.min.js"></script>
<script src="05_modeling_trend_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="05_modeling_trend_files/libs/quarto-html/anchor.min.js"></script>
<link href="05_modeling_trend_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05_modeling_trend_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="05_modeling_trend_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="05_modeling_trend_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="05_modeling_trend_files/libs/bootstrap/bootstrap-85c10ba73c7301af564f065c7ce6e7f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="05_modeling_trend_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="05_modeling_trend_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="05_modeling_trend_files/libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="05_modeling_trend_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="05_modeling_trend_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="05_modeling_trend_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="05_modeling_trend_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="05_modeling_trend_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="05_modeling_trend_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#modeling-linear-trend" id="toc-modeling-linear-trend" class="nav-link active" data-scroll-target="#modeling-linear-trend">Modeling Linear Trend</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#modeling-a-simple-trend" id="toc-modeling-a-simple-trend" class="nav-link" data-scroll-target="#modeling-a-simple-trend">Modeling a Simple Trend</a></li>
  <li><a href="#residuals-analysis" id="toc-residuals-analysis" class="nav-link" data-scroll-target="#residuals-analysis">Residuals Analysis</a></li>
  </ul></li>
  <li><a href="#create-a-forecast" id="toc-create-a-forecast" class="nav-link" data-scroll-target="#create-a-forecast">Create a Forecast</a></li>
  <li><a href="#improving-the-model" id="toc-improving-the-model" class="nav-link" data-scroll-target="#improving-the-model">Improving the model</a>
  <ul class="collapse">
  <li><a href="#piecewise-linear-trend" id="toc-piecewise-linear-trend" class="nav-link" data-scroll-target="#piecewise-linear-trend">Piecewise Linear Trend</a></li>
  <li><a href="#using-grid-search-to-identify-the-optimal-knots" id="toc-using-grid-search-to-identify-the-optimal-knots" class="nav-link" data-scroll-target="#using-grid-search-to-identify-the-optimal-knots">Using Grid Search to Identify the Optimal Knots</a></li>
  <li><a href="#ar-model" id="toc-ar-model" class="nav-link" data-scroll-target="#ar-model">AR model</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modeling Trend</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rami Krispin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 1, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>After reviewing the core methods for analyzing time series patterns using decomposition, correlation, and seasonal plots, in this notebook we will build our first forecasting model, focusing on modeling trend. To simplify the process, we will start with a time series that has <strong>no seasonal components or other complex patterns</strong>. Later, we will extend these ideas to series that include both trend and seasonality, as well as those affected by outliers.</p>
<section id="modeling-linear-trend" class="level2">
<h2 class="anchored" data-anchor-id="modeling-linear-trend">Modeling Linear Trend</h2>
<p>Before diving into the modeling process, let’s start with the definition of trend:</p>
<blockquote class="blockquote">
<p>A trend in a time series is the long-term, systematic movement or direction in the data over time. It reflects persistent increases or decreases in the series that are not due to short-term fluctuations, randomness, or seasonal patterns. Trends can be linear—changing at a constant rate—or nonlinear, accelerating or decelerating as time progresses. Identifying the trend helps isolate the underlying structural behavior of the series and forms the foundation for many forecasting models, especially those that assume the future will continue to follow the same long-term direction observed in the past.</p>
</blockquote>
<p>Trends can take linear or nonlinear forms. A linear trend has a constant rate of change, meaning that the series grows (or declines) by the same amount at each time step. From a mathematical perspective, a linear trend’s slope represents the <strong>marginal change in the series with respect to time</strong>.</p>
<p>Let’s load the California number of natural gas consumers and start building a forecasting model.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Let’s start by loading the required libraries and source the workshop functions:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"./functions.R"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next, let’s load the datasets:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"./data/ts.RData"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>And plot it:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ts1 <span class="ot">&lt;-</span> ts1 <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(index <span class="sc">&gt;</span> <span class="dv">1986</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_lines</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>y, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>, <span class="at">name =</span> <span class="st">"Actual"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    plotly<span class="sc">::</span><span class="fu">layout</span>(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Number of Natural Gas Consumers in California"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Number of Consumers"</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Period"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9172835a64f258121ad5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9172835a64f258121ad5">{"x":{"visdat":{"3fae75473045":["function () ","plotlyVisDat"]},"cur_data":"3fae75473045","attrs":{"3fae75473045":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Natural Gas Consumers in California","yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Consumers"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Period"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="modeling-a-simple-trend" class="level3">
<h3 class="anchored" data-anchor-id="modeling-a-simple-trend">Modeling a Simple Trend</h3>
<p>As mentioned above, trend is equivalent (when having linear trend) to the marginal change in the series over time. Therefore, to model the trend we can regress the series against the series index:</p>
<p><span class="math display">\[
Y \textasciitilde Index
\]</span></p>
<p>Where the Index is simply a vector if numbers that increase as a function of time:</p>
<p><span class="math display">\[
Index = [1,2,3,...N], ~for ~a ~series ~with ~N ~observations
\]</span></p>
<p>Let’s add to the series an trend feature:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ts1<span class="sc">$</span>trend <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ts1)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ts1 <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 6 x 4 [1Y]
  index       y series_id trend
  &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;
1  1987 7904858 SCA           1
2  1988 8113034 SCA           2
3  1989 8313776 SCA           3
4  1990 8497848 SCA           4
5  1991 8634774 SCA           5
6  1992 8680613 SCA           6</code></pre>
</div>
</div>
<p>Let’s now set a regression model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>md1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> trend, <span class="at">data =</span> ts1)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(md1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ trend, data = ts1)

Residuals:
    Min      1Q  Median      3Q     Max 
-312554 -102254  -20905  110378  341535 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8123398      55342  146.79   &lt;2e-16 ***
trend          94014       2474   38.01   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 167200 on 36 degrees of freedom
Multiple R-squared:  0.9757,    Adjusted R-squared:  0.975 
F-statistic:  1444 on 1 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We will fit the model on the series to see the trend fit:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> md1, <span class="at">newdata =</span> ts1, <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ts1<span class="sc">$</span>fit1 <span class="ot">&lt;-</span> fit1[, <span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_lines</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>fit1, <span class="at">mode =</span> <span class="st">"lines"</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>), <span class="at">name =</span> <span class="st">"Fitted"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9b9b7858e7f72b63308d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9b9b7858e7f72b63308d">{"x":{"visdat":{"3fae75473045":["function () ","plotlyVisDat"]},"cur_data":"3fae75473045","attrs":{"3fae75473045":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","inherit":true},"3fae75473045.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8217412.0769230779,8311425.7199912472,8405439.3630594164,8499453.0061275866,8593466.6491957549,8687480.2922639251,8781493.9353320953,8875507.5784002636,8969521.2214684337,9063534.8645366021,9157548.5076047722,9251562.1506729405,9345575.7937411107,9439589.4368092809,9533603.0798774492,9627616.7229456194,9721630.3660137877,9815644.0090819579,9909657.6521501262,10003671.295218296,10097684.938286467,10191698.581354635,10285712.224422805,10379725.867490973,10473739.510559143,10567753.153627314,10661766.796695482,10755780.439763652,10849794.08283182,10943807.725899991,11037821.368968159,11131835.012036329,11225848.655104499,11319862.298172668,11413875.941240838,11507889.584309006,11601903.227377176,11695916.870445345],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Natural Gas Consumers in California","yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Consumers"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Period"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8217412.0769230779,8311425.7199912472,8405439.3630594164,8499453.0061275866,8593466.6491957549,8687480.2922639251,8781493.9353320953,8875507.5784002636,8969521.2214684337,9063534.8645366021,9157548.5076047722,9251562.1506729405,9345575.7937411107,9439589.4368092809,9533603.0798774492,9627616.7229456194,9721630.3660137877,9815644.0090819579,9909657.6521501262,10003671.295218296,10097684.938286467,10191698.581354635,10285712.224422805,10379725.867490973,10473739.510559143,10567753.153627314,10661766.796695482,10755780.439763652,10849794.08283182,10943807.725899991,11037821.368968159,11131835.012036329,11225848.655104499,11319862.298172668,11413875.941240838,11507889.584309006,11601903.227377176,11695916.870445345],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="residuals-analysis" class="level3">
<h3 class="anchored" data-anchor-id="residuals-analysis">Residuals Analysis</h3>
<p>Once a linear regression model is fitted to a time series, residual analysis is essential for verifying whether the model has adequately captured the underlying structure of the data. The goal is to ensure that the remaining errors—what the model could not explain—behave like white noise: uncorrelated, constant-variance, zero-mean noise with no remaining pattern. If the residuals are not white noise, the model is missing structure such as trend, seasonality, or autocorrelation, and the forecasts may be biased or unreliable.</p>
<p>To evaluate these assumptions, we use a set of diagnostic plots:</p>
<p><strong>Actual vs Fitted Plot</strong></p>
<p>This plot compares the original series to the model’s fitted values.</p>
<ul>
<li><strong>Goal:</strong> Detect whether the model captured the main trend (and seasonality, if included).</li>
<li><strong>What to look for:</strong>
<ul>
<li>The fitted line should track the general shape of the actual data.</li>
<li>Systematic deviations—such as fitted values consistently lagging behind the actual series—suggest underfitting or missing components.</li>
</ul></li>
<li>Common issues revealed: Remaining trend, seasonal patterns, or structural changes.</li>
</ul>
<p><strong>Residuals ACF Plot</strong></p>
<p>The autocorrelation function (ACF) of residuals checks whether errors are correlated over time.</p>
<ul>
<li><strong>Goal:</strong> Verify the assumption of no autocorrelation in residuals.</li>
<li><strong>What to look for:</strong>
<ul>
<li>All autocorrelations should fall within the confidence bands (no significant spikes).</li>
<li>Significant autocorrelation indicates that: - the model did not fully capture the time dependence, or - additional lagged terms, ARIMA errors, or differencing may be needed.</li>
</ul></li>
<li><strong>Why it matters:</strong> Autocorrelated errors imply that the model’s predictions could be improved by modeling the remaining serial dependence.</li>
</ul>
<p><strong>Residual Distribution Plots (Density and Q-Q Plots)</strong></p>
<p>These plots assess whether residuals behave like noise with constant variance and approximately normal distribution.</p>
<ul>
<li><strong>Density Plot:</strong>
<ul>
<li>Shows the empirical distribution of residuals.</li>
<li><strong>Goal:</strong> Check for skewness, heavy tails, or multimodality.</li>
<li><strong>What to look for:</strong> A roughly symmetric, bell-shaped curve.</li>
</ul></li>
<li><strong>Q-Q Plot:</strong>
<ul>
<li>Compares the residuals to a theoretical normal distribution.</li>
<li><strong>Goal:</strong> Assess normality and identify outliers.</li>
<li><strong>What to look for:</strong> Points lying close to the diagonal line.</li>
<li>Common issues revealed:
<ul>
<li>Heavy tails → potential outliers</li>
<li>Systematic curvature → non-normal residuals or model misspecification</li>
</ul></li>
</ul></li>
</ul>
<p>Let’s start by calculating the model residuals:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ts1<span class="sc">$</span>res1 <span class="ot">&lt;-</span> ts1<span class="sc">$</span>y <span class="sc">-</span> ts1<span class="sc">$</span>fit1</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>res1, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"markers"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-161bfeb2ed2a412c2eab" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-161bfeb2ed2a412c2eab">{"x":{"visdat":{"3fae1e67694d":["function () ","plotlyVisDat"]},"cur_data":"3fae1e67694d","attrs":{"3fae1e67694d":{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-312554.07692307793,-198391.71999124717,-91663.363059416413,-1605.0061275865883,41307.350804245099,-6867.2922639250755,-55306.93533209525,-84774.578400263563,-103980.22146843374,-94226.86453660205,-97075.507604772225,-69634.150672940537,-14369.793741110712,-68792.436809280887,69518.9201225508,99025.277054380625,81680.633986212313,141767.99091804214,214775.34784987383,325552.70478170365,341535.06171353348,323463.41864536516,225237.77557719499,162858.13250902668,151450.4894408565,114162.84637268633,93141.203304518014,25939.560236347839,119802.91716817953,-27439.725899990648,-32968.36896815896,-106046.01203632914,-113754.65510449931,-133512.29817266762,-181323.9412408378,-227560.58430900611,-242091.22737717628,-267280.8704453446],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":[]},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-312554.07692307793,-198391.71999124717,-91663.363059416413,-1605.0061275865883,41307.350804245099,-6867.2922639250755,-55306.93533209525,-84774.578400263563,-103980.22146843374,-94226.86453660205,-97075.507604772225,-69634.150672940537,-14369.793741110712,-68792.436809280887,69518.9201225508,99025.277054380625,81680.633986212313,141767.99091804214,214775.34784987383,325552.70478170365,341535.06171353348,323463.41864536516,225237.77557719499,162858.13250902668,151450.4894408565,114162.84637268633,93141.203304518014,25939.560236347839,119802.91716817953,-27439.725899990648,-32968.36896815896,-106046.01203632914,-113754.65510449931,-133512.29817266762,-181323.9412408378,-227560.58430900611,-242091.22737717628,-267280.8704453446],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>If would be nice to add the standard deviation of the residuals:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residual standard deviation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sd_res1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(ts1<span class="sc">$</span>res1)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>res1, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"markers"</span>, <span class="at">name =</span> <span class="st">"Residuals"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add +2SD line</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_segments</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">min</span>(ts1<span class="sc">$</span>index), <span class="at">xend =</span> <span class="fu">max</span>(ts1<span class="sc">$</span>index),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="dv">2</span> <span class="sc">*</span> sd_res1, <span class="at">yend =</span> <span class="dv">2</span> <span class="sc">*</span> sd_res1,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"+2SD"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">TRUE</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add -2SD line</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_segments</span>(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">min</span>(ts1<span class="sc">$</span>index), <span class="at">xend =</span> <span class="fu">max</span>(ts1<span class="sc">$</span>index),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sd_res1, <span class="at">yend =</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sd_res1,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"-2SD"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legendgroup =</span> <span class="st">"2SD"</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add +3SD line</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_segments</span>(</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">min</span>(ts1<span class="sc">$</span>index), <span class="at">xend =</span> <span class="fu">max</span>(ts1<span class="sc">$</span>index),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="dv">3</span> <span class="sc">*</span> sd_res1, <span class="at">yend =</span> <span class="dv">3</span> <span class="sc">*</span> sd_res1,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"+3SD"</span>,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">TRUE</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add -3SD line</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_segments</span>(</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">min</span>(ts1<span class="sc">$</span>index), <span class="at">xend =</span> <span class="fu">max</span>(ts1<span class="sc">$</span>index),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">*</span> sd_res1, <span class="at">yend =</span> <span class="sc">-</span><span class="dv">3</span> <span class="sc">*</span> sd_res1,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"-3SD"</span>,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">legendgroup =</span> <span class="st">"3SD"</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    plotly<span class="sc">::</span><span class="fu">layout</span>(</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Residuals"</span>),</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Index"</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-14c2a28922480c2c7fc9" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-14c2a28922480c2c7fc9">{"x":{"visdat":{"3fae1b1514d6":["function () ","plotlyVisDat"]},"cur_data":"3fae1b1514d6","attrs":{"3fae1b1514d6":{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-312554.07692307793,-198391.71999124717,-91663.363059416413,-1605.0061275865883,41307.350804245099,-6867.2922639250755,-55306.93533209525,-84774.578400263563,-103980.22146843374,-94226.86453660205,-97075.507604772225,-69634.150672940537,-14369.793741110712,-68792.436809280887,69518.9201225508,99025.277054380625,81680.633986212313,141767.99091804214,214775.34784987383,325552.70478170365,341535.06171353348,323463.41864536516,225237.77557719499,162858.13250902668,151450.4894408565,114162.84637268633,93141.203304518014,25939.560236347839,119802.91716817953,-27439.725899990648,-32968.36896815896,-106046.01203632914,-113754.65510449931,-133512.29817266762,-181323.9412408378,-227560.58430900611,-242091.22737717628,-267280.8704453446],"mode":"markers","name":"Residuals","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3fae1b1514d6.1":{"x":1987,"y":329887.53739538434,"mode":"lines","name":"+2SD","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","xend":2024,"yend":329887.53739538434,"line":{"color":"orange","dash":"dash","width":2},"showlegend":true,"inherit":true},"3fae1b1514d6.2":{"x":1987,"y":-329887.53739538434,"mode":"lines","name":"-2SD","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","xend":2024,"yend":-329887.53739538434,"line":{"color":"orange","dash":"dash","width":2},"showlegend":false,"legendgroup":"2SD","inherit":true},"3fae1b1514d6.3":{"x":1987,"y":494831.30609307648,"mode":"lines","name":"+3SD","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","xend":2024,"yend":494831.30609307648,"line":{"color":"red","dash":"dash","width":2},"showlegend":true,"inherit":true},"3fae1b1514d6.4":{"x":1987,"y":-494831.30609307648,"mode":"lines","name":"-3SD","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","xend":2024,"yend":-494831.30609307648,"line":{"color":"red","dash":"dash","width":2},"showlegend":false,"legendgroup":"3SD","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Index"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-312554.07692307793,-198391.71999124717,-91663.363059416413,-1605.0061275865883,41307.350804245099,-6867.2922639250755,-55306.93533209525,-84774.578400263563,-103980.22146843374,-94226.86453660205,-97075.507604772225,-69634.150672940537,-14369.793741110712,-68792.436809280887,69518.9201225508,99025.277054380625,81680.633986212313,141767.99091804214,214775.34784987383,325552.70478170365,341535.06171353348,323463.41864536516,225237.77557719499,162858.13250902668,151450.4894408565,114162.84637268633,93141.203304518014,25939.560236347839,119802.91716817953,-27439.725899990648,-32968.36896815896,-106046.01203632914,-113754.65510449931,-133512.29817266762,-181323.9412408378,-227560.58430900611,-242091.22737717628,-267280.8704453446],"mode":"markers","name":"Residuals","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[329887.53739538434,329887.53739538434],"mode":"lines","name":"+2SD","type":"scatter","line":{"color":"orange","dash":"dash","width":2},"showlegend":true,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-329887.53739538434,-329887.53739538434],"mode":"lines","name":"-2SD","type":"scatter","line":{"color":"orange","dash":"dash","width":2},"showlegend":false,"legendgroup":"2SD","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[494831.30609307648,494831.30609307648],"mode":"lines","name":"+3SD","type":"scatter","line":{"color":"red","dash":"dash","width":2},"showlegend":true,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-494831.30609307648,-494831.30609307648],"mode":"lines","name":"-3SD","type":"scatter","line":{"color":"red","dash":"dash","width":2},"showlegend":false,"legendgroup":"3SD","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Clearly, you can see that some patterns are left in the residuals.</p>
<p>We can check for autocorrelation:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_acf</span>(<span class="at">ts =</span> ts1, <span class="at">var =</span> <span class="st">"res1"</span>, <span class="at">lag_max =</span> <span class="dv">60</span>, <span class="at">frequency =</span> <span class="cn">NULL</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8fcec668c5c7ac88cde8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8fcec668c5c7ac88cde8">{"x":{"visdat":{"3fae2f7c0fff":["function () ","plotlyVisDat"]},"cur_data":"3fae2f7c0fff","attrs":{"3fae2f7c0fff":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"3fae2f7c0fff.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"y":[0.84106695903932094,0.69215584847461842,0.53287040389823059,0.41069392156023093,0.31467311938832782,0.20503769031164124,0.088056712076365451,-0.025316009257497756,-0.13962684591972827,-0.21638408251867078,-0.31546769074676156,-0.38591625499318299,-0.41902541757658013,-0.46383024933849049,-0.47451018399032402,-0.44564771369940032,-0.42756950491400458,-0.39209634195421278,-0.34299543148521044,-0.27316619199985115,-0.19026493937121877,-0.10796531154420531,-0.038073018734628462,0.016995521872731331,0.031419816080256839,0.053832986026086473,0.061858308250549297,0.046776121910335922,0.081112641237364641,0.071629615963049814,0.074790877833544586,0.070396234969657717,0.087330099643598363,0.12361890813003673,0.14270638581165354,0.1278442137075787,0.082988801858789013],"name":"Lags","marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"inherit":true},"3fae2f7c0fff.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":0.31794814293719936,"xend":{},"yend":0.31794814293719936,"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":true,"legendgroup":"ci","inherit":true},"3fae2f7c0fff.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":-0.31794814293719936,"xend":{},"yend":-0.31794814293719936,"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"legendgroup":"ci","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"ACF"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Lags"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"y":[0.84106695903932094,0.69215584847461842,0.53287040389823059,0.41069392156023093,0.31467311938832782,0.20503769031164124,0.088056712076365451,-0.025316009257497756,-0.13962684591972827,-0.21638408251867078,-0.31546769074676156,-0.38591625499318299,-0.41902541757658013,-0.46383024933849049,-0.47451018399032402,-0.44564771369940032,-0.42756950491400458,-0.39209634195421278,-0.34299543148521044,-0.27316619199985115,-0.19026493937121877,-0.10796531154420531,-0.038073018734628462,0.016995521872731331,0.031419816080256839,0.053832986026086473,0.061858308250549297,0.046776121910335922,0.081112641237364641,0.071629615963049814,0.074790877833544586,0.070396234969657717,0.087330099643598363,0.12361890813003673,0.14270638581165354,0.1278442137075787,0.082988801858789013],"name":"Lags","marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","x":[1,37],"y":[0.31794814293719936,0.31794814293719936],"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":true,"legendgroup":"ci","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","x":[1,37],"y":[-0.31794814293719936,-0.31794814293719936],"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"legendgroup":"ci","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The ACF plot indicates that the residuals have a high correlation with the first lags. This is classic case, that adding an ARIMA model (i.e., regression with ARIMA errors) could improve the fit of the model.</p>
<p>The last component that we want to check is the distribution of the residual:</p>
<section id="residual-distribution" class="level4">
<h4 class="anchored" data-anchor-id="residual-distribution">Residual Distribution</h4>
<p>Let’s create a density plot to evaluate if the residuals are normally distributed:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate density</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>density_res <span class="ot">&lt;-</span> <span class="fu">density</span>(ts1<span class="sc">$</span>res1)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plot</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>p_density <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> density_res<span class="sc">$</span>x,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> density_res<span class="sc">$</span>y,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"lines"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"tozeroy"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillcolor =</span> <span class="st">"rgba(0, 114, 181, 0.3)"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#0072B5"</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Residual Density"</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    plotly<span class="sc">::</span><span class="fu">layout</span>(</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Distribution of Residuals"</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Residuals"</span>),</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Density"</span>),</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">TRUE</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay normal distribution for comparison</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>mean_res <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts1<span class="sc">$</span>res1)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>sd_res <span class="ot">&lt;-</span> <span class="fu">sd</span>(ts1<span class="sc">$</span>res1)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>x_norm <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(ts1<span class="sc">$</span>res1), <span class="fu">max</span>(ts1<span class="sc">$</span>res1), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>y_norm <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_norm, <span class="at">mean =</span> mean_res, <span class="at">sd =</span> sd_res)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>p_density <span class="ot">&lt;-</span> p_density <span class="sc">|&gt;</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> x_norm,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> y_norm,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"lines"</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Normal Distribution"</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>p_density</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-dd57cab81bd59ec3ac7b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-dd57cab81bd59ec3ac7b">{"x":{"visdat":{"3fae5a5aa9b9":["function () ","plotlyVisDat"]},"cur_data":"3fae5a5aa9b9","attrs":{"3fae5a5aa9b9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-519535.74651958392,-517445.62425377255,-515355.50198796112,-513265.37972214975,-511175.25745633832,-509085.13519052695,-506995.01292471553,-504904.89065890416,-502814.76839309273,-500724.64612728136,-498634.52386146993,-496544.40159565856,-494454.2793298472,-492364.15706403577,-490274.0347982244,-488183.91253241297,-486093.7902666016,-484003.66800079017,-481913.5457349788,-479823.42346916738,-477733.30120335601,-475643.17893754458,-473553.05667173321,-471462.93440592178,-469372.81214011041,-467282.68987429899,-465192.56760848762,-463102.44534267625,-461012.32307686482,-458922.20081105345,-456832.07854524202,-454741.95627943065,-452651.83401361923,-450561.71174780786,-448471.58948199643,-446381.46721618506,-444291.34495037363,-442201.22268456226,-440111.1004187509,-438020.97815293947,-435930.85588712804,-433840.73362131667,-431750.6113555053,-429660.48908969387,-427570.3668238825,-425480.24455807108,-423390.12229225971,-421300.00002644828,-419209.87776063691,-417119.75549482554,-415029.63322901411,-412939.51096320269,-410849.38869739132,-408759.26643157995,-406669.14416576852,-404579.02189995715,-402488.89963414572,-400398.77736833435,-398308.65510252293,-396218.53283671156,-394128.41057090013,-392038.28830508876,-389948.16603927733,-387858.04377346596,-385767.9215076546,-383677.79924184317,-381587.67697603174,-379497.55471022037,-377407.432444409,-375317.31017859757,-373227.18791278615,-371137.06564697484,-369046.94338116341,-366956.82111535198,-364866.69884954061,-362776.57658372924,-360686.45431791781,-358596.33205210639,-356506.20978629502,-354416.08752048365,-352325.96525467222,-350235.84298886079,-348145.72072304942,-346055.59845723805,-343965.47619142663,-341875.35392561526,-339785.23165980389,-337695.10939399246,-335604.98712818103,-333514.86486236966,-331424.7425965583,-329334.62033074687,-327244.49806493544,-325154.37579912407,-323064.2535333127,-320974.13126750127,-318884.0090016899,-316793.88673587854,-314703.76447006711,-312613.64220425568,-310523.51993844431,-308433.39767263294,-306343.27540682151,-304253.15314101009,-302163.03087519872,-300072.90860938735,-297982.78634357592,-295892.66407776449,-293802.54181195312,-291712.41954614175,-289622.29728033033,-287532.17501451896,-285442.05274870759,-283351.93048289616,-281261.80821708473,-279171.68595127336,-277081.563685462,-274991.44141965057,-272901.31915383914,-270811.19688802777,-268721.0746222164,-266630.95235640497,-264540.8300905936,-262450.70782478224,-260360.58555897081,-258270.46329315941,-256180.34102734801,-254090.21876153658,-252000.09649572521,-249909.97422991385,-247819.85196410242,-245729.72969829105,-243639.60743247962,-241549.48516666825,-239459.36290085682,-237369.24063504545,-235279.11836923403,-233188.99610342266,-231098.87383761123,-229008.75157179986,-226918.62930598843,-224828.50704017706,-222738.3847743657,-220648.26250855427,-218558.1402427429,-216468.01797693147,-214377.8957111201,-212287.77344530867,-210197.6511794973,-208107.52891368588,-206017.40664787451,-203927.28438206308,-201837.16211625171,-199747.03985044028,-197656.91758462891,-195566.79531881755,-193476.67305300612,-191386.55078719475,-189296.42852138332,-187206.30625557195,-185116.18398976052,-183026.06172394915,-180935.93945813773,-178845.81719232636,-176755.69492651493,-174665.57266070356,-172575.45039489213,-170485.32812908076,-168395.2058632694,-166305.08359745797,-164214.9613316466,-162124.83906583517,-160034.7168000238,-157944.59453421237,-155854.472268401,-153764.35000258958,-151674.22773677821,-149584.10547096678,-147493.98320515541,-145403.86093934398,-143313.73867353261,-141223.61640772125,-139133.49414190982,-137043.37187609845,-134953.24961028702,-132863.12734447565,-130773.00507866422,-128682.88281285285,-126592.76054704143,-124502.63828123006,-122412.51601541863,-120322.39374960726,-118232.27148379589,-116142.14921798446,-114052.0269521731,-111961.90468636167,-109871.7824205503,-107781.66015473887,-105691.5378889275,-103601.41562311607,-101511.2933573047,-99421.171091493277,-97331.048825681908,-95240.926559870481,-93150.804294059111,-91060.682028247742,-88970.559762436314,-86880.437496624945,-84790.315230813518,-82700.192965002148,-80610.070699190721,-78519.948433379352,-76429.826167567924,-74339.703901756555,-72249.581635945127,-70159.459370133758,-68069.337104322331,-65979.214838510961,-63889.092572699592,-61798.970306888164,-59708.848041076795,-57618.725775265368,-55528.603509453998,-53438.481243642571,-51348.358977831202,-49258.236712019774,-47168.114446208405,-45077.992180396977,-42987.869914585608,-40897.747648774181,-38807.625382962811,-36717.503117151442,-34627.380851340014,-32537.258585528645,-30447.136319717218,-28357.014053905848,-26266.891788094421,-24176.769522283052,-22086.647256471624,-19996.524990660255,-17906.402724848827,-15816.280459037458,-13726.158193226031,-11636.035927414661,-9545.913661603292,-7455.7913957918645,-5365.6691299804952,-3275.5468641690677,-1185.4245983576984,904.69766745372908,2994.8199332650984,5084.9421990764677,7175.0644648878952,9265.1867306993227,11355.30899651075,13445.431262322061,15535.553528133489,17625.675793944916,19715.798059756227,21805.920325567655,23896.042591379082,25986.16485719051,28076.287123001821,30166.409388813248,32256.531654624676,34346.653920436103,36436.776186247414,38526.898452058842,40617.020717870269,42707.142983681581,44797.265249493008,46887.387515304436,48977.509781115863,51067.632046927174,53157.754312738602,55247.876578550029,57337.998844361457,59428.121110172768,61518.243375984195,63608.365641795623,65698.48790760705,67788.610173418361,69878.732439229789,71968.854705041216,74058.976970852527,76149.099236663955,78239.221502475382,80329.34376828681,82419.466034098121,84509.588299909548,86599.710565720976,88689.832831532403,90779.955097343714,92870.077363155142,94960.199628966569,97050.321894777881,99140.444160589308,101230.56642640074,103320.68869221216,105410.81095802347,107500.9332238349,109591.05548964633,111681.17775545776,113771.30002126907,115861.4222870805,117951.54455289192,120041.66681870335,122131.78908451466,124221.91135032609,126312.03361613752,128402.15588194883,130492.27814776025,132582.40041357168,134672.52267938311,136762.64494519442,138852.76721100585,140942.88947681728,143033.0117426287,145123.13400844001,147213.25627425144,149303.37854006287,151393.50080587418,153483.62307168561,155573.74533749704,157663.86760330846,159753.98986911977,161844.1121349312,163934.23440074263,166024.35666655406,168114.47893236537,170204.6011981768,172294.72346398822,174384.84572979965,176474.96799561096,178565.09026142239,180655.21252723382,182745.33479304513,184835.45705885655,186925.57932466798,189015.70159047941,191105.82385629072,193195.94612210215,195286.06838791358,197376.190653725,199466.31291953631,201556.43518534774,203646.55745115917,205736.67971697048,207826.80198278191,209916.92424859334,212007.04651440476,214097.16878021607,216187.2910460275,218277.41331183893,220367.53557765036,222457.65784346167,224547.7801092731,226637.90237508452,228728.02464089595,230818.14690670726,232908.26917251869,234998.39143833012,237088.51370414143,239178.63596995285,241268.75823576428,243358.88050157571,245449.00276738702,247539.12503319845,249629.24729900988,251719.3695648213,253809.49183063261,255899.61409644404,257989.73636225547,260079.85862806678,262169.98089387821,264260.10315968964,266350.22542550106,268440.34769131237,270530.4699571238,272620.59222293523,274710.71448874666,276800.83675455797,278890.9590203694,280981.08128618082,283071.20355199213,285161.32581780356,287251.44808361499,289341.57034942642,291431.69261523773,293521.81488104915,295611.93714686058,297702.05941267201,299792.18167848332,301882.30394429475,303972.42621010618,306062.5484759176,308152.67074172891,310242.79300754034,312332.91527335177,314423.03753916308,316513.15980497451,318603.28207078594,320693.40433659736,322783.52660240867,324873.6488682201,326963.77113403153,329053.89339984296,331144.01566565427,333234.1379314657,335324.26019727712,337414.38246308843,339504.50472889986,341594.62699471129,343684.74926052272,345774.87152633403,347864.99379214545,349955.11605795688,352045.23832376831,354135.36058957962,356225.48285539105,358315.60512120248,360405.7273870139,362495.84965282521,364585.97191863664,366676.09418444807,368766.21645025938,370856.33871607081,372946.46098188224,375036.58324769366,377126.70551350497,379216.8277793164,381306.95004512783,383397.07231093926,385487.19457675057,387577.316842562,389667.43910837342,391757.56137418473,393847.68363999616,395937.80590580759,398027.92817161902,400118.05043743033,402208.17270324175,404298.29496905318,406388.41723486461,408478.53950067592,410568.66176648735,412658.78403229878,414748.9062981102,416839.02856392151,418929.15082973294,421019.27309554437,423109.39536135568,425199.51762716711,427289.63989297854,429379.76215878996,431469.88442460127,433560.0066904127,435650.12895622413,437740.25122203556,439830.37348784687,441920.4957536583,444010.61801946972,446100.74028528103,448190.86255109246,450280.98481690389,452371.10708271532,454461.22934852663,456551.35161433805,458641.47388014948,460731.59614596091,462821.71841177222,464911.84067758365,467001.96294339508,469092.0852092065,471182.20747501781,473272.32974082924,475362.45200664067,477452.57427245198,479542.69653826341,481632.81880407484,483722.94106988626,485813.06333569757,487903.185601509,489993.30786732043,492083.43013313186,494173.55239894317,496263.6746647546,498353.79693056602,500443.91919637733,502534.04146218876,504624.16372800019,506714.28599381162,508804.40825962293,510894.53052543435,512984.65279124578,515074.77505705721,517164.89732286852,519255.01958867995,521345.14185449138,523435.2641203028,525525.38638611417,527615.50865192548,529705.63091773679,531795.75318354834,533885.87544935965,535975.99771517096,538066.1199809825,540156.24224679382,542246.36451260536,544336.48677841667,546426.60904422798,548516.73131003953],"y":[1.9561490074985769e-09,2.150976313182825e-09,2.3605984942801456e-09,2.5830966048687359e-09,2.8337021511155475e-09,3.1015746137227141e-09,3.3853018561392059e-09,3.7049769688081032e-09,4.0445354344595857e-09,4.4044616316881577e-09,4.8078533620001899e-09,5.2348367150539579e-09,5.6882795820565756e-09,6.1926165611100487e-09,6.725254859913155e-09,7.29181234127371e-09,7.9173276350411319e-09,8.5764940355563244e-09,9.2785854623576856e-09,1.0048240039646544e-08,1.0857552304440365e-08,1.1720508679555665e-08,1.266004406751079e-08,1.3645900697860433e-08,1.4697978608304711e-08,1.5835892530482927e-08,1.7027428643881897e-08,1.8299731453733337e-08,1.9667162209665866e-08,2.109611122067015e-08,2.2622402596270251e-08,2.4252909614924846e-08,2.5953358656104927e-08,2.7769755986854629e-08,2.9698986639874843e-08,3.1707016520543415e-08,3.3851555444567874e-08,3.6116791827209995e-08,3.846999614573211e-08,4.0982062110970179e-08,4.3621646009071661e-08,4.6358528715698186e-08,4.9278157160364367e-08,5.233079667056896e-08,5.5490052758567912e-08,5.8857105856686012e-08,6.2361072901012062e-08,6.598076275940503e-08,6.9833997455398149e-08,7.3826231465480107e-08,7.7942865483966884e-08,8.2318914395417046e-08,8.6834053439408773e-08,9.1484288987991286e-08,9.6413902752147847e-08,1.0148326903133722e-07,1.0670491846283088e-07,1.1220983306056878e-07,1.1786040472008449e-07,1.2368002933721798e-07,1.2978325546741069e-07,1.3603666078868971e-07,1.4247490185740539e-07,1.4919336496864269e-07,1.5606493803615682e-07,1.6313553028045563e-07,1.704792006492009e-07,1.7797713936799104e-07,1.8568604961862054e-07,1.9365720698383544e-07,2.0178187478731826e-07,2.1012661164462935e-07,2.1871928518812267e-07,2.2746269688875513e-07,2.36431835767674e-07,2.4563145827985524e-07,2.5497698828302516e-07,2.64549953167141e-07,2.7433326495427227e-07,2.8425561249150722e-07,2.944027511465122e-07,3.047379846203347e-07,3.1520342575853823e-07,3.2588640902599371e-07,3.3673377893860856e-07,3.4770072884764426e-07,3.5887329689068434e-07,3.7018581375922783e-07,3.8160571498371432e-07,3.9321478386239818e-07,4.0493939914751848e-07,4.1675794230115317e-07,4.2874507285069953e-07,4.4082415376396414e-07,4.529828259987446e-07,4.652860435006213e-07,4.7765916278792252e-07,4.9009710646383933e-07,5.0265304393002184e-07,5.1525905555228696e-07,5.2791781115052027e-07,5.4066152477618557e-07,5.5344088016820245e-07,5.6626005332519228e-07,5.7913435651465891e-07,5.9203159834487631e-07,6.0495538224168917e-07,6.1790961419686537e-07,6.3087596585237859e-07,6.438563804505104e-07,6.5684855485063692e-07,6.6984450513381046e-07,6.8284414614428264e-07,6.9584345503721868e-07,7.088412200229328e-07,7.2183583094257771e-07,7.3482492375795454e-07,7.4781065297096547e-07,7.6079136805122666e-07,7.7376826426214376e-07,7.8674384807000118e-07,7.9971894456947661e-07,8.1269843312989377e-07,8.2568276438661595e-07,8.386787610779239e-07,8.5169314222081274e-07,8.6472268954557021e-07,8.7778463724324145e-07,8.9088367414147068e-07,9.0401223830043292e-07,9.1720306875969484e-07,9.3045303907062151e-07,9.4375058877298668e-07,9.5714942158512648e-07,9.7063119248879512e-07,9.8418171181955126e-07,9.9788106485093643e-07,1.0116871594571537e-06,1.0255854855671611e-06,1.0396873918664246e-06,1.0539180684236783e-06,1.0682657533921163e-06,1.0828768538925786e-06,1.0976352796595888e-06,1.1125408443387925e-06,1.127761325125453e-06,1.1431479906559789e-06,1.1587184938672267e-06,1.174638317880493e-06,1.1907449005916408e-06,1.2070717804850032e-06,1.2237717601976368e-06,1.2406747036546176e-06,1.2578314413298e-06,1.2753722184734416e-06,1.2931263408517179e-06,1.3111616762979692e-06,1.3295775795948575e-06,1.3482100565348269e-06,1.3671417303077215e-06,1.3864352859973531e-06,1.4059403655064693e-06,1.4257497838098696e-06,1.4458872314459893e-06,1.4662220287289641e-06,1.4868502299692605e-06,1.507758367606122e-06,1.5288400543355543e-06,1.5501853082372178e-06,1.5717499393104394e-06,1.5934545852941927e-06,1.6153718825574337e-06,1.637438063422728e-06,1.6596013111898512e-06,1.6819039059695101e-06,1.7042781019932137e-06,1.7266977606614369e-06,1.7491608155226633e-06,1.7716149702873339e-06,1.794055509949364e-06,1.8164217708352201e-06,1.838699184180399e-06,1.8608980029018764e-06,1.8828853086271922e-06,1.9047081123928943e-06,1.9263833423405452e-06,1.9476936582415387e-06,1.9687715813516104e-06,1.9896294332381669e-06,2.0099606734437612e-06,2.0300007074528452e-06,2.0497271439045574e-06,2.0688021051679907e-06,2.0875186235242954e-06,2.105821572012006e-06,2.1233667855490518e-06,2.1404916388143782e-06,2.1571002928819073e-06,2.1728672268241329e-06,2.1881593340763924e-06,2.2028342041245332e-06,2.2166081638600554e-06,2.2298621473509677e-06,2.2424039299676696e-06,2.2540116832531071e-06,2.2650651467490059e-06,2.2753219909375625e-06,2.2846377753602342e-06,2.2933769021315059e-06,2.3012497431421739e-06,2.3081994026155032e-06,2.3145626409063204e-06,2.3200083811300636e-06,2.3245714781855919e-06,2.3285511833846085e-06,2.3315836166826587e-06,2.333793471264966e-06,2.3354354777977335e-06,2.3361239703870109e-06,2.3360656767659215e-06,2.3354668721659583e-06,2.3339329221012026e-06,2.3317394872964427e-06,2.3290435501137979e-06,2.3254554421617019e-06,2.3213022671052646e-06,2.3166938047495091e-06,2.3112596534658189e-06,2.3053576387482768e-06,2.2990550181091231e-06,2.2920145466243224e-06,2.284602146495815e-06,2.2768493479829207e-06,2.2684647827653679e-06,2.2597993540919725e-06,2.250845490496489e-06,2.2414036727102859e-06,2.2317524711708186e-06,2.2218690146580276e-06,2.2116454225323258e-06,2.2012765888154075e-06,2.1907399058874812e-06,2.1799976920799213e-06,2.1691715491105288e-06,2.158247244834633e-06,2.1472354343877971e-06,2.1361963857287604e-06,2.1251308559428015e-06,2.1140768795591026e-06,2.1030461619324796e-06,2.0920591543771809e-06,2.0811624052080037e-06,2.0703319069181052e-06,2.0596103118035894e-06,2.0490369036929686e-06,2.0385642173370903e-06,2.0282572581345278e-06,2.0181361188904025e-06,2.0081409522089213e-06,1.9983568967136953e-06,1.9887772849615282e-06,1.9793393085682318e-06,1.970143768999066e-06,1.9611542577717638e-06,1.9523124230396634e-06,1.9437282622964297e-06,1.9353371868486731e-06,1.9270905015243789e-06,1.919099310892479e-06,1.9112766325048945e-06,1.9035863359385783e-06,1.8961313979320592e-06,1.8888118901969646e-06,1.8816049249883079e-06,1.8745955245716957e-06,1.8676831447670671e-06,1.8608567781747875e-06,1.8541736777687759e-06,1.84754694484657e-06,1.8409750997520386e-06,1.8344762034713897e-06,1.8279943677425132e-06,1.8215307021308092e-06,1.81506138409459e-06,1.8085711439791838e-06,1.8020545530714105e-06,1.7954564347581632e-06,1.788798935113884e-06,1.782064530105349e-06,1.7751790784022382e-06,1.7681969148378211e-06,1.7610834862351708e-06,1.753758841125624e-06,1.7463027967402487e-06,1.7386598987029664e-06,1.7307572295524683e-06,1.7226924853623221e-06,1.7143868609438321e-06,1.7057860127971526e-06,1.6969976004653787e-06,1.6879187029726029e-06,1.678522930740842e-06,1.6689202348913909e-06,1.6589846482797302e-06,1.6487242828432552e-06,1.6382444480582762e-06,1.6273990664692595e-06,1.6162340097520531e-06,1.6048441613895615e-06,1.593068050888758e-06,1.5809890534760471e-06,1.5686872982230553e-06,1.5559922282566654e-06,1.5430209594424775e-06,1.5298361873322116e-06,1.5162658810276772e-06,1.5024538536511108e-06,1.4884444145300522e-06,1.4740726216659249e-06,1.4594990794743127e-06,1.4447504504689682e-06,1.4296779913902085e-06,1.4144469024021656e-06,1.3990684964214649e-06,1.3834194570730029e-06,1.3676557808862636e-06,1.3517710494594773e-06,1.3356943447256241e-06,1.3195397543750397e-06,1.3032983207313686e-06,1.2869462757720948e-06,1.2705545161335006e-06,1.254118214135938e-06,1.2376506659057981e-06,1.2211827222936844e-06,1.2047195273747105e-06,1.1882998115117993e-06,1.17191904634731e-06,1.1555978779204642e-06,1.139388033399567e-06,1.1232554284325317e-06,1.1072411096151093e-06,1.0913972810823886e-06,1.0756669005801446e-06,1.0601153957854389e-06,1.0447835322541519e-06,1.0295983015459298e-06,1.0146523296109689e-06,9.9996425954798861e-07,9.8545213551525484e-07,9.7123723754136183e-07,9.5730718613099634e-07,9.4357778303652463e-07,9.30198911271061e-07,9.1712051642158711e-07,9.0426224229044887e-07,8.9180092922085575e-07,8.7964480830312697e-07,8.6772256333757849e-07,8.5623472759605564e-07,8.4504664567891794e-07,8.3410013344976692e-07,8.2361457905661027e-07,8.1341426952039036e-07,8.0345697180707871e-07,7.9397463698087224e-07,7.8475532442026199e-07,7.7577418909678264e-07,7.6726819737109359e-07,7.5899686816128812e-07,7.5096049867210259e-07,7.4336931098263435e-07,7.3598776662492345e-07,7.2883747281581141e-07,7.2207683902970702e-07,7.1550354994221354e-07,7.0914874961095759e-07,7.0312098308525331e-07,6.972537353431634e-07,6.9158297409221663e-07,6.8617223306783554e-07,6.8089152832125566e-07,6.7577634827420534e-07,6.7085256963775112e-07,6.6602570077469761e-07,6.6132521397633221e-07,6.5674863558003453e-07,6.5223432039553269e-07,6.4780034192810992e-07,6.4342646446816085e-07,6.3907988013338727e-07,6.3476243240169874e-07,6.3044723569907023e-07,6.261252620613025e-07,6.2177822506130636e-07,6.1738342519856445e-07,6.1294987869534351e-07,6.0843653573962043e-07,6.0383465233701955e-07,5.991652778919446e-07,5.9436349579459823e-07,5.8944249538608578e-07,5.8442948348586009e-07,5.7923627294502563e-07,5.7390356640683854e-07,5.6845937784552868e-07,5.6279460447399238e-07,5.5698020386272772e-07,5.5104051519180606e-07,5.4484957339119613e-07,5.3850825503160989e-07,5.3203388195981721e-07,5.2528919999741049e-07,5.184015735550199e-07,5.1137823826492907e-07,5.0408059566662857e-07,4.9665303948473954e-07,4.8908555089088268e-07,4.8126861975448754e-07,4.7333210643172172e-07,4.6525899887378616e-07,4.5697117963249362e-07,4.4857907786430744e-07,4.4006168889901347e-07,4.3137150272657705e-07,4.2259649718764653e-07,4.1371542619434097e-07,4.0470787387597039e-07,3.9563819032442877e-07,3.8648906538458664e-07,3.7726145940684716e-07,3.6799661414318124e-07,3.5868541876569078e-07,3.4934292248458198e-07,3.3998923190134478e-07,3.3062745629423598e-07,3.2127856806151796e-07,3.1194465471008733e-07,3.0264453113987964e-07,2.9339673984873744e-07,2.841892569803543e-07,2.7505931669940488e-07,2.6601513007017833e-07,2.5703489891388365e-07,2.4817605188895304e-07,2.3942956266198988e-07,2.307682786495966e-07,2.2227057059645696e-07,2.1390468202294786e-07,2.056423012457009e-07,1.9758244954897255e-07,1.8966683389721619e-07,1.8186970303107529e-07,1.7430945843391436e-07,1.6689927436728945e-07,1.5961901980331621e-07,1.526043484510195e-07,1.4573969846121899e-07,1.3901284670496707e-07,1.3257388077268174e-07,1.2627995115535222e-07,1.2013534531462019e-07,1.1427988278478083e-07,1.0856767794981986e-07,1.0301582194211384e-07,9.7742033047755125e-08,9.2609594440938237e-08,8.7644984247059165e-08,8.2942018506310015e-08,7.8376006415790006e-08,7.3981674545839191e-08,6.9828679795950782e-08,6.5806193393951489e-08,6.1955713697295701e-08,5.8323760442636928e-08,5.4814276509166002e-08,5.147386056257199e-08,4.8327899405221123e-08,4.5295221784381683e-08,4.2425791985856971e-08,3.9726548614665562e-08,3.7130676790985293e-08,3.4689821139048387e-08,3.239555214728286e-08,3.0194396548745457e-08,2.8138132556482104e-08,2.62061856161902e-08,2.4357077588104404e-08,2.2641375862042111e-08,2.1029517903390485e-08,1.9490482203637017e-08,1.8072522205999332e-08,1.6740017920007954e-08,1.5470793815411259e-08,1.4309943913150837e-08,1.3218383147889977e-08,1.2181195846192533e-08,1.1239726048209188e-08,1.0353611890508078e-08,9.5137085816740251e-09,8.7572569132072796e-09,8.044376166981261e-09,7.3703501614239465e-09,6.7681723329566955e-09,6.1997767411982623e-09,5.6643599882701919e-09,5.1887462673719844e-09,4.7395764294411128e-09,4.3192076180891683e-09,3.9458287973715635e-09,3.5940137219702893e-09,3.2669810046945293e-09],"type":"scatter","mode":"lines","fill":"tozeroy","fillcolor":"rgba(0, 114, 181, 0.3)","line":{"color":"#0072B5","width":2},"name":"Residual Density","inherit":true},"3fae5a5aa9b9.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-312554.07692307793,-305947.11592674849,-299340.15493041911,-292733.19393408968,-286126.2329377603,-279519.27194143087,-272912.31094510149,-266305.34994877205,-259698.38895244268,-253091.42795611324,-246484.46695978387,-239877.50596345443,-233270.54496712502,-226663.58397079562,-220056.62297446621,-213449.66197813681,-206842.7009818074,-200235.73998547799,-193628.77898914859,-187021.81799281918,-180414.85699648978,-173807.89600016037,-167200.93500383096,-160593.97400750156,-153987.01301117212,-147380.05201484272,-140773.09101851331,-134166.1300221839,-127559.1690258545,-120952.20802952509,-114345.24703319569,-107738.28603686628,-101131.32504053687,-94524.364044207468,-87917.403047878062,-81310.442051548656,-74703.48105521925,-68096.520058889844,-61489.559062560438,-54882.598066231032,-48275.637069901626,-41668.676073572191,-35061.715077242814,-28454.754080913379,-21847.793084584002,-15240.832088254567,-8633.8710919251898,-2026.9100955957547,4580.0509007336805,11187.011897063057,17793.972893392493,24400.933889721869,31007.894886051305,37614.855882380682,44221.816878710117,50828.777875039494,57435.738871368929,64042.699867698306,70649.660864027741,77256.621860357118,83863.582856686553,90470.54385301593,97077.504849345365,103684.46584567474,110291.42684200418,116898.38783833361,123505.34883466299,130112.30983099242,136719.2708273218,143326.23182365124,149933.19281998061,156540.15381631005,163147.11481263943,169754.07580896886,176361.03680529824,182967.99780162767,189574.95879795705,196181.91979428648,202788.88079061586,209395.8417869453,216002.80278327467,222609.76377960411,229216.72477593354,235823.68577226298,242430.6467685923,249037.60776492173,255644.56876125117,262251.5297575806,268858.49075390992,275465.45175023936,282072.41274656879,288679.37374289823,295286.33473922755,301893.29573555698,308500.25673188642,315107.21772821585,321714.17872454529,328321.13972087461,334928.10071720404,341535.06171353348],"y":[4.0166561309222489e-07,4.32992334707355e-07,4.6601398561339959e-07,5.0074991066108214e-07,5.3721236201982605e-07,5.7540588936492552e-07,6.1532674911267519e-07,6.569623399707331e-07,7.0029067228794709e-07,7.4527987882105513e-07,7.918877745771547e-07,8.4006147333379823e-07,8.8973706827720744e-07,9.4083938392910344e-07,9.9328180615109241e-07,1.046966196521258e-06,1.101782896771147e-06,1.1576108282551744e-06,1.2143176906029735e-06,1.2717602627848346e-06,1.3297848088093803e-06,1.3882275891813338e-06,1.4469154780877707e-06,1.5056666850673768e-06,1.5642915786643696e-06,1.6225936082935766e-06,1.6803703192634588e-06,1.7374144546383139e-06,1.7935151363885706e-06,1.8484591170984032e-06,1.9020320923920163e-06,1.9540200632226488e-06,2.0042107362594794e-06,2.0523949498238978e-06,2.098368112183223e-06,2.1419316385202358e-06,2.1828943725720719e-06,2.2210739787809191e-06,2.2562982908278098e-06,2.2884066026330542e-06,2.3172508883031018e-06,2.3426969380814119e-06,2.3646253981149621e-06,2.3829327027699423e-06,2.3975318893089344e-06,2.4083532859636409e-06,2.4153450657857458e-06,2.418473660115426e-06,2.4177240270519563e-06,2.4130997719220258e-06,2.4046231183957525e-06,2.3923347305741849e-06,2.3762933880412303e-06,2.3565755175133956e-06,2.3332745863089812e-06,2.3065003643718198e-06,2.276378063001969e-06,2.2430473597474074e-06,2.2066613200790598e-06,2.1673852274911216e-06,2.1253953345268683e-06,2.0808775479168973e-06,2.0340260615248529e-06,1.9850419511209672e-06,1.9341317451448745e-06,1.8815059855779303e-06,1.8273777928261258e-06,1.7719614481249753e-06,1.7154710064272034e-06,1.6581189520347523e-06,1.6001149084026723e-06,1.5416644125896146e-06,1.4829677637751936e-06,1.4242189541265823e-06,1.3656046890944061e-06,1.3073035029705254e-06,1.249484974267051e-06,1.1923090441957914e-06,1.1359254402587482e-06,1.0804732057205573e-06,1.0260803345391973e-06,9.7286351019660018e-07,9.2092794580922403e-07,8.7036732192153182e-07,8.2126381750227721e-07,7.7368822888205254e-07,7.2770017069638413e-07,6.8334835233532377e-07,6.406709229498324e-07,5.9969587772700809e-07,5.6044151791864969e-07,5.2291695698716554e-07,4.8712266521464462e-07,4.5305104519867976e-07,4.2068703082508364e-07,3.9000870255469703e-07,3.6098791218024597e-07,3.3359091059021111e-07,3.0777897251028843e-07,2.8350901266941177e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal Distribution","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Distribution of Residuals","xaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Density"},"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(0, 114, 181, 0.3)","x":[-519535.74651958392,-517445.62425377255,-515355.50198796112,-513265.37972214975,-511175.25745633832,-509085.13519052695,-506995.01292471553,-504904.89065890416,-502814.76839309273,-500724.64612728136,-498634.52386146993,-496544.40159565856,-494454.2793298472,-492364.15706403577,-490274.0347982244,-488183.91253241297,-486093.7902666016,-484003.66800079017,-481913.5457349788,-479823.42346916738,-477733.30120335601,-475643.17893754458,-473553.05667173321,-471462.93440592178,-469372.81214011041,-467282.68987429899,-465192.56760848762,-463102.44534267625,-461012.32307686482,-458922.20081105345,-456832.07854524202,-454741.95627943065,-452651.83401361923,-450561.71174780786,-448471.58948199643,-446381.46721618506,-444291.34495037363,-442201.22268456226,-440111.1004187509,-438020.97815293947,-435930.85588712804,-433840.73362131667,-431750.6113555053,-429660.48908969387,-427570.3668238825,-425480.24455807108,-423390.12229225971,-421300.00002644828,-419209.87776063691,-417119.75549482554,-415029.63322901411,-412939.51096320269,-410849.38869739132,-408759.26643157995,-406669.14416576852,-404579.02189995715,-402488.89963414572,-400398.77736833435,-398308.65510252293,-396218.53283671156,-394128.41057090013,-392038.28830508876,-389948.16603927733,-387858.04377346596,-385767.9215076546,-383677.79924184317,-381587.67697603174,-379497.55471022037,-377407.432444409,-375317.31017859757,-373227.18791278615,-371137.06564697484,-369046.94338116341,-366956.82111535198,-364866.69884954061,-362776.57658372924,-360686.45431791781,-358596.33205210639,-356506.20978629502,-354416.08752048365,-352325.96525467222,-350235.84298886079,-348145.72072304942,-346055.59845723805,-343965.47619142663,-341875.35392561526,-339785.23165980389,-337695.10939399246,-335604.98712818103,-333514.86486236966,-331424.7425965583,-329334.62033074687,-327244.49806493544,-325154.37579912407,-323064.2535333127,-320974.13126750127,-318884.0090016899,-316793.88673587854,-314703.76447006711,-312613.64220425568,-310523.51993844431,-308433.39767263294,-306343.27540682151,-304253.15314101009,-302163.03087519872,-300072.90860938735,-297982.78634357592,-295892.66407776449,-293802.54181195312,-291712.41954614175,-289622.29728033033,-287532.17501451896,-285442.05274870759,-283351.93048289616,-281261.80821708473,-279171.68595127336,-277081.563685462,-274991.44141965057,-272901.31915383914,-270811.19688802777,-268721.0746222164,-266630.95235640497,-264540.8300905936,-262450.70782478224,-260360.58555897081,-258270.46329315941,-256180.34102734801,-254090.21876153658,-252000.09649572521,-249909.97422991385,-247819.85196410242,-245729.72969829105,-243639.60743247962,-241549.48516666825,-239459.36290085682,-237369.24063504545,-235279.11836923403,-233188.99610342266,-231098.87383761123,-229008.75157179986,-226918.62930598843,-224828.50704017706,-222738.3847743657,-220648.26250855427,-218558.1402427429,-216468.01797693147,-214377.8957111201,-212287.77344530867,-210197.6511794973,-208107.52891368588,-206017.40664787451,-203927.28438206308,-201837.16211625171,-199747.03985044028,-197656.91758462891,-195566.79531881755,-193476.67305300612,-191386.55078719475,-189296.42852138332,-187206.30625557195,-185116.18398976052,-183026.06172394915,-180935.93945813773,-178845.81719232636,-176755.69492651493,-174665.57266070356,-172575.45039489213,-170485.32812908076,-168395.2058632694,-166305.08359745797,-164214.9613316466,-162124.83906583517,-160034.7168000238,-157944.59453421237,-155854.472268401,-153764.35000258958,-151674.22773677821,-149584.10547096678,-147493.98320515541,-145403.86093934398,-143313.73867353261,-141223.61640772125,-139133.49414190982,-137043.37187609845,-134953.24961028702,-132863.12734447565,-130773.00507866422,-128682.88281285285,-126592.76054704143,-124502.63828123006,-122412.51601541863,-120322.39374960726,-118232.27148379589,-116142.14921798446,-114052.0269521731,-111961.90468636167,-109871.7824205503,-107781.66015473887,-105691.5378889275,-103601.41562311607,-101511.2933573047,-99421.171091493277,-97331.048825681908,-95240.926559870481,-93150.804294059111,-91060.682028247742,-88970.559762436314,-86880.437496624945,-84790.315230813518,-82700.192965002148,-80610.070699190721,-78519.948433379352,-76429.826167567924,-74339.703901756555,-72249.581635945127,-70159.459370133758,-68069.337104322331,-65979.214838510961,-63889.092572699592,-61798.970306888164,-59708.848041076795,-57618.725775265368,-55528.603509453998,-53438.481243642571,-51348.358977831202,-49258.236712019774,-47168.114446208405,-45077.992180396977,-42987.869914585608,-40897.747648774181,-38807.625382962811,-36717.503117151442,-34627.380851340014,-32537.258585528645,-30447.136319717218,-28357.014053905848,-26266.891788094421,-24176.769522283052,-22086.647256471624,-19996.524990660255,-17906.402724848827,-15816.280459037458,-13726.158193226031,-11636.035927414661,-9545.913661603292,-7455.7913957918645,-5365.6691299804952,-3275.5468641690677,-1185.4245983576984,904.69766745372908,2994.8199332650984,5084.9421990764677,7175.0644648878952,9265.1867306993227,11355.30899651075,13445.431262322061,15535.553528133489,17625.675793944916,19715.798059756227,21805.920325567655,23896.042591379082,25986.16485719051,28076.287123001821,30166.409388813248,32256.531654624676,34346.653920436103,36436.776186247414,38526.898452058842,40617.020717870269,42707.142983681581,44797.265249493008,46887.387515304436,48977.509781115863,51067.632046927174,53157.754312738602,55247.876578550029,57337.998844361457,59428.121110172768,61518.243375984195,63608.365641795623,65698.48790760705,67788.610173418361,69878.732439229789,71968.854705041216,74058.976970852527,76149.099236663955,78239.221502475382,80329.34376828681,82419.466034098121,84509.588299909548,86599.710565720976,88689.832831532403,90779.955097343714,92870.077363155142,94960.199628966569,97050.321894777881,99140.444160589308,101230.56642640074,103320.68869221216,105410.81095802347,107500.9332238349,109591.05548964633,111681.17775545776,113771.30002126907,115861.4222870805,117951.54455289192,120041.66681870335,122131.78908451466,124221.91135032609,126312.03361613752,128402.15588194883,130492.27814776025,132582.40041357168,134672.52267938311,136762.64494519442,138852.76721100585,140942.88947681728,143033.0117426287,145123.13400844001,147213.25627425144,149303.37854006287,151393.50080587418,153483.62307168561,155573.74533749704,157663.86760330846,159753.98986911977,161844.1121349312,163934.23440074263,166024.35666655406,168114.47893236537,170204.6011981768,172294.72346398822,174384.84572979965,176474.96799561096,178565.09026142239,180655.21252723382,182745.33479304513,184835.45705885655,186925.57932466798,189015.70159047941,191105.82385629072,193195.94612210215,195286.06838791358,197376.190653725,199466.31291953631,201556.43518534774,203646.55745115917,205736.67971697048,207826.80198278191,209916.92424859334,212007.04651440476,214097.16878021607,216187.2910460275,218277.41331183893,220367.53557765036,222457.65784346167,224547.7801092731,226637.90237508452,228728.02464089595,230818.14690670726,232908.26917251869,234998.39143833012,237088.51370414143,239178.63596995285,241268.75823576428,243358.88050157571,245449.00276738702,247539.12503319845,249629.24729900988,251719.3695648213,253809.49183063261,255899.61409644404,257989.73636225547,260079.85862806678,262169.98089387821,264260.10315968964,266350.22542550106,268440.34769131237,270530.4699571238,272620.59222293523,274710.71448874666,276800.83675455797,278890.9590203694,280981.08128618082,283071.20355199213,285161.32581780356,287251.44808361499,289341.57034942642,291431.69261523773,293521.81488104915,295611.93714686058,297702.05941267201,299792.18167848332,301882.30394429475,303972.42621010618,306062.5484759176,308152.67074172891,310242.79300754034,312332.91527335177,314423.03753916308,316513.15980497451,318603.28207078594,320693.40433659736,322783.52660240867,324873.6488682201,326963.77113403153,329053.89339984296,331144.01566565427,333234.1379314657,335324.26019727712,337414.38246308843,339504.50472889986,341594.62699471129,343684.74926052272,345774.87152633403,347864.99379214545,349955.11605795688,352045.23832376831,354135.36058957962,356225.48285539105,358315.60512120248,360405.7273870139,362495.84965282521,364585.97191863664,366676.09418444807,368766.21645025938,370856.33871607081,372946.46098188224,375036.58324769366,377126.70551350497,379216.8277793164,381306.95004512783,383397.07231093926,385487.19457675057,387577.316842562,389667.43910837342,391757.56137418473,393847.68363999616,395937.80590580759,398027.92817161902,400118.05043743033,402208.17270324175,404298.29496905318,406388.41723486461,408478.53950067592,410568.66176648735,412658.78403229878,414748.9062981102,416839.02856392151,418929.15082973294,421019.27309554437,423109.39536135568,425199.51762716711,427289.63989297854,429379.76215878996,431469.88442460127,433560.0066904127,435650.12895622413,437740.25122203556,439830.37348784687,441920.4957536583,444010.61801946972,446100.74028528103,448190.86255109246,450280.98481690389,452371.10708271532,454461.22934852663,456551.35161433805,458641.47388014948,460731.59614596091,462821.71841177222,464911.84067758365,467001.96294339508,469092.0852092065,471182.20747501781,473272.32974082924,475362.45200664067,477452.57427245198,479542.69653826341,481632.81880407484,483722.94106988626,485813.06333569757,487903.185601509,489993.30786732043,492083.43013313186,494173.55239894317,496263.6746647546,498353.79693056602,500443.91919637733,502534.04146218876,504624.16372800019,506714.28599381162,508804.40825962293,510894.53052543435,512984.65279124578,515074.77505705721,517164.89732286852,519255.01958867995,521345.14185449138,523435.2641203028,525525.38638611417,527615.50865192548,529705.63091773679,531795.75318354834,533885.87544935965,535975.99771517096,538066.1199809825,540156.24224679382,542246.36451260536,544336.48677841667,546426.60904422798,548516.73131003953],"y":[1.9561490074985769e-09,2.150976313182825e-09,2.3605984942801456e-09,2.5830966048687359e-09,2.8337021511155475e-09,3.1015746137227141e-09,3.3853018561392059e-09,3.7049769688081032e-09,4.0445354344595857e-09,4.4044616316881577e-09,4.8078533620001899e-09,5.2348367150539579e-09,5.6882795820565756e-09,6.1926165611100487e-09,6.725254859913155e-09,7.29181234127371e-09,7.9173276350411319e-09,8.5764940355563244e-09,9.2785854623576856e-09,1.0048240039646544e-08,1.0857552304440365e-08,1.1720508679555665e-08,1.266004406751079e-08,1.3645900697860433e-08,1.4697978608304711e-08,1.5835892530482927e-08,1.7027428643881897e-08,1.8299731453733337e-08,1.9667162209665866e-08,2.109611122067015e-08,2.2622402596270251e-08,2.4252909614924846e-08,2.5953358656104927e-08,2.7769755986854629e-08,2.9698986639874843e-08,3.1707016520543415e-08,3.3851555444567874e-08,3.6116791827209995e-08,3.846999614573211e-08,4.0982062110970179e-08,4.3621646009071661e-08,4.6358528715698186e-08,4.9278157160364367e-08,5.233079667056896e-08,5.5490052758567912e-08,5.8857105856686012e-08,6.2361072901012062e-08,6.598076275940503e-08,6.9833997455398149e-08,7.3826231465480107e-08,7.7942865483966884e-08,8.2318914395417046e-08,8.6834053439408773e-08,9.1484288987991286e-08,9.6413902752147847e-08,1.0148326903133722e-07,1.0670491846283088e-07,1.1220983306056878e-07,1.1786040472008449e-07,1.2368002933721798e-07,1.2978325546741069e-07,1.3603666078868971e-07,1.4247490185740539e-07,1.4919336496864269e-07,1.5606493803615682e-07,1.6313553028045563e-07,1.704792006492009e-07,1.7797713936799104e-07,1.8568604961862054e-07,1.9365720698383544e-07,2.0178187478731826e-07,2.1012661164462935e-07,2.1871928518812267e-07,2.2746269688875513e-07,2.36431835767674e-07,2.4563145827985524e-07,2.5497698828302516e-07,2.64549953167141e-07,2.7433326495427227e-07,2.8425561249150722e-07,2.944027511465122e-07,3.047379846203347e-07,3.1520342575853823e-07,3.2588640902599371e-07,3.3673377893860856e-07,3.4770072884764426e-07,3.5887329689068434e-07,3.7018581375922783e-07,3.8160571498371432e-07,3.9321478386239818e-07,4.0493939914751848e-07,4.1675794230115317e-07,4.2874507285069953e-07,4.4082415376396414e-07,4.529828259987446e-07,4.652860435006213e-07,4.7765916278792252e-07,4.9009710646383933e-07,5.0265304393002184e-07,5.1525905555228696e-07,5.2791781115052027e-07,5.4066152477618557e-07,5.5344088016820245e-07,5.6626005332519228e-07,5.7913435651465891e-07,5.9203159834487631e-07,6.0495538224168917e-07,6.1790961419686537e-07,6.3087596585237859e-07,6.438563804505104e-07,6.5684855485063692e-07,6.6984450513381046e-07,6.8284414614428264e-07,6.9584345503721868e-07,7.088412200229328e-07,7.2183583094257771e-07,7.3482492375795454e-07,7.4781065297096547e-07,7.6079136805122666e-07,7.7376826426214376e-07,7.8674384807000118e-07,7.9971894456947661e-07,8.1269843312989377e-07,8.2568276438661595e-07,8.386787610779239e-07,8.5169314222081274e-07,8.6472268954557021e-07,8.7778463724324145e-07,8.9088367414147068e-07,9.0401223830043292e-07,9.1720306875969484e-07,9.3045303907062151e-07,9.4375058877298668e-07,9.5714942158512648e-07,9.7063119248879512e-07,9.8418171181955126e-07,9.9788106485093643e-07,1.0116871594571537e-06,1.0255854855671611e-06,1.0396873918664246e-06,1.0539180684236783e-06,1.0682657533921163e-06,1.0828768538925786e-06,1.0976352796595888e-06,1.1125408443387925e-06,1.127761325125453e-06,1.1431479906559789e-06,1.1587184938672267e-06,1.174638317880493e-06,1.1907449005916408e-06,1.2070717804850032e-06,1.2237717601976368e-06,1.2406747036546176e-06,1.2578314413298e-06,1.2753722184734416e-06,1.2931263408517179e-06,1.3111616762979692e-06,1.3295775795948575e-06,1.3482100565348269e-06,1.3671417303077215e-06,1.3864352859973531e-06,1.4059403655064693e-06,1.4257497838098696e-06,1.4458872314459893e-06,1.4662220287289641e-06,1.4868502299692605e-06,1.507758367606122e-06,1.5288400543355543e-06,1.5501853082372178e-06,1.5717499393104394e-06,1.5934545852941927e-06,1.6153718825574337e-06,1.637438063422728e-06,1.6596013111898512e-06,1.6819039059695101e-06,1.7042781019932137e-06,1.7266977606614369e-06,1.7491608155226633e-06,1.7716149702873339e-06,1.794055509949364e-06,1.8164217708352201e-06,1.838699184180399e-06,1.8608980029018764e-06,1.8828853086271922e-06,1.9047081123928943e-06,1.9263833423405452e-06,1.9476936582415387e-06,1.9687715813516104e-06,1.9896294332381669e-06,2.0099606734437612e-06,2.0300007074528452e-06,2.0497271439045574e-06,2.0688021051679907e-06,2.0875186235242954e-06,2.105821572012006e-06,2.1233667855490518e-06,2.1404916388143782e-06,2.1571002928819073e-06,2.1728672268241329e-06,2.1881593340763924e-06,2.2028342041245332e-06,2.2166081638600554e-06,2.2298621473509677e-06,2.2424039299676696e-06,2.2540116832531071e-06,2.2650651467490059e-06,2.2753219909375625e-06,2.2846377753602342e-06,2.2933769021315059e-06,2.3012497431421739e-06,2.3081994026155032e-06,2.3145626409063204e-06,2.3200083811300636e-06,2.3245714781855919e-06,2.3285511833846085e-06,2.3315836166826587e-06,2.333793471264966e-06,2.3354354777977335e-06,2.3361239703870109e-06,2.3360656767659215e-06,2.3354668721659583e-06,2.3339329221012026e-06,2.3317394872964427e-06,2.3290435501137979e-06,2.3254554421617019e-06,2.3213022671052646e-06,2.3166938047495091e-06,2.3112596534658189e-06,2.3053576387482768e-06,2.2990550181091231e-06,2.2920145466243224e-06,2.284602146495815e-06,2.2768493479829207e-06,2.2684647827653679e-06,2.2597993540919725e-06,2.250845490496489e-06,2.2414036727102859e-06,2.2317524711708186e-06,2.2218690146580276e-06,2.2116454225323258e-06,2.2012765888154075e-06,2.1907399058874812e-06,2.1799976920799213e-06,2.1691715491105288e-06,2.158247244834633e-06,2.1472354343877971e-06,2.1361963857287604e-06,2.1251308559428015e-06,2.1140768795591026e-06,2.1030461619324796e-06,2.0920591543771809e-06,2.0811624052080037e-06,2.0703319069181052e-06,2.0596103118035894e-06,2.0490369036929686e-06,2.0385642173370903e-06,2.0282572581345278e-06,2.0181361188904025e-06,2.0081409522089213e-06,1.9983568967136953e-06,1.9887772849615282e-06,1.9793393085682318e-06,1.970143768999066e-06,1.9611542577717638e-06,1.9523124230396634e-06,1.9437282622964297e-06,1.9353371868486731e-06,1.9270905015243789e-06,1.919099310892479e-06,1.9112766325048945e-06,1.9035863359385783e-06,1.8961313979320592e-06,1.8888118901969646e-06,1.8816049249883079e-06,1.8745955245716957e-06,1.8676831447670671e-06,1.8608567781747875e-06,1.8541736777687759e-06,1.84754694484657e-06,1.8409750997520386e-06,1.8344762034713897e-06,1.8279943677425132e-06,1.8215307021308092e-06,1.81506138409459e-06,1.8085711439791838e-06,1.8020545530714105e-06,1.7954564347581632e-06,1.788798935113884e-06,1.782064530105349e-06,1.7751790784022382e-06,1.7681969148378211e-06,1.7610834862351708e-06,1.753758841125624e-06,1.7463027967402487e-06,1.7386598987029664e-06,1.7307572295524683e-06,1.7226924853623221e-06,1.7143868609438321e-06,1.7057860127971526e-06,1.6969976004653787e-06,1.6879187029726029e-06,1.678522930740842e-06,1.6689202348913909e-06,1.6589846482797302e-06,1.6487242828432552e-06,1.6382444480582762e-06,1.6273990664692595e-06,1.6162340097520531e-06,1.6048441613895615e-06,1.593068050888758e-06,1.5809890534760471e-06,1.5686872982230553e-06,1.5559922282566654e-06,1.5430209594424775e-06,1.5298361873322116e-06,1.5162658810276772e-06,1.5024538536511108e-06,1.4884444145300522e-06,1.4740726216659249e-06,1.4594990794743127e-06,1.4447504504689682e-06,1.4296779913902085e-06,1.4144469024021656e-06,1.3990684964214649e-06,1.3834194570730029e-06,1.3676557808862636e-06,1.3517710494594773e-06,1.3356943447256241e-06,1.3195397543750397e-06,1.3032983207313686e-06,1.2869462757720948e-06,1.2705545161335006e-06,1.254118214135938e-06,1.2376506659057981e-06,1.2211827222936844e-06,1.2047195273747105e-06,1.1882998115117993e-06,1.17191904634731e-06,1.1555978779204642e-06,1.139388033399567e-06,1.1232554284325317e-06,1.1072411096151093e-06,1.0913972810823886e-06,1.0756669005801446e-06,1.0601153957854389e-06,1.0447835322541519e-06,1.0295983015459298e-06,1.0146523296109689e-06,9.9996425954798861e-07,9.8545213551525484e-07,9.7123723754136183e-07,9.5730718613099634e-07,9.4357778303652463e-07,9.30198911271061e-07,9.1712051642158711e-07,9.0426224229044887e-07,8.9180092922085575e-07,8.7964480830312697e-07,8.6772256333757849e-07,8.5623472759605564e-07,8.4504664567891794e-07,8.3410013344976692e-07,8.2361457905661027e-07,8.1341426952039036e-07,8.0345697180707871e-07,7.9397463698087224e-07,7.8475532442026199e-07,7.7577418909678264e-07,7.6726819737109359e-07,7.5899686816128812e-07,7.5096049867210259e-07,7.4336931098263435e-07,7.3598776662492345e-07,7.2883747281581141e-07,7.2207683902970702e-07,7.1550354994221354e-07,7.0914874961095759e-07,7.0312098308525331e-07,6.972537353431634e-07,6.9158297409221663e-07,6.8617223306783554e-07,6.8089152832125566e-07,6.7577634827420534e-07,6.7085256963775112e-07,6.6602570077469761e-07,6.6132521397633221e-07,6.5674863558003453e-07,6.5223432039553269e-07,6.4780034192810992e-07,6.4342646446816085e-07,6.3907988013338727e-07,6.3476243240169874e-07,6.3044723569907023e-07,6.261252620613025e-07,6.2177822506130636e-07,6.1738342519856445e-07,6.1294987869534351e-07,6.0843653573962043e-07,6.0383465233701955e-07,5.991652778919446e-07,5.9436349579459823e-07,5.8944249538608578e-07,5.8442948348586009e-07,5.7923627294502563e-07,5.7390356640683854e-07,5.6845937784552868e-07,5.6279460447399238e-07,5.5698020386272772e-07,5.5104051519180606e-07,5.4484957339119613e-07,5.3850825503160989e-07,5.3203388195981721e-07,5.2528919999741049e-07,5.184015735550199e-07,5.1137823826492907e-07,5.0408059566662857e-07,4.9665303948473954e-07,4.8908555089088268e-07,4.8126861975448754e-07,4.7333210643172172e-07,4.6525899887378616e-07,4.5697117963249362e-07,4.4857907786430744e-07,4.4006168889901347e-07,4.3137150272657705e-07,4.2259649718764653e-07,4.1371542619434097e-07,4.0470787387597039e-07,3.9563819032442877e-07,3.8648906538458664e-07,3.7726145940684716e-07,3.6799661414318124e-07,3.5868541876569078e-07,3.4934292248458198e-07,3.3998923190134478e-07,3.3062745629423598e-07,3.2127856806151796e-07,3.1194465471008733e-07,3.0264453113987964e-07,2.9339673984873744e-07,2.841892569803543e-07,2.7505931669940488e-07,2.6601513007017833e-07,2.5703489891388365e-07,2.4817605188895304e-07,2.3942956266198988e-07,2.307682786495966e-07,2.2227057059645696e-07,2.1390468202294786e-07,2.056423012457009e-07,1.9758244954897255e-07,1.8966683389721619e-07,1.8186970303107529e-07,1.7430945843391436e-07,1.6689927436728945e-07,1.5961901980331621e-07,1.526043484510195e-07,1.4573969846121899e-07,1.3901284670496707e-07,1.3257388077268174e-07,1.2627995115535222e-07,1.2013534531462019e-07,1.1427988278478083e-07,1.0856767794981986e-07,1.0301582194211384e-07,9.7742033047755125e-08,9.2609594440938237e-08,8.7644984247059165e-08,8.2942018506310015e-08,7.8376006415790006e-08,7.3981674545839191e-08,6.9828679795950782e-08,6.5806193393951489e-08,6.1955713697295701e-08,5.8323760442636928e-08,5.4814276509166002e-08,5.147386056257199e-08,4.8327899405221123e-08,4.5295221784381683e-08,4.2425791985856971e-08,3.9726548614665562e-08,3.7130676790985293e-08,3.4689821139048387e-08,3.239555214728286e-08,3.0194396548745457e-08,2.8138132556482104e-08,2.62061856161902e-08,2.4357077588104404e-08,2.2641375862042111e-08,2.1029517903390485e-08,1.9490482203637017e-08,1.8072522205999332e-08,1.6740017920007954e-08,1.5470793815411259e-08,1.4309943913150837e-08,1.3218383147889977e-08,1.2181195846192533e-08,1.1239726048209188e-08,1.0353611890508078e-08,9.5137085816740251e-09,8.7572569132072796e-09,8.044376166981261e-09,7.3703501614239465e-09,6.7681723329566955e-09,6.1997767411982623e-09,5.6643599882701919e-09,5.1887462673719844e-09,4.7395764294411128e-09,4.3192076180891683e-09,3.9458287973715635e-09,3.5940137219702893e-09,3.2669810046945293e-09],"type":"scatter","mode":"lines","fill":"tozeroy","line":{"color":"#0072B5","width":2},"name":"Residual Density","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-312554.07692307793,-305947.11592674849,-299340.15493041911,-292733.19393408968,-286126.2329377603,-279519.27194143087,-272912.31094510149,-266305.34994877205,-259698.38895244268,-253091.42795611324,-246484.46695978387,-239877.50596345443,-233270.54496712502,-226663.58397079562,-220056.62297446621,-213449.66197813681,-206842.7009818074,-200235.73998547799,-193628.77898914859,-187021.81799281918,-180414.85699648978,-173807.89600016037,-167200.93500383096,-160593.97400750156,-153987.01301117212,-147380.05201484272,-140773.09101851331,-134166.1300221839,-127559.1690258545,-120952.20802952509,-114345.24703319569,-107738.28603686628,-101131.32504053687,-94524.364044207468,-87917.403047878062,-81310.442051548656,-74703.48105521925,-68096.520058889844,-61489.559062560438,-54882.598066231032,-48275.637069901626,-41668.676073572191,-35061.715077242814,-28454.754080913379,-21847.793084584002,-15240.832088254567,-8633.8710919251898,-2026.9100955957547,4580.0509007336805,11187.011897063057,17793.972893392493,24400.933889721869,31007.894886051305,37614.855882380682,44221.816878710117,50828.777875039494,57435.738871368929,64042.699867698306,70649.660864027741,77256.621860357118,83863.582856686553,90470.54385301593,97077.504849345365,103684.46584567474,110291.42684200418,116898.38783833361,123505.34883466299,130112.30983099242,136719.2708273218,143326.23182365124,149933.19281998061,156540.15381631005,163147.11481263943,169754.07580896886,176361.03680529824,182967.99780162767,189574.95879795705,196181.91979428648,202788.88079061586,209395.8417869453,216002.80278327467,222609.76377960411,229216.72477593354,235823.68577226298,242430.6467685923,249037.60776492173,255644.56876125117,262251.5297575806,268858.49075390992,275465.45175023936,282072.41274656879,288679.37374289823,295286.33473922755,301893.29573555698,308500.25673188642,315107.21772821585,321714.17872454529,328321.13972087461,334928.10071720404,341535.06171353348],"y":[4.0166561309222489e-07,4.32992334707355e-07,4.6601398561339959e-07,5.0074991066108214e-07,5.3721236201982605e-07,5.7540588936492552e-07,6.1532674911267519e-07,6.569623399707331e-07,7.0029067228794709e-07,7.4527987882105513e-07,7.918877745771547e-07,8.4006147333379823e-07,8.8973706827720744e-07,9.4083938392910344e-07,9.9328180615109241e-07,1.046966196521258e-06,1.101782896771147e-06,1.1576108282551744e-06,1.2143176906029735e-06,1.2717602627848346e-06,1.3297848088093803e-06,1.3882275891813338e-06,1.4469154780877707e-06,1.5056666850673768e-06,1.5642915786643696e-06,1.6225936082935766e-06,1.6803703192634588e-06,1.7374144546383139e-06,1.7935151363885706e-06,1.8484591170984032e-06,1.9020320923920163e-06,1.9540200632226488e-06,2.0042107362594794e-06,2.0523949498238978e-06,2.098368112183223e-06,2.1419316385202358e-06,2.1828943725720719e-06,2.2210739787809191e-06,2.2562982908278098e-06,2.2884066026330542e-06,2.3172508883031018e-06,2.3426969380814119e-06,2.3646253981149621e-06,2.3829327027699423e-06,2.3975318893089344e-06,2.4083532859636409e-06,2.4153450657857458e-06,2.418473660115426e-06,2.4177240270519563e-06,2.4130997719220258e-06,2.4046231183957525e-06,2.3923347305741849e-06,2.3762933880412303e-06,2.3565755175133956e-06,2.3332745863089812e-06,2.3065003643718198e-06,2.276378063001969e-06,2.2430473597474074e-06,2.2066613200790598e-06,2.1673852274911216e-06,2.1253953345268683e-06,2.0808775479168973e-06,2.0340260615248529e-06,1.9850419511209672e-06,1.9341317451448745e-06,1.8815059855779303e-06,1.8273777928261258e-06,1.7719614481249753e-06,1.7154710064272034e-06,1.6581189520347523e-06,1.6001149084026723e-06,1.5416644125896146e-06,1.4829677637751936e-06,1.4242189541265823e-06,1.3656046890944061e-06,1.3073035029705254e-06,1.249484974267051e-06,1.1923090441957914e-06,1.1359254402587482e-06,1.0804732057205573e-06,1.0260803345391973e-06,9.7286351019660018e-07,9.2092794580922403e-07,8.7036732192153182e-07,8.2126381750227721e-07,7.7368822888205254e-07,7.2770017069638413e-07,6.8334835233532377e-07,6.406709229498324e-07,5.9969587772700809e-07,5.6044151791864969e-07,5.2291695698716554e-07,4.8712266521464462e-07,4.5305104519867976e-07,4.2068703082508364e-07,3.9000870255469703e-07,3.6098791218024597e-07,3.3359091059021111e-07,3.0777897251028843e-07,2.8350901266941177e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal Distribution","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The density plot shows the distribution of residuals (blue) overlaid with a theoretical normal distribution (red dashed line) with the same mean and standard deviation. If the residuals were perfectly normally distributed, the two curves would align closely.</p>
</section>
<section id="q-q-plot" class="level4">
<h4 class="anchored" data-anchor-id="q-q-plot">Q-Q Plot</h4>
<p>A Q-Q (quantile-quantile) plot provides another way to assess normality by comparing the quantiles of the residuals against the quantiles of a theoretical normal distribution:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate theoretical quantiles</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ts1<span class="sc">$</span>res1)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>theoretical_quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">ppoints</span>(n))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate sample quantiles (sorted residuals)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>sample_quantiles <span class="ot">&lt;-</span> <span class="fu">sort</span>(ts1<span class="sc">$</span>res1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the residuals for comparison</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>standardized_res <span class="ot">&lt;-</span> (sample_quantiles <span class="sc">-</span> <span class="fu">mean</span>(ts1<span class="sc">$</span>res1)) <span class="sc">/</span> <span class="fu">sd</span>(ts1<span class="sc">$</span>res1)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Q-Q plot</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>p_qq <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> theoretical_quantiles,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> standardized_res,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"markers"</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#0072B5"</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">opacity =</span> <span class="fl">0.6</span>),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Sample Quantiles"</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_trace</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> theoretical_quantiles,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> theoretical_quantiles,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter"</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"lines"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Normal Reference Line"</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    plotly<span class="sc">::</span><span class="fu">layout</span>(</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Q-Q Plot: Residuals vs Normal Distribution"</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Theoretical Quantiles"</span>),</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Sample Quantiles (Standardized)"</span>),</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">showlegend =</span> <span class="cn">TRUE</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>p_qq</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-208dfe255a8ab487b36e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-208dfe255a8ab487b36e">{"x":{"visdat":{"3fae48a015e3":["function () ","plotlyVisDat"]},"cur_data":"3fae48a015e3","attrs":{"3fae48a015e3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-1.8949129111747394,-1.6204363011446281,-1.4677197525471741,-1.3796252268618672,-1.202783964242123,-1.099307616604577,-0.80944129764227024,-0.68965718440074486,-0.6429222084205457,-0.63039799738665347,-0.58853698064029536,-0.57126659152125481,-0.55572492239713034,-0.51396047919601395,-0.42216902901354419,-0.41706599377732173,-0.33530781895410811,-0.1998764138133764,-0.16635806321535426,-0.087119348942768321,-0.041634141854186693,-0.0097306260203562575,0.15726305056052703,0.25043292711441639,0.42147042395985157,0.49520290842824888,0.56468458335778537,0.60035779366648701,0.69213191425208931,0.72632581463416612,0.85949285648901808,0.91819467104838093,0.98735547147290637,1.3021125292918088,1.3655427989523536,1.9610526738855347,1.9737193308489009,2.0706151218085593],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998},"name":"Sample Quantiles","inherit":true},"3fae48a015e3.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal Reference Line","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Q-Q Plot: Residuals vs Normal Distribution","xaxis":{"domain":[0,1],"automargin":true,"title":"Theoretical Quantiles"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Sample Quantiles (Standardized)"},"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-1.8949129111747394,-1.6204363011446281,-1.4677197525471741,-1.3796252268618672,-1.202783964242123,-1.099307616604577,-0.80944129764227024,-0.68965718440074486,-0.6429222084205457,-0.63039799738665347,-0.58853698064029536,-0.57126659152125481,-0.55572492239713034,-0.51396047919601395,-0.42216902901354419,-0.41706599377732173,-0.33530781895410811,-0.1998764138133764,-0.16635806321535426,-0.087119348942768321,-0.041634141854186693,-0.0097306260203562575,0.15726305056052703,0.25043292711441639,0.42147042395985157,0.49520290842824888,0.56468458335778537,0.60035779366648701,0.69213191425208931,0.72632581463416612,0.85949285648901808,0.91819467104838093,0.98735547147290637,1.3021125292918088,1.3655427989523536,1.9610526738855347,1.9737193308489009,2.0706151218085593],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998,"line":{"color":"rgba(31,119,180,1)"}},"name":"Sample Quantiles","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal Reference Line","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In a Q-Q plot, if the residuals follow a normal distribution, the points should fall approximately along the red reference line. Deviations from this line indicate departures from normality. Points curving away at the tails suggest heavy-tailed or skewed distributions.</p>
<p>The <code>plot_residuals</code> function returns all the plots together:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_residuals</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ts1,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">index_col =</span> <span class="st">"index"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_col =</span> <span class="st">"y"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_col =</span> <span class="st">"fit1"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag_max =</span> <span class="dv">60</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-67cceb247b227aa68b1f" style="width:100%;height:780px;"></div>
<script type="application/json" data-for="htmlwidget-67cceb247b227aa68b1f">{"x":{"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#0072B5"},"showlegend":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8217412.0769230779,8311425.7199912472,8405439.3630594164,8499453.0061275866,8593466.6491957549,8687480.2922639251,8781493.9353320953,8875507.5784002636,8969521.2214684337,9063534.8645366021,9157548.5076047722,9251562.1506729405,9345575.7937411107,9439589.4368092809,9533603.0798774492,9627616.7229456194,9721630.3660137877,9815644.0090819579,9909657.6521501262,10003671.295218296,10191698.581354635,10285712.224422805,10379725.867490973,10473739.510559143,10567753.153627314,10661766.796695482,10755780.439763652,10849794.08283182,10943807.725899991,11037821.368968159,11131835.012036329,11225848.655104499,11319862.298172668,11413875.941240838,11507889.584309006,11601903.227377176,11695916.870445345],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6,"line":{"color":"rgba(255,127,14,1)"}},"name":"Fitted","showlegend":true,"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[2007],"y":[10097684.938286467],"type":"scatter","mode":"markers","marker":{"color":"orange","size":6,"line":{"color":"rgba(44,160,44,1)"}},"name":"Fitted (2-3 SD)","showlegend":true,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-312554.07692307793,-198391.71999124717,-91663.363059416413,-1605.0061275865883,41307.350804245099,-6867.2922639250755,-55306.93533209525,-84774.578400263563,-103980.22146843374,-94226.86453660205,-97075.507604772225,-69634.150672940537,-14369.793741110712,-68792.436809280887,69518.9201225508,99025.277054380625,81680.633986212313,141767.99091804214,214775.34784987383,325552.70478170365,341535.06171353348,323463.41864536516,225237.77557719499,162858.13250902668,151450.4894408565,114162.84637268633,93141.203304518014,25939.560236347839,119802.91716817953,-27439.725899990648,-32968.36896815896,-106046.01203632914,-113754.65510449931,-133512.29817266762,-181323.9412408378,-227560.58430900611,-242091.22737717628,-267280.8704453446],"type":"scatter","mode":"markers","name":"Residuals","marker":{"color":"#0072B5","line":{"color":"rgba(214,39,40,1)"}},"showlegend":false,"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[329887.53739538434,329887.53739538434],"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"+2SD","showlegend":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-329887.53739538434,-329887.53739538434],"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"-2SD","showlegend":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[494831.30609307648,494831.30609307648],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"+3SD","showlegend":false,"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-494831.30609307648,-494831.30609307648],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"-3SD","showlegend":false,"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"y":[0.84106695903932094,0.69215584847461842,0.53287040389823059,0.41069392156023093,0.31467311938832782,0.20503769031164124,0.088056712076365451,-0.025316009257497756,-0.13962684591972827,-0.21638408251867078,-0.31546769074676156,-0.38591625499318299,-0.41902541757658013,-0.46383024933849049,-0.47451018399032402,-0.44564771369940032,-0.42756950491400458,-0.39209634195421278,-0.34299543148521044,-0.27316619199985115,-0.19026493937121877,-0.10796531154420531,-0.038073018734628462,0.016995521872731331,0.031419816080256839,0.053832986026086473,0.061858308250549297,0.046776121910335922,0.081112641237364641,0.071629615963049814,0.074790877833544586,0.070396234969657717,0.087330099643598363,0.12361890813003673,0.14270638581165354,0.1278442137075787,0.082988801858789013],"marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"name":"ACF","showlegend":false,"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"scatter","x":[1,37],"y":[0.31794814293719936,0.31794814293719936],"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"scatter","x":[1,37],"y":[-0.31794814293719936,-0.31794814293719936],"mode":"lines","line":{"color":"black","dash":"dash"},"showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-1.8949129111747394,-1.6204363011446281,-1.4677197525471741,-1.3796252268618672,-1.202783964242123,-1.099307616604577,-0.80944129764227024,-0.68965718440074486,-0.6429222084205457,-0.63039799738665347,-0.58853698064029536,-0.57126659152125481,-0.55572492239713034,-0.51396047919601395,-0.42216902901354419,-0.41706599377732173,-0.33530781895410811,-0.1998764138133764,-0.16635806321535426,-0.087119348942768321,-0.041634141854186693,-0.0097306260203562575,0.15726305056052703,0.25043292711441639,0.42147042395985157,0.49520290842824888,0.56468458335778537,0.60035779366648701,0.69213191425208931,0.72632581463416612,0.85949285648901808,0.91819467104838093,0.98735547147290637,1.3021125292918088,1.3655427989523536,1.9610526738855347,1.9737193308489009,2.0706151218085593],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998,"line":{"color":"rgba(44,160,44,1)"}},"name":"Sample","showlegend":false,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x3","yaxis":"y4","frame":null},{"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x3","yaxis":"y4","frame":null},{"fillcolor":"rgba(0, 114, 181, 0.3)","x":[-519535.74651958392,-517445.62425377255,-515355.50198796112,-513265.37972214975,-511175.25745633832,-509085.13519052695,-506995.01292471553,-504904.89065890416,-502814.76839309273,-500724.64612728136,-498634.52386146993,-496544.40159565856,-494454.2793298472,-492364.15706403577,-490274.0347982244,-488183.91253241297,-486093.7902666016,-484003.66800079017,-481913.5457349788,-479823.42346916738,-477733.30120335601,-475643.17893754458,-473553.05667173321,-471462.93440592178,-469372.81214011041,-467282.68987429899,-465192.56760848762,-463102.44534267625,-461012.32307686482,-458922.20081105345,-456832.07854524202,-454741.95627943065,-452651.83401361923,-450561.71174780786,-448471.58948199643,-446381.46721618506,-444291.34495037363,-442201.22268456226,-440111.1004187509,-438020.97815293947,-435930.85588712804,-433840.73362131667,-431750.6113555053,-429660.48908969387,-427570.3668238825,-425480.24455807108,-423390.12229225971,-421300.00002644828,-419209.87776063691,-417119.75549482554,-415029.63322901411,-412939.51096320269,-410849.38869739132,-408759.26643157995,-406669.14416576852,-404579.02189995715,-402488.89963414572,-400398.77736833435,-398308.65510252293,-396218.53283671156,-394128.41057090013,-392038.28830508876,-389948.16603927733,-387858.04377346596,-385767.9215076546,-383677.79924184317,-381587.67697603174,-379497.55471022037,-377407.432444409,-375317.31017859757,-373227.18791278615,-371137.06564697484,-369046.94338116341,-366956.82111535198,-364866.69884954061,-362776.57658372924,-360686.45431791781,-358596.33205210639,-356506.20978629502,-354416.08752048365,-352325.96525467222,-350235.84298886079,-348145.72072304942,-346055.59845723805,-343965.47619142663,-341875.35392561526,-339785.23165980389,-337695.10939399246,-335604.98712818103,-333514.86486236966,-331424.7425965583,-329334.62033074687,-327244.49806493544,-325154.37579912407,-323064.2535333127,-320974.13126750127,-318884.0090016899,-316793.88673587854,-314703.76447006711,-312613.64220425568,-310523.51993844431,-308433.39767263294,-306343.27540682151,-304253.15314101009,-302163.03087519872,-300072.90860938735,-297982.78634357592,-295892.66407776449,-293802.54181195312,-291712.41954614175,-289622.29728033033,-287532.17501451896,-285442.05274870759,-283351.93048289616,-281261.80821708473,-279171.68595127336,-277081.563685462,-274991.44141965057,-272901.31915383914,-270811.19688802777,-268721.0746222164,-266630.95235640497,-264540.8300905936,-262450.70782478224,-260360.58555897081,-258270.46329315941,-256180.34102734801,-254090.21876153658,-252000.09649572521,-249909.97422991385,-247819.85196410242,-245729.72969829105,-243639.60743247962,-241549.48516666825,-239459.36290085682,-237369.24063504545,-235279.11836923403,-233188.99610342266,-231098.87383761123,-229008.75157179986,-226918.62930598843,-224828.50704017706,-222738.3847743657,-220648.26250855427,-218558.1402427429,-216468.01797693147,-214377.8957111201,-212287.77344530867,-210197.6511794973,-208107.52891368588,-206017.40664787451,-203927.28438206308,-201837.16211625171,-199747.03985044028,-197656.91758462891,-195566.79531881755,-193476.67305300612,-191386.55078719475,-189296.42852138332,-187206.30625557195,-185116.18398976052,-183026.06172394915,-180935.93945813773,-178845.81719232636,-176755.69492651493,-174665.57266070356,-172575.45039489213,-170485.32812908076,-168395.2058632694,-166305.08359745797,-164214.9613316466,-162124.83906583517,-160034.7168000238,-157944.59453421237,-155854.472268401,-153764.35000258958,-151674.22773677821,-149584.10547096678,-147493.98320515541,-145403.86093934398,-143313.73867353261,-141223.61640772125,-139133.49414190982,-137043.37187609845,-134953.24961028702,-132863.12734447565,-130773.00507866422,-128682.88281285285,-126592.76054704143,-124502.63828123006,-122412.51601541863,-120322.39374960726,-118232.27148379589,-116142.14921798446,-114052.0269521731,-111961.90468636167,-109871.7824205503,-107781.66015473887,-105691.5378889275,-103601.41562311607,-101511.2933573047,-99421.171091493277,-97331.048825681908,-95240.926559870481,-93150.804294059111,-91060.682028247742,-88970.559762436314,-86880.437496624945,-84790.315230813518,-82700.192965002148,-80610.070699190721,-78519.948433379352,-76429.826167567924,-74339.703901756555,-72249.581635945127,-70159.459370133758,-68069.337104322331,-65979.214838510961,-63889.092572699592,-61798.970306888164,-59708.848041076795,-57618.725775265368,-55528.603509453998,-53438.481243642571,-51348.358977831202,-49258.236712019774,-47168.114446208405,-45077.992180396977,-42987.869914585608,-40897.747648774181,-38807.625382962811,-36717.503117151442,-34627.380851340014,-32537.258585528645,-30447.136319717218,-28357.014053905848,-26266.891788094421,-24176.769522283052,-22086.647256471624,-19996.524990660255,-17906.402724848827,-15816.280459037458,-13726.158193226031,-11636.035927414661,-9545.913661603292,-7455.7913957918645,-5365.6691299804952,-3275.5468641690677,-1185.4245983576984,904.69766745372908,2994.8199332650984,5084.9421990764677,7175.0644648878952,9265.1867306993227,11355.30899651075,13445.431262322061,15535.553528133489,17625.675793944916,19715.798059756227,21805.920325567655,23896.042591379082,25986.16485719051,28076.287123001821,30166.409388813248,32256.531654624676,34346.653920436103,36436.776186247414,38526.898452058842,40617.020717870269,42707.142983681581,44797.265249493008,46887.387515304436,48977.509781115863,51067.632046927174,53157.754312738602,55247.876578550029,57337.998844361457,59428.121110172768,61518.243375984195,63608.365641795623,65698.48790760705,67788.610173418361,69878.732439229789,71968.854705041216,74058.976970852527,76149.099236663955,78239.221502475382,80329.34376828681,82419.466034098121,84509.588299909548,86599.710565720976,88689.832831532403,90779.955097343714,92870.077363155142,94960.199628966569,97050.321894777881,99140.444160589308,101230.56642640074,103320.68869221216,105410.81095802347,107500.9332238349,109591.05548964633,111681.17775545776,113771.30002126907,115861.4222870805,117951.54455289192,120041.66681870335,122131.78908451466,124221.91135032609,126312.03361613752,128402.15588194883,130492.27814776025,132582.40041357168,134672.52267938311,136762.64494519442,138852.76721100585,140942.88947681728,143033.0117426287,145123.13400844001,147213.25627425144,149303.37854006287,151393.50080587418,153483.62307168561,155573.74533749704,157663.86760330846,159753.98986911977,161844.1121349312,163934.23440074263,166024.35666655406,168114.47893236537,170204.6011981768,172294.72346398822,174384.84572979965,176474.96799561096,178565.09026142239,180655.21252723382,182745.33479304513,184835.45705885655,186925.57932466798,189015.70159047941,191105.82385629072,193195.94612210215,195286.06838791358,197376.190653725,199466.31291953631,201556.43518534774,203646.55745115917,205736.67971697048,207826.80198278191,209916.92424859334,212007.04651440476,214097.16878021607,216187.2910460275,218277.41331183893,220367.53557765036,222457.65784346167,224547.7801092731,226637.90237508452,228728.02464089595,230818.14690670726,232908.26917251869,234998.39143833012,237088.51370414143,239178.63596995285,241268.75823576428,243358.88050157571,245449.00276738702,247539.12503319845,249629.24729900988,251719.3695648213,253809.49183063261,255899.61409644404,257989.73636225547,260079.85862806678,262169.98089387821,264260.10315968964,266350.22542550106,268440.34769131237,270530.4699571238,272620.59222293523,274710.71448874666,276800.83675455797,278890.9590203694,280981.08128618082,283071.20355199213,285161.32581780356,287251.44808361499,289341.57034942642,291431.69261523773,293521.81488104915,295611.93714686058,297702.05941267201,299792.18167848332,301882.30394429475,303972.42621010618,306062.5484759176,308152.67074172891,310242.79300754034,312332.91527335177,314423.03753916308,316513.15980497451,318603.28207078594,320693.40433659736,322783.52660240867,324873.6488682201,326963.77113403153,329053.89339984296,331144.01566565427,333234.1379314657,335324.26019727712,337414.38246308843,339504.50472889986,341594.62699471129,343684.74926052272,345774.87152633403,347864.99379214545,349955.11605795688,352045.23832376831,354135.36058957962,356225.48285539105,358315.60512120248,360405.7273870139,362495.84965282521,364585.97191863664,366676.09418444807,368766.21645025938,370856.33871607081,372946.46098188224,375036.58324769366,377126.70551350497,379216.8277793164,381306.95004512783,383397.07231093926,385487.19457675057,387577.316842562,389667.43910837342,391757.56137418473,393847.68363999616,395937.80590580759,398027.92817161902,400118.05043743033,402208.17270324175,404298.29496905318,406388.41723486461,408478.53950067592,410568.66176648735,412658.78403229878,414748.9062981102,416839.02856392151,418929.15082973294,421019.27309554437,423109.39536135568,425199.51762716711,427289.63989297854,429379.76215878996,431469.88442460127,433560.0066904127,435650.12895622413,437740.25122203556,439830.37348784687,441920.4957536583,444010.61801946972,446100.74028528103,448190.86255109246,450280.98481690389,452371.10708271532,454461.22934852663,456551.35161433805,458641.47388014948,460731.59614596091,462821.71841177222,464911.84067758365,467001.96294339508,469092.0852092065,471182.20747501781,473272.32974082924,475362.45200664067,477452.57427245198,479542.69653826341,481632.81880407484,483722.94106988626,485813.06333569757,487903.185601509,489993.30786732043,492083.43013313186,494173.55239894317,496263.6746647546,498353.79693056602,500443.91919637733,502534.04146218876,504624.16372800019,506714.28599381162,508804.40825962293,510894.53052543435,512984.65279124578,515074.77505705721,517164.89732286852,519255.01958867995,521345.14185449138,523435.2641203028,525525.38638611417,527615.50865192548,529705.63091773679,531795.75318354834,533885.87544935965,535975.99771517096,538066.1199809825,540156.24224679382,542246.36451260536,544336.48677841667,546426.60904422798,548516.73131003953],"y":[1.9561490074985769e-09,2.150976313182825e-09,2.3605984942801456e-09,2.5830966048687359e-09,2.8337021511155475e-09,3.1015746137227141e-09,3.3853018561392059e-09,3.7049769688081032e-09,4.0445354344595857e-09,4.4044616316881577e-09,4.8078533620001899e-09,5.2348367150539579e-09,5.6882795820565756e-09,6.1926165611100487e-09,6.725254859913155e-09,7.29181234127371e-09,7.9173276350411319e-09,8.5764940355563244e-09,9.2785854623576856e-09,1.0048240039646544e-08,1.0857552304440365e-08,1.1720508679555665e-08,1.266004406751079e-08,1.3645900697860433e-08,1.4697978608304711e-08,1.5835892530482927e-08,1.7027428643881897e-08,1.8299731453733337e-08,1.9667162209665866e-08,2.109611122067015e-08,2.2622402596270251e-08,2.4252909614924846e-08,2.5953358656104927e-08,2.7769755986854629e-08,2.9698986639874843e-08,3.1707016520543415e-08,3.3851555444567874e-08,3.6116791827209995e-08,3.846999614573211e-08,4.0982062110970179e-08,4.3621646009071661e-08,4.6358528715698186e-08,4.9278157160364367e-08,5.233079667056896e-08,5.5490052758567912e-08,5.8857105856686012e-08,6.2361072901012062e-08,6.598076275940503e-08,6.9833997455398149e-08,7.3826231465480107e-08,7.7942865483966884e-08,8.2318914395417046e-08,8.6834053439408773e-08,9.1484288987991286e-08,9.6413902752147847e-08,1.0148326903133722e-07,1.0670491846283088e-07,1.1220983306056878e-07,1.1786040472008449e-07,1.2368002933721798e-07,1.2978325546741069e-07,1.3603666078868971e-07,1.4247490185740539e-07,1.4919336496864269e-07,1.5606493803615682e-07,1.6313553028045563e-07,1.704792006492009e-07,1.7797713936799104e-07,1.8568604961862054e-07,1.9365720698383544e-07,2.0178187478731826e-07,2.1012661164462935e-07,2.1871928518812267e-07,2.2746269688875513e-07,2.36431835767674e-07,2.4563145827985524e-07,2.5497698828302516e-07,2.64549953167141e-07,2.7433326495427227e-07,2.8425561249150722e-07,2.944027511465122e-07,3.047379846203347e-07,3.1520342575853823e-07,3.2588640902599371e-07,3.3673377893860856e-07,3.4770072884764426e-07,3.5887329689068434e-07,3.7018581375922783e-07,3.8160571498371432e-07,3.9321478386239818e-07,4.0493939914751848e-07,4.1675794230115317e-07,4.2874507285069953e-07,4.4082415376396414e-07,4.529828259987446e-07,4.652860435006213e-07,4.7765916278792252e-07,4.9009710646383933e-07,5.0265304393002184e-07,5.1525905555228696e-07,5.2791781115052027e-07,5.4066152477618557e-07,5.5344088016820245e-07,5.6626005332519228e-07,5.7913435651465891e-07,5.9203159834487631e-07,6.0495538224168917e-07,6.1790961419686537e-07,6.3087596585237859e-07,6.438563804505104e-07,6.5684855485063692e-07,6.6984450513381046e-07,6.8284414614428264e-07,6.9584345503721868e-07,7.088412200229328e-07,7.2183583094257771e-07,7.3482492375795454e-07,7.4781065297096547e-07,7.6079136805122666e-07,7.7376826426214376e-07,7.8674384807000118e-07,7.9971894456947661e-07,8.1269843312989377e-07,8.2568276438661595e-07,8.386787610779239e-07,8.5169314222081274e-07,8.6472268954557021e-07,8.7778463724324145e-07,8.9088367414147068e-07,9.0401223830043292e-07,9.1720306875969484e-07,9.3045303907062151e-07,9.4375058877298668e-07,9.5714942158512648e-07,9.7063119248879512e-07,9.8418171181955126e-07,9.9788106485093643e-07,1.0116871594571537e-06,1.0255854855671611e-06,1.0396873918664246e-06,1.0539180684236783e-06,1.0682657533921163e-06,1.0828768538925786e-06,1.0976352796595888e-06,1.1125408443387925e-06,1.127761325125453e-06,1.1431479906559789e-06,1.1587184938672267e-06,1.174638317880493e-06,1.1907449005916408e-06,1.2070717804850032e-06,1.2237717601976368e-06,1.2406747036546176e-06,1.2578314413298e-06,1.2753722184734416e-06,1.2931263408517179e-06,1.3111616762979692e-06,1.3295775795948575e-06,1.3482100565348269e-06,1.3671417303077215e-06,1.3864352859973531e-06,1.4059403655064693e-06,1.4257497838098696e-06,1.4458872314459893e-06,1.4662220287289641e-06,1.4868502299692605e-06,1.507758367606122e-06,1.5288400543355543e-06,1.5501853082372178e-06,1.5717499393104394e-06,1.5934545852941927e-06,1.6153718825574337e-06,1.637438063422728e-06,1.6596013111898512e-06,1.6819039059695101e-06,1.7042781019932137e-06,1.7266977606614369e-06,1.7491608155226633e-06,1.7716149702873339e-06,1.794055509949364e-06,1.8164217708352201e-06,1.838699184180399e-06,1.8608980029018764e-06,1.8828853086271922e-06,1.9047081123928943e-06,1.9263833423405452e-06,1.9476936582415387e-06,1.9687715813516104e-06,1.9896294332381669e-06,2.0099606734437612e-06,2.0300007074528452e-06,2.0497271439045574e-06,2.0688021051679907e-06,2.0875186235242954e-06,2.105821572012006e-06,2.1233667855490518e-06,2.1404916388143782e-06,2.1571002928819073e-06,2.1728672268241329e-06,2.1881593340763924e-06,2.2028342041245332e-06,2.2166081638600554e-06,2.2298621473509677e-06,2.2424039299676696e-06,2.2540116832531071e-06,2.2650651467490059e-06,2.2753219909375625e-06,2.2846377753602342e-06,2.2933769021315059e-06,2.3012497431421739e-06,2.3081994026155032e-06,2.3145626409063204e-06,2.3200083811300636e-06,2.3245714781855919e-06,2.3285511833846085e-06,2.3315836166826587e-06,2.333793471264966e-06,2.3354354777977335e-06,2.3361239703870109e-06,2.3360656767659215e-06,2.3354668721659583e-06,2.3339329221012026e-06,2.3317394872964427e-06,2.3290435501137979e-06,2.3254554421617019e-06,2.3213022671052646e-06,2.3166938047495091e-06,2.3112596534658189e-06,2.3053576387482768e-06,2.2990550181091231e-06,2.2920145466243224e-06,2.284602146495815e-06,2.2768493479829207e-06,2.2684647827653679e-06,2.2597993540919725e-06,2.250845490496489e-06,2.2414036727102859e-06,2.2317524711708186e-06,2.2218690146580276e-06,2.2116454225323258e-06,2.2012765888154075e-06,2.1907399058874812e-06,2.1799976920799213e-06,2.1691715491105288e-06,2.158247244834633e-06,2.1472354343877971e-06,2.1361963857287604e-06,2.1251308559428015e-06,2.1140768795591026e-06,2.1030461619324796e-06,2.0920591543771809e-06,2.0811624052080037e-06,2.0703319069181052e-06,2.0596103118035894e-06,2.0490369036929686e-06,2.0385642173370903e-06,2.0282572581345278e-06,2.0181361188904025e-06,2.0081409522089213e-06,1.9983568967136953e-06,1.9887772849615282e-06,1.9793393085682318e-06,1.970143768999066e-06,1.9611542577717638e-06,1.9523124230396634e-06,1.9437282622964297e-06,1.9353371868486731e-06,1.9270905015243789e-06,1.919099310892479e-06,1.9112766325048945e-06,1.9035863359385783e-06,1.8961313979320592e-06,1.8888118901969646e-06,1.8816049249883079e-06,1.8745955245716957e-06,1.8676831447670671e-06,1.8608567781747875e-06,1.8541736777687759e-06,1.84754694484657e-06,1.8409750997520386e-06,1.8344762034713897e-06,1.8279943677425132e-06,1.8215307021308092e-06,1.81506138409459e-06,1.8085711439791838e-06,1.8020545530714105e-06,1.7954564347581632e-06,1.788798935113884e-06,1.782064530105349e-06,1.7751790784022382e-06,1.7681969148378211e-06,1.7610834862351708e-06,1.753758841125624e-06,1.7463027967402487e-06,1.7386598987029664e-06,1.7307572295524683e-06,1.7226924853623221e-06,1.7143868609438321e-06,1.7057860127971526e-06,1.6969976004653787e-06,1.6879187029726029e-06,1.678522930740842e-06,1.6689202348913909e-06,1.6589846482797302e-06,1.6487242828432552e-06,1.6382444480582762e-06,1.6273990664692595e-06,1.6162340097520531e-06,1.6048441613895615e-06,1.593068050888758e-06,1.5809890534760471e-06,1.5686872982230553e-06,1.5559922282566654e-06,1.5430209594424775e-06,1.5298361873322116e-06,1.5162658810276772e-06,1.5024538536511108e-06,1.4884444145300522e-06,1.4740726216659249e-06,1.4594990794743127e-06,1.4447504504689682e-06,1.4296779913902085e-06,1.4144469024021656e-06,1.3990684964214649e-06,1.3834194570730029e-06,1.3676557808862636e-06,1.3517710494594773e-06,1.3356943447256241e-06,1.3195397543750397e-06,1.3032983207313686e-06,1.2869462757720948e-06,1.2705545161335006e-06,1.254118214135938e-06,1.2376506659057981e-06,1.2211827222936844e-06,1.2047195273747105e-06,1.1882998115117993e-06,1.17191904634731e-06,1.1555978779204642e-06,1.139388033399567e-06,1.1232554284325317e-06,1.1072411096151093e-06,1.0913972810823886e-06,1.0756669005801446e-06,1.0601153957854389e-06,1.0447835322541519e-06,1.0295983015459298e-06,1.0146523296109689e-06,9.9996425954798861e-07,9.8545213551525484e-07,9.7123723754136183e-07,9.5730718613099634e-07,9.4357778303652463e-07,9.30198911271061e-07,9.1712051642158711e-07,9.0426224229044887e-07,8.9180092922085575e-07,8.7964480830312697e-07,8.6772256333757849e-07,8.5623472759605564e-07,8.4504664567891794e-07,8.3410013344976692e-07,8.2361457905661027e-07,8.1341426952039036e-07,8.0345697180707871e-07,7.9397463698087224e-07,7.8475532442026199e-07,7.7577418909678264e-07,7.6726819737109359e-07,7.5899686816128812e-07,7.5096049867210259e-07,7.4336931098263435e-07,7.3598776662492345e-07,7.2883747281581141e-07,7.2207683902970702e-07,7.1550354994221354e-07,7.0914874961095759e-07,7.0312098308525331e-07,6.972537353431634e-07,6.9158297409221663e-07,6.8617223306783554e-07,6.8089152832125566e-07,6.7577634827420534e-07,6.7085256963775112e-07,6.6602570077469761e-07,6.6132521397633221e-07,6.5674863558003453e-07,6.5223432039553269e-07,6.4780034192810992e-07,6.4342646446816085e-07,6.3907988013338727e-07,6.3476243240169874e-07,6.3044723569907023e-07,6.261252620613025e-07,6.2177822506130636e-07,6.1738342519856445e-07,6.1294987869534351e-07,6.0843653573962043e-07,6.0383465233701955e-07,5.991652778919446e-07,5.9436349579459823e-07,5.8944249538608578e-07,5.8442948348586009e-07,5.7923627294502563e-07,5.7390356640683854e-07,5.6845937784552868e-07,5.6279460447399238e-07,5.5698020386272772e-07,5.5104051519180606e-07,5.4484957339119613e-07,5.3850825503160989e-07,5.3203388195981721e-07,5.2528919999741049e-07,5.184015735550199e-07,5.1137823826492907e-07,5.0408059566662857e-07,4.9665303948473954e-07,4.8908555089088268e-07,4.8126861975448754e-07,4.7333210643172172e-07,4.6525899887378616e-07,4.5697117963249362e-07,4.4857907786430744e-07,4.4006168889901347e-07,4.3137150272657705e-07,4.2259649718764653e-07,4.1371542619434097e-07,4.0470787387597039e-07,3.9563819032442877e-07,3.8648906538458664e-07,3.7726145940684716e-07,3.6799661414318124e-07,3.5868541876569078e-07,3.4934292248458198e-07,3.3998923190134478e-07,3.3062745629423598e-07,3.2127856806151796e-07,3.1194465471008733e-07,3.0264453113987964e-07,2.9339673984873744e-07,2.841892569803543e-07,2.7505931669940488e-07,2.6601513007017833e-07,2.5703489891388365e-07,2.4817605188895304e-07,2.3942956266198988e-07,2.307682786495966e-07,2.2227057059645696e-07,2.1390468202294786e-07,2.056423012457009e-07,1.9758244954897255e-07,1.8966683389721619e-07,1.8186970303107529e-07,1.7430945843391436e-07,1.6689927436728945e-07,1.5961901980331621e-07,1.526043484510195e-07,1.4573969846121899e-07,1.3901284670496707e-07,1.3257388077268174e-07,1.2627995115535222e-07,1.2013534531462019e-07,1.1427988278478083e-07,1.0856767794981986e-07,1.0301582194211384e-07,9.7742033047755125e-08,9.2609594440938237e-08,8.7644984247059165e-08,8.2942018506310015e-08,7.8376006415790006e-08,7.3981674545839191e-08,6.9828679795950782e-08,6.5806193393951489e-08,6.1955713697295701e-08,5.8323760442636928e-08,5.4814276509166002e-08,5.147386056257199e-08,4.8327899405221123e-08,4.5295221784381683e-08,4.2425791985856971e-08,3.9726548614665562e-08,3.7130676790985293e-08,3.4689821139048387e-08,3.239555214728286e-08,3.0194396548745457e-08,2.8138132556482104e-08,2.62061856161902e-08,2.4357077588104404e-08,2.2641375862042111e-08,2.1029517903390485e-08,1.9490482203637017e-08,1.8072522205999332e-08,1.6740017920007954e-08,1.5470793815411259e-08,1.4309943913150837e-08,1.3218383147889977e-08,1.2181195846192533e-08,1.1239726048209188e-08,1.0353611890508078e-08,9.5137085816740251e-09,8.7572569132072796e-09,8.044376166981261e-09,7.3703501614239465e-09,6.7681723329566955e-09,6.1997767411982623e-09,5.6643599882701919e-09,5.1887462673719844e-09,4.7395764294411128e-09,4.3192076180891683e-09,3.9458287973715635e-09,3.5940137219702893e-09,3.2669810046945293e-09],"type":"scatter","mode":"lines","fill":"tozeroy","line":{"color":"#0072B5","width":2},"name":"Density","showlegend":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x4","yaxis":"y3","frame":null},{"x":[-312554.07692307793,-305947.11592674849,-299340.15493041911,-292733.19393408968,-286126.2329377603,-279519.27194143087,-272912.31094510149,-266305.34994877205,-259698.38895244268,-253091.42795611324,-246484.46695978387,-239877.50596345443,-233270.54496712502,-226663.58397079562,-220056.62297446621,-213449.66197813681,-206842.7009818074,-200235.73998547799,-193628.77898914859,-187021.81799281918,-180414.85699648978,-173807.89600016037,-167200.93500383096,-160593.97400750156,-153987.01301117212,-147380.05201484272,-140773.09101851331,-134166.1300221839,-127559.1690258545,-120952.20802952509,-114345.24703319569,-107738.28603686628,-101131.32504053687,-94524.364044207468,-87917.403047878062,-81310.442051548656,-74703.48105521925,-68096.520058889844,-61489.559062560438,-54882.598066231032,-48275.637069901626,-41668.676073572191,-35061.715077242814,-28454.754080913379,-21847.793084584002,-15240.832088254567,-8633.8710919251898,-2026.9100955957547,4580.0509007336805,11187.011897063057,17793.972893392493,24400.933889721869,31007.894886051305,37614.855882380682,44221.816878710117,50828.777875039494,57435.738871368929,64042.699867698306,70649.660864027741,77256.621860357118,83863.582856686553,90470.54385301593,97077.504849345365,103684.46584567474,110291.42684200418,116898.38783833361,123505.34883466299,130112.30983099242,136719.2708273218,143326.23182365124,149933.19281998061,156540.15381631005,163147.11481263943,169754.07580896886,176361.03680529824,182967.99780162767,189574.95879795705,196181.91979428648,202788.88079061586,209395.8417869453,216002.80278327467,222609.76377960411,229216.72477593354,235823.68577226298,242430.6467685923,249037.60776492173,255644.56876125117,262251.5297575806,268858.49075390992,275465.45175023936,282072.41274656879,288679.37374289823,295286.33473922755,301893.29573555698,308500.25673188642,315107.21772821585,321714.17872454529,328321.13972087461,334928.10071720404,341535.06171353348],"y":[4.0166561309222489e-07,4.32992334707355e-07,4.6601398561339959e-07,5.0074991066108214e-07,5.3721236201982605e-07,5.7540588936492552e-07,6.1532674911267519e-07,6.569623399707331e-07,7.0029067228794709e-07,7.4527987882105513e-07,7.918877745771547e-07,8.4006147333379823e-07,8.8973706827720744e-07,9.4083938392910344e-07,9.9328180615109241e-07,1.046966196521258e-06,1.101782896771147e-06,1.1576108282551744e-06,1.2143176906029735e-06,1.2717602627848346e-06,1.3297848088093803e-06,1.3882275891813338e-06,1.4469154780877707e-06,1.5056666850673768e-06,1.5642915786643696e-06,1.6225936082935766e-06,1.6803703192634588e-06,1.7374144546383139e-06,1.7935151363885706e-06,1.8484591170984032e-06,1.9020320923920163e-06,1.9540200632226488e-06,2.0042107362594794e-06,2.0523949498238978e-06,2.098368112183223e-06,2.1419316385202358e-06,2.1828943725720719e-06,2.2210739787809191e-06,2.2562982908278098e-06,2.2884066026330542e-06,2.3172508883031018e-06,2.3426969380814119e-06,2.3646253981149621e-06,2.3829327027699423e-06,2.3975318893089344e-06,2.4083532859636409e-06,2.4153450657857458e-06,2.418473660115426e-06,2.4177240270519563e-06,2.4130997719220258e-06,2.4046231183957525e-06,2.3923347305741849e-06,2.3762933880412303e-06,2.3565755175133956e-06,2.3332745863089812e-06,2.3065003643718198e-06,2.276378063001969e-06,2.2430473597474074e-06,2.2066613200790598e-06,2.1673852274911216e-06,2.1253953345268683e-06,2.0808775479168973e-06,2.0340260615248529e-06,1.9850419511209672e-06,1.9341317451448745e-06,1.8815059855779303e-06,1.8273777928261258e-06,1.7719614481249753e-06,1.7154710064272034e-06,1.6581189520347523e-06,1.6001149084026723e-06,1.5416644125896146e-06,1.4829677637751936e-06,1.4242189541265823e-06,1.3656046890944061e-06,1.3073035029705254e-06,1.249484974267051e-06,1.1923090441957914e-06,1.1359254402587482e-06,1.0804732057205573e-06,1.0260803345391973e-06,9.7286351019660018e-07,9.2092794580922403e-07,8.7036732192153182e-07,8.2126381750227721e-07,7.7368822888205254e-07,7.2770017069638413e-07,6.8334835233532377e-07,6.406709229498324e-07,5.9969587772700809e-07,5.6044151791864969e-07,5.2291695698716554e-07,4.8712266521464462e-07,4.5305104519867976e-07,4.2068703082508364e-07,3.9000870255469703e-07,3.6098791218024597e-07,3.3359091059021111e-07,3.0777897251028843e-07,2.8350901266941177e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x4","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"","anchor":"y"},"xaxis2":{"domain":[0,0.3133333333333333],"automargin":true,"title":"Lag","anchor":"y5"},"xaxis3":{"domain":[0.35333333333333333,0.64666666666666661],"automargin":true,"title":"Theoretical Quantiles","anchor":"y4"},"xaxis4":{"domain":[0.68666666666666665,1],"automargin":true,"title":"Residuals","anchor":"y3"},"yaxis3":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Density","anchor":"x4"},"yaxis4":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Sample Quantiles","anchor":"x3"},"yaxis5":{"domain":[0,0.47999999999999998],"automargin":true,"title":"ACF","anchor":"x2"},"yaxis":{"domain":[0.52000000000000002,0.75039999999999996],"automargin":true,"title":"Residuals","anchor":"x"},"yaxis2":{"domain":[0.76960000000000006,1],"automargin":true,"title":"Value","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"showlegend":true,"legend":{"orientation":"h"},"hovermode":"closest","title":"Residual Plots"},"attrs":{"3fae78c2d383":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#0072B5"},"showlegend":true,"inherit":true},"3fae78c2d383.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8217412.0769230779,8311425.7199912472,8405439.3630594164,8499453.0061275866,8593466.6491957549,8687480.2922639251,8781493.9353320953,8875507.5784002636,8969521.2214684337,9063534.8645366021,9157548.5076047722,9251562.1506729405,9345575.7937411107,9439589.4368092809,9533603.0798774492,9627616.7229456194,9721630.3660137877,9815644.0090819579,9909657.6521501262,10003671.295218296,10191698.581354635,10285712.224422805,10379725.867490973,10473739.510559143,10567753.153627314,10661766.796695482,10755780.439763652,10849794.08283182,10943807.725899991,11037821.368968159,11131835.012036329,11225848.655104499,11319862.298172668,11413875.941240838,11507889.584309006,11601903.227377176,11695916.870445345],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6},"name":"Fitted","showlegend":true,"inherit":true},"3fae78c2d383.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":2007,"y":10097684.938286467,"type":"scatter","mode":"markers","marker":{"color":"orange","size":6},"name":"Fitted (2-3 SD)","showlegend":true,"inherit":true},"3fae200b507d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-312554.07692307793,-198391.71999124717,-91663.363059416413,-1605.0061275865883,41307.350804245099,-6867.2922639250755,-55306.93533209525,-84774.578400263563,-103980.22146843374,-94226.86453660205,-97075.507604772225,-69634.150672940537,-14369.793741110712,-68792.436809280887,69518.9201225508,99025.277054380625,81680.633986212313,141767.99091804214,214775.34784987383,325552.70478170365,341535.06171353348,323463.41864536516,225237.77557719499,162858.13250902668,151450.4894408565,114162.84637268633,93141.203304518014,25939.560236347839,119802.91716817953,-27439.725899990648,-32968.36896815896,-106046.01203632914,-113754.65510449931,-133512.29817266762,-181323.9412408378,-227560.58430900611,-242091.22737717628,-267280.8704453446],"type":"scatter","mode":"markers","name":"Residuals","marker":{"color":"#0072B5"},"showlegend":false,"inherit":true},"3fae200b507d.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":329887.53739538434,"xend":2024,"yend":329887.53739538434,"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"+2SD","showlegend":false,"inherit":true},"3fae200b507d.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":-329887.53739538434,"xend":2024,"yend":-329887.53739538434,"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"-2SD","showlegend":false,"inherit":true},"3fae200b507d.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":494831.30609307648,"xend":2024,"yend":494831.30609307648,"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"+3SD","showlegend":false,"inherit":true},"3fae200b507d.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":-494831.30609307648,"xend":2024,"yend":-494831.30609307648,"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"-3SD","showlegend":false,"inherit":true},"3faeca31b30":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"3faeca31b30.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"y":[0.84106695903932094,0.69215584847461842,0.53287040389823059,0.41069392156023093,0.31467311938832782,0.20503769031164124,0.088056712076365451,-0.025316009257497756,-0.13962684591972827,-0.21638408251867078,-0.31546769074676156,-0.38591625499318299,-0.41902541757658013,-0.46383024933849049,-0.47451018399032402,-0.44564771369940032,-0.42756950491400458,-0.39209634195421278,-0.34299543148521044,-0.27316619199985115,-0.19026493937121877,-0.10796531154420531,-0.038073018734628462,0.016995521872731331,0.031419816080256839,0.053832986026086473,0.061858308250549297,0.046776121910335922,0.081112641237364641,0.071629615963049814,0.074790877833544586,0.070396234969657717,0.087330099643598363,0.12361890813003673,0.14270638581165354,0.1278442137075787,0.082988801858789013],"marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"name":"ACF","showlegend":false,"inherit":true},"3faeca31b30.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":1,"y":0.31794814293719936,"xend":37,"yend":0.31794814293719936,"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"inherit":true},"3faeca31b30.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":1,"y":-0.31794814293719936,"xend":37,"yend":-0.31794814293719936,"mode":"lines","line":{"color":"black","dash":"dash"},"showlegend":false,"inherit":true},"3fae6981b626":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-1.8949129111747394,-1.6204363011446281,-1.4677197525471741,-1.3796252268618672,-1.202783964242123,-1.099307616604577,-0.80944129764227024,-0.68965718440074486,-0.6429222084205457,-0.63039799738665347,-0.58853698064029536,-0.57126659152125481,-0.55572492239713034,-0.51396047919601395,-0.42216902901354419,-0.41706599377732173,-0.33530781895410811,-0.1998764138133764,-0.16635806321535426,-0.087119348942768321,-0.041634141854186693,-0.0097306260203562575,0.15726305056052703,0.25043292711441639,0.42147042395985157,0.49520290842824888,0.56468458335778537,0.60035779366648701,0.69213191425208931,0.72632581463416612,0.85949285648901808,0.91819467104838093,0.98735547147290637,1.3021125292918088,1.3655427989523536,1.9610526738855347,1.9737193308489009,2.0706151218085593],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998},"name":"Sample","showlegend":false,"inherit":true},"3fae6981b626.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"inherit":true},"3fae28a5f63":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-519535.74651958392,-517445.62425377255,-515355.50198796112,-513265.37972214975,-511175.25745633832,-509085.13519052695,-506995.01292471553,-504904.89065890416,-502814.76839309273,-500724.64612728136,-498634.52386146993,-496544.40159565856,-494454.2793298472,-492364.15706403577,-490274.0347982244,-488183.91253241297,-486093.7902666016,-484003.66800079017,-481913.5457349788,-479823.42346916738,-477733.30120335601,-475643.17893754458,-473553.05667173321,-471462.93440592178,-469372.81214011041,-467282.68987429899,-465192.56760848762,-463102.44534267625,-461012.32307686482,-458922.20081105345,-456832.07854524202,-454741.95627943065,-452651.83401361923,-450561.71174780786,-448471.58948199643,-446381.46721618506,-444291.34495037363,-442201.22268456226,-440111.1004187509,-438020.97815293947,-435930.85588712804,-433840.73362131667,-431750.6113555053,-429660.48908969387,-427570.3668238825,-425480.24455807108,-423390.12229225971,-421300.00002644828,-419209.87776063691,-417119.75549482554,-415029.63322901411,-412939.51096320269,-410849.38869739132,-408759.26643157995,-406669.14416576852,-404579.02189995715,-402488.89963414572,-400398.77736833435,-398308.65510252293,-396218.53283671156,-394128.41057090013,-392038.28830508876,-389948.16603927733,-387858.04377346596,-385767.9215076546,-383677.79924184317,-381587.67697603174,-379497.55471022037,-377407.432444409,-375317.31017859757,-373227.18791278615,-371137.06564697484,-369046.94338116341,-366956.82111535198,-364866.69884954061,-362776.57658372924,-360686.45431791781,-358596.33205210639,-356506.20978629502,-354416.08752048365,-352325.96525467222,-350235.84298886079,-348145.72072304942,-346055.59845723805,-343965.47619142663,-341875.35392561526,-339785.23165980389,-337695.10939399246,-335604.98712818103,-333514.86486236966,-331424.7425965583,-329334.62033074687,-327244.49806493544,-325154.37579912407,-323064.2535333127,-320974.13126750127,-318884.0090016899,-316793.88673587854,-314703.76447006711,-312613.64220425568,-310523.51993844431,-308433.39767263294,-306343.27540682151,-304253.15314101009,-302163.03087519872,-300072.90860938735,-297982.78634357592,-295892.66407776449,-293802.54181195312,-291712.41954614175,-289622.29728033033,-287532.17501451896,-285442.05274870759,-283351.93048289616,-281261.80821708473,-279171.68595127336,-277081.563685462,-274991.44141965057,-272901.31915383914,-270811.19688802777,-268721.0746222164,-266630.95235640497,-264540.8300905936,-262450.70782478224,-260360.58555897081,-258270.46329315941,-256180.34102734801,-254090.21876153658,-252000.09649572521,-249909.97422991385,-247819.85196410242,-245729.72969829105,-243639.60743247962,-241549.48516666825,-239459.36290085682,-237369.24063504545,-235279.11836923403,-233188.99610342266,-231098.87383761123,-229008.75157179986,-226918.62930598843,-224828.50704017706,-222738.3847743657,-220648.26250855427,-218558.1402427429,-216468.01797693147,-214377.8957111201,-212287.77344530867,-210197.6511794973,-208107.52891368588,-206017.40664787451,-203927.28438206308,-201837.16211625171,-199747.03985044028,-197656.91758462891,-195566.79531881755,-193476.67305300612,-191386.55078719475,-189296.42852138332,-187206.30625557195,-185116.18398976052,-183026.06172394915,-180935.93945813773,-178845.81719232636,-176755.69492651493,-174665.57266070356,-172575.45039489213,-170485.32812908076,-168395.2058632694,-166305.08359745797,-164214.9613316466,-162124.83906583517,-160034.7168000238,-157944.59453421237,-155854.472268401,-153764.35000258958,-151674.22773677821,-149584.10547096678,-147493.98320515541,-145403.86093934398,-143313.73867353261,-141223.61640772125,-139133.49414190982,-137043.37187609845,-134953.24961028702,-132863.12734447565,-130773.00507866422,-128682.88281285285,-126592.76054704143,-124502.63828123006,-122412.51601541863,-120322.39374960726,-118232.27148379589,-116142.14921798446,-114052.0269521731,-111961.90468636167,-109871.7824205503,-107781.66015473887,-105691.5378889275,-103601.41562311607,-101511.2933573047,-99421.171091493277,-97331.048825681908,-95240.926559870481,-93150.804294059111,-91060.682028247742,-88970.559762436314,-86880.437496624945,-84790.315230813518,-82700.192965002148,-80610.070699190721,-78519.948433379352,-76429.826167567924,-74339.703901756555,-72249.581635945127,-70159.459370133758,-68069.337104322331,-65979.214838510961,-63889.092572699592,-61798.970306888164,-59708.848041076795,-57618.725775265368,-55528.603509453998,-53438.481243642571,-51348.358977831202,-49258.236712019774,-47168.114446208405,-45077.992180396977,-42987.869914585608,-40897.747648774181,-38807.625382962811,-36717.503117151442,-34627.380851340014,-32537.258585528645,-30447.136319717218,-28357.014053905848,-26266.891788094421,-24176.769522283052,-22086.647256471624,-19996.524990660255,-17906.402724848827,-15816.280459037458,-13726.158193226031,-11636.035927414661,-9545.913661603292,-7455.7913957918645,-5365.6691299804952,-3275.5468641690677,-1185.4245983576984,904.69766745372908,2994.8199332650984,5084.9421990764677,7175.0644648878952,9265.1867306993227,11355.30899651075,13445.431262322061,15535.553528133489,17625.675793944916,19715.798059756227,21805.920325567655,23896.042591379082,25986.16485719051,28076.287123001821,30166.409388813248,32256.531654624676,34346.653920436103,36436.776186247414,38526.898452058842,40617.020717870269,42707.142983681581,44797.265249493008,46887.387515304436,48977.509781115863,51067.632046927174,53157.754312738602,55247.876578550029,57337.998844361457,59428.121110172768,61518.243375984195,63608.365641795623,65698.48790760705,67788.610173418361,69878.732439229789,71968.854705041216,74058.976970852527,76149.099236663955,78239.221502475382,80329.34376828681,82419.466034098121,84509.588299909548,86599.710565720976,88689.832831532403,90779.955097343714,92870.077363155142,94960.199628966569,97050.321894777881,99140.444160589308,101230.56642640074,103320.68869221216,105410.81095802347,107500.9332238349,109591.05548964633,111681.17775545776,113771.30002126907,115861.4222870805,117951.54455289192,120041.66681870335,122131.78908451466,124221.91135032609,126312.03361613752,128402.15588194883,130492.27814776025,132582.40041357168,134672.52267938311,136762.64494519442,138852.76721100585,140942.88947681728,143033.0117426287,145123.13400844001,147213.25627425144,149303.37854006287,151393.50080587418,153483.62307168561,155573.74533749704,157663.86760330846,159753.98986911977,161844.1121349312,163934.23440074263,166024.35666655406,168114.47893236537,170204.6011981768,172294.72346398822,174384.84572979965,176474.96799561096,178565.09026142239,180655.21252723382,182745.33479304513,184835.45705885655,186925.57932466798,189015.70159047941,191105.82385629072,193195.94612210215,195286.06838791358,197376.190653725,199466.31291953631,201556.43518534774,203646.55745115917,205736.67971697048,207826.80198278191,209916.92424859334,212007.04651440476,214097.16878021607,216187.2910460275,218277.41331183893,220367.53557765036,222457.65784346167,224547.7801092731,226637.90237508452,228728.02464089595,230818.14690670726,232908.26917251869,234998.39143833012,237088.51370414143,239178.63596995285,241268.75823576428,243358.88050157571,245449.00276738702,247539.12503319845,249629.24729900988,251719.3695648213,253809.49183063261,255899.61409644404,257989.73636225547,260079.85862806678,262169.98089387821,264260.10315968964,266350.22542550106,268440.34769131237,270530.4699571238,272620.59222293523,274710.71448874666,276800.83675455797,278890.9590203694,280981.08128618082,283071.20355199213,285161.32581780356,287251.44808361499,289341.57034942642,291431.69261523773,293521.81488104915,295611.93714686058,297702.05941267201,299792.18167848332,301882.30394429475,303972.42621010618,306062.5484759176,308152.67074172891,310242.79300754034,312332.91527335177,314423.03753916308,316513.15980497451,318603.28207078594,320693.40433659736,322783.52660240867,324873.6488682201,326963.77113403153,329053.89339984296,331144.01566565427,333234.1379314657,335324.26019727712,337414.38246308843,339504.50472889986,341594.62699471129,343684.74926052272,345774.87152633403,347864.99379214545,349955.11605795688,352045.23832376831,354135.36058957962,356225.48285539105,358315.60512120248,360405.7273870139,362495.84965282521,364585.97191863664,366676.09418444807,368766.21645025938,370856.33871607081,372946.46098188224,375036.58324769366,377126.70551350497,379216.8277793164,381306.95004512783,383397.07231093926,385487.19457675057,387577.316842562,389667.43910837342,391757.56137418473,393847.68363999616,395937.80590580759,398027.92817161902,400118.05043743033,402208.17270324175,404298.29496905318,406388.41723486461,408478.53950067592,410568.66176648735,412658.78403229878,414748.9062981102,416839.02856392151,418929.15082973294,421019.27309554437,423109.39536135568,425199.51762716711,427289.63989297854,429379.76215878996,431469.88442460127,433560.0066904127,435650.12895622413,437740.25122203556,439830.37348784687,441920.4957536583,444010.61801946972,446100.74028528103,448190.86255109246,450280.98481690389,452371.10708271532,454461.22934852663,456551.35161433805,458641.47388014948,460731.59614596091,462821.71841177222,464911.84067758365,467001.96294339508,469092.0852092065,471182.20747501781,473272.32974082924,475362.45200664067,477452.57427245198,479542.69653826341,481632.81880407484,483722.94106988626,485813.06333569757,487903.185601509,489993.30786732043,492083.43013313186,494173.55239894317,496263.6746647546,498353.79693056602,500443.91919637733,502534.04146218876,504624.16372800019,506714.28599381162,508804.40825962293,510894.53052543435,512984.65279124578,515074.77505705721,517164.89732286852,519255.01958867995,521345.14185449138,523435.2641203028,525525.38638611417,527615.50865192548,529705.63091773679,531795.75318354834,533885.87544935965,535975.99771517096,538066.1199809825,540156.24224679382,542246.36451260536,544336.48677841667,546426.60904422798,548516.73131003953],"y":[1.9561490074985769e-09,2.150976313182825e-09,2.3605984942801456e-09,2.5830966048687359e-09,2.8337021511155475e-09,3.1015746137227141e-09,3.3853018561392059e-09,3.7049769688081032e-09,4.0445354344595857e-09,4.4044616316881577e-09,4.8078533620001899e-09,5.2348367150539579e-09,5.6882795820565756e-09,6.1926165611100487e-09,6.725254859913155e-09,7.29181234127371e-09,7.9173276350411319e-09,8.5764940355563244e-09,9.2785854623576856e-09,1.0048240039646544e-08,1.0857552304440365e-08,1.1720508679555665e-08,1.266004406751079e-08,1.3645900697860433e-08,1.4697978608304711e-08,1.5835892530482927e-08,1.7027428643881897e-08,1.8299731453733337e-08,1.9667162209665866e-08,2.109611122067015e-08,2.2622402596270251e-08,2.4252909614924846e-08,2.5953358656104927e-08,2.7769755986854629e-08,2.9698986639874843e-08,3.1707016520543415e-08,3.3851555444567874e-08,3.6116791827209995e-08,3.846999614573211e-08,4.0982062110970179e-08,4.3621646009071661e-08,4.6358528715698186e-08,4.9278157160364367e-08,5.233079667056896e-08,5.5490052758567912e-08,5.8857105856686012e-08,6.2361072901012062e-08,6.598076275940503e-08,6.9833997455398149e-08,7.3826231465480107e-08,7.7942865483966884e-08,8.2318914395417046e-08,8.6834053439408773e-08,9.1484288987991286e-08,9.6413902752147847e-08,1.0148326903133722e-07,1.0670491846283088e-07,1.1220983306056878e-07,1.1786040472008449e-07,1.2368002933721798e-07,1.2978325546741069e-07,1.3603666078868971e-07,1.4247490185740539e-07,1.4919336496864269e-07,1.5606493803615682e-07,1.6313553028045563e-07,1.704792006492009e-07,1.7797713936799104e-07,1.8568604961862054e-07,1.9365720698383544e-07,2.0178187478731826e-07,2.1012661164462935e-07,2.1871928518812267e-07,2.2746269688875513e-07,2.36431835767674e-07,2.4563145827985524e-07,2.5497698828302516e-07,2.64549953167141e-07,2.7433326495427227e-07,2.8425561249150722e-07,2.944027511465122e-07,3.047379846203347e-07,3.1520342575853823e-07,3.2588640902599371e-07,3.3673377893860856e-07,3.4770072884764426e-07,3.5887329689068434e-07,3.7018581375922783e-07,3.8160571498371432e-07,3.9321478386239818e-07,4.0493939914751848e-07,4.1675794230115317e-07,4.2874507285069953e-07,4.4082415376396414e-07,4.529828259987446e-07,4.652860435006213e-07,4.7765916278792252e-07,4.9009710646383933e-07,5.0265304393002184e-07,5.1525905555228696e-07,5.2791781115052027e-07,5.4066152477618557e-07,5.5344088016820245e-07,5.6626005332519228e-07,5.7913435651465891e-07,5.9203159834487631e-07,6.0495538224168917e-07,6.1790961419686537e-07,6.3087596585237859e-07,6.438563804505104e-07,6.5684855485063692e-07,6.6984450513381046e-07,6.8284414614428264e-07,6.9584345503721868e-07,7.088412200229328e-07,7.2183583094257771e-07,7.3482492375795454e-07,7.4781065297096547e-07,7.6079136805122666e-07,7.7376826426214376e-07,7.8674384807000118e-07,7.9971894456947661e-07,8.1269843312989377e-07,8.2568276438661595e-07,8.386787610779239e-07,8.5169314222081274e-07,8.6472268954557021e-07,8.7778463724324145e-07,8.9088367414147068e-07,9.0401223830043292e-07,9.1720306875969484e-07,9.3045303907062151e-07,9.4375058877298668e-07,9.5714942158512648e-07,9.7063119248879512e-07,9.8418171181955126e-07,9.9788106485093643e-07,1.0116871594571537e-06,1.0255854855671611e-06,1.0396873918664246e-06,1.0539180684236783e-06,1.0682657533921163e-06,1.0828768538925786e-06,1.0976352796595888e-06,1.1125408443387925e-06,1.127761325125453e-06,1.1431479906559789e-06,1.1587184938672267e-06,1.174638317880493e-06,1.1907449005916408e-06,1.2070717804850032e-06,1.2237717601976368e-06,1.2406747036546176e-06,1.2578314413298e-06,1.2753722184734416e-06,1.2931263408517179e-06,1.3111616762979692e-06,1.3295775795948575e-06,1.3482100565348269e-06,1.3671417303077215e-06,1.3864352859973531e-06,1.4059403655064693e-06,1.4257497838098696e-06,1.4458872314459893e-06,1.4662220287289641e-06,1.4868502299692605e-06,1.507758367606122e-06,1.5288400543355543e-06,1.5501853082372178e-06,1.5717499393104394e-06,1.5934545852941927e-06,1.6153718825574337e-06,1.637438063422728e-06,1.6596013111898512e-06,1.6819039059695101e-06,1.7042781019932137e-06,1.7266977606614369e-06,1.7491608155226633e-06,1.7716149702873339e-06,1.794055509949364e-06,1.8164217708352201e-06,1.838699184180399e-06,1.8608980029018764e-06,1.8828853086271922e-06,1.9047081123928943e-06,1.9263833423405452e-06,1.9476936582415387e-06,1.9687715813516104e-06,1.9896294332381669e-06,2.0099606734437612e-06,2.0300007074528452e-06,2.0497271439045574e-06,2.0688021051679907e-06,2.0875186235242954e-06,2.105821572012006e-06,2.1233667855490518e-06,2.1404916388143782e-06,2.1571002928819073e-06,2.1728672268241329e-06,2.1881593340763924e-06,2.2028342041245332e-06,2.2166081638600554e-06,2.2298621473509677e-06,2.2424039299676696e-06,2.2540116832531071e-06,2.2650651467490059e-06,2.2753219909375625e-06,2.2846377753602342e-06,2.2933769021315059e-06,2.3012497431421739e-06,2.3081994026155032e-06,2.3145626409063204e-06,2.3200083811300636e-06,2.3245714781855919e-06,2.3285511833846085e-06,2.3315836166826587e-06,2.333793471264966e-06,2.3354354777977335e-06,2.3361239703870109e-06,2.3360656767659215e-06,2.3354668721659583e-06,2.3339329221012026e-06,2.3317394872964427e-06,2.3290435501137979e-06,2.3254554421617019e-06,2.3213022671052646e-06,2.3166938047495091e-06,2.3112596534658189e-06,2.3053576387482768e-06,2.2990550181091231e-06,2.2920145466243224e-06,2.284602146495815e-06,2.2768493479829207e-06,2.2684647827653679e-06,2.2597993540919725e-06,2.250845490496489e-06,2.2414036727102859e-06,2.2317524711708186e-06,2.2218690146580276e-06,2.2116454225323258e-06,2.2012765888154075e-06,2.1907399058874812e-06,2.1799976920799213e-06,2.1691715491105288e-06,2.158247244834633e-06,2.1472354343877971e-06,2.1361963857287604e-06,2.1251308559428015e-06,2.1140768795591026e-06,2.1030461619324796e-06,2.0920591543771809e-06,2.0811624052080037e-06,2.0703319069181052e-06,2.0596103118035894e-06,2.0490369036929686e-06,2.0385642173370903e-06,2.0282572581345278e-06,2.0181361188904025e-06,2.0081409522089213e-06,1.9983568967136953e-06,1.9887772849615282e-06,1.9793393085682318e-06,1.970143768999066e-06,1.9611542577717638e-06,1.9523124230396634e-06,1.9437282622964297e-06,1.9353371868486731e-06,1.9270905015243789e-06,1.919099310892479e-06,1.9112766325048945e-06,1.9035863359385783e-06,1.8961313979320592e-06,1.8888118901969646e-06,1.8816049249883079e-06,1.8745955245716957e-06,1.8676831447670671e-06,1.8608567781747875e-06,1.8541736777687759e-06,1.84754694484657e-06,1.8409750997520386e-06,1.8344762034713897e-06,1.8279943677425132e-06,1.8215307021308092e-06,1.81506138409459e-06,1.8085711439791838e-06,1.8020545530714105e-06,1.7954564347581632e-06,1.788798935113884e-06,1.782064530105349e-06,1.7751790784022382e-06,1.7681969148378211e-06,1.7610834862351708e-06,1.753758841125624e-06,1.7463027967402487e-06,1.7386598987029664e-06,1.7307572295524683e-06,1.7226924853623221e-06,1.7143868609438321e-06,1.7057860127971526e-06,1.6969976004653787e-06,1.6879187029726029e-06,1.678522930740842e-06,1.6689202348913909e-06,1.6589846482797302e-06,1.6487242828432552e-06,1.6382444480582762e-06,1.6273990664692595e-06,1.6162340097520531e-06,1.6048441613895615e-06,1.593068050888758e-06,1.5809890534760471e-06,1.5686872982230553e-06,1.5559922282566654e-06,1.5430209594424775e-06,1.5298361873322116e-06,1.5162658810276772e-06,1.5024538536511108e-06,1.4884444145300522e-06,1.4740726216659249e-06,1.4594990794743127e-06,1.4447504504689682e-06,1.4296779913902085e-06,1.4144469024021656e-06,1.3990684964214649e-06,1.3834194570730029e-06,1.3676557808862636e-06,1.3517710494594773e-06,1.3356943447256241e-06,1.3195397543750397e-06,1.3032983207313686e-06,1.2869462757720948e-06,1.2705545161335006e-06,1.254118214135938e-06,1.2376506659057981e-06,1.2211827222936844e-06,1.2047195273747105e-06,1.1882998115117993e-06,1.17191904634731e-06,1.1555978779204642e-06,1.139388033399567e-06,1.1232554284325317e-06,1.1072411096151093e-06,1.0913972810823886e-06,1.0756669005801446e-06,1.0601153957854389e-06,1.0447835322541519e-06,1.0295983015459298e-06,1.0146523296109689e-06,9.9996425954798861e-07,9.8545213551525484e-07,9.7123723754136183e-07,9.5730718613099634e-07,9.4357778303652463e-07,9.30198911271061e-07,9.1712051642158711e-07,9.0426224229044887e-07,8.9180092922085575e-07,8.7964480830312697e-07,8.6772256333757849e-07,8.5623472759605564e-07,8.4504664567891794e-07,8.3410013344976692e-07,8.2361457905661027e-07,8.1341426952039036e-07,8.0345697180707871e-07,7.9397463698087224e-07,7.8475532442026199e-07,7.7577418909678264e-07,7.6726819737109359e-07,7.5899686816128812e-07,7.5096049867210259e-07,7.4336931098263435e-07,7.3598776662492345e-07,7.2883747281581141e-07,7.2207683902970702e-07,7.1550354994221354e-07,7.0914874961095759e-07,7.0312098308525331e-07,6.972537353431634e-07,6.9158297409221663e-07,6.8617223306783554e-07,6.8089152832125566e-07,6.7577634827420534e-07,6.7085256963775112e-07,6.6602570077469761e-07,6.6132521397633221e-07,6.5674863558003453e-07,6.5223432039553269e-07,6.4780034192810992e-07,6.4342646446816085e-07,6.3907988013338727e-07,6.3476243240169874e-07,6.3044723569907023e-07,6.261252620613025e-07,6.2177822506130636e-07,6.1738342519856445e-07,6.1294987869534351e-07,6.0843653573962043e-07,6.0383465233701955e-07,5.991652778919446e-07,5.9436349579459823e-07,5.8944249538608578e-07,5.8442948348586009e-07,5.7923627294502563e-07,5.7390356640683854e-07,5.6845937784552868e-07,5.6279460447399238e-07,5.5698020386272772e-07,5.5104051519180606e-07,5.4484957339119613e-07,5.3850825503160989e-07,5.3203388195981721e-07,5.2528919999741049e-07,5.184015735550199e-07,5.1137823826492907e-07,5.0408059566662857e-07,4.9665303948473954e-07,4.8908555089088268e-07,4.8126861975448754e-07,4.7333210643172172e-07,4.6525899887378616e-07,4.5697117963249362e-07,4.4857907786430744e-07,4.4006168889901347e-07,4.3137150272657705e-07,4.2259649718764653e-07,4.1371542619434097e-07,4.0470787387597039e-07,3.9563819032442877e-07,3.8648906538458664e-07,3.7726145940684716e-07,3.6799661414318124e-07,3.5868541876569078e-07,3.4934292248458198e-07,3.3998923190134478e-07,3.3062745629423598e-07,3.2127856806151796e-07,3.1194465471008733e-07,3.0264453113987964e-07,2.9339673984873744e-07,2.841892569803543e-07,2.7505931669940488e-07,2.6601513007017833e-07,2.5703489891388365e-07,2.4817605188895304e-07,2.3942956266198988e-07,2.307682786495966e-07,2.2227057059645696e-07,2.1390468202294786e-07,2.056423012457009e-07,1.9758244954897255e-07,1.8966683389721619e-07,1.8186970303107529e-07,1.7430945843391436e-07,1.6689927436728945e-07,1.5961901980331621e-07,1.526043484510195e-07,1.4573969846121899e-07,1.3901284670496707e-07,1.3257388077268174e-07,1.2627995115535222e-07,1.2013534531462019e-07,1.1427988278478083e-07,1.0856767794981986e-07,1.0301582194211384e-07,9.7742033047755125e-08,9.2609594440938237e-08,8.7644984247059165e-08,8.2942018506310015e-08,7.8376006415790006e-08,7.3981674545839191e-08,6.9828679795950782e-08,6.5806193393951489e-08,6.1955713697295701e-08,5.8323760442636928e-08,5.4814276509166002e-08,5.147386056257199e-08,4.8327899405221123e-08,4.5295221784381683e-08,4.2425791985856971e-08,3.9726548614665562e-08,3.7130676790985293e-08,3.4689821139048387e-08,3.239555214728286e-08,3.0194396548745457e-08,2.8138132556482104e-08,2.62061856161902e-08,2.4357077588104404e-08,2.2641375862042111e-08,2.1029517903390485e-08,1.9490482203637017e-08,1.8072522205999332e-08,1.6740017920007954e-08,1.5470793815411259e-08,1.4309943913150837e-08,1.3218383147889977e-08,1.2181195846192533e-08,1.1239726048209188e-08,1.0353611890508078e-08,9.5137085816740251e-09,8.7572569132072796e-09,8.044376166981261e-09,7.3703501614239465e-09,6.7681723329566955e-09,6.1997767411982623e-09,5.6643599882701919e-09,5.1887462673719844e-09,4.7395764294411128e-09,4.3192076180891683e-09,3.9458287973715635e-09,3.5940137219702893e-09,3.2669810046945293e-09],"type":"scatter","mode":"lines","fill":"tozeroy","fillcolor":"rgba(0, 114, 181, 0.3)","line":{"color":"#0072B5","width":2},"name":"Density","showlegend":false,"inherit":true},"3fae28a5f63.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-312554.07692307793,-305947.11592674849,-299340.15493041911,-292733.19393408968,-286126.2329377603,-279519.27194143087,-272912.31094510149,-266305.34994877205,-259698.38895244268,-253091.42795611324,-246484.46695978387,-239877.50596345443,-233270.54496712502,-226663.58397079562,-220056.62297446621,-213449.66197813681,-206842.7009818074,-200235.73998547799,-193628.77898914859,-187021.81799281918,-180414.85699648978,-173807.89600016037,-167200.93500383096,-160593.97400750156,-153987.01301117212,-147380.05201484272,-140773.09101851331,-134166.1300221839,-127559.1690258545,-120952.20802952509,-114345.24703319569,-107738.28603686628,-101131.32504053687,-94524.364044207468,-87917.403047878062,-81310.442051548656,-74703.48105521925,-68096.520058889844,-61489.559062560438,-54882.598066231032,-48275.637069901626,-41668.676073572191,-35061.715077242814,-28454.754080913379,-21847.793084584002,-15240.832088254567,-8633.8710919251898,-2026.9100955957547,4580.0509007336805,11187.011897063057,17793.972893392493,24400.933889721869,31007.894886051305,37614.855882380682,44221.816878710117,50828.777875039494,57435.738871368929,64042.699867698306,70649.660864027741,77256.621860357118,83863.582856686553,90470.54385301593,97077.504849345365,103684.46584567474,110291.42684200418,116898.38783833361,123505.34883466299,130112.30983099242,136719.2708273218,143326.23182365124,149933.19281998061,156540.15381631005,163147.11481263943,169754.07580896886,176361.03680529824,182967.99780162767,189574.95879795705,196181.91979428648,202788.88079061586,209395.8417869453,216002.80278327467,222609.76377960411,229216.72477593354,235823.68577226298,242430.6467685923,249037.60776492173,255644.56876125117,262251.5297575806,268858.49075390992,275465.45175023936,282072.41274656879,288679.37374289823,295286.33473922755,301893.29573555698,308500.25673188642,315107.21772821585,321714.17872454529,328321.13972087461,334928.10071720404,341535.06171353348],"y":[4.0166561309222489e-07,4.32992334707355e-07,4.6601398561339959e-07,5.0074991066108214e-07,5.3721236201982605e-07,5.7540588936492552e-07,6.1532674911267519e-07,6.569623399707331e-07,7.0029067228794709e-07,7.4527987882105513e-07,7.918877745771547e-07,8.4006147333379823e-07,8.8973706827720744e-07,9.4083938392910344e-07,9.9328180615109241e-07,1.046966196521258e-06,1.101782896771147e-06,1.1576108282551744e-06,1.2143176906029735e-06,1.2717602627848346e-06,1.3297848088093803e-06,1.3882275891813338e-06,1.4469154780877707e-06,1.5056666850673768e-06,1.5642915786643696e-06,1.6225936082935766e-06,1.6803703192634588e-06,1.7374144546383139e-06,1.7935151363885706e-06,1.8484591170984032e-06,1.9020320923920163e-06,1.9540200632226488e-06,2.0042107362594794e-06,2.0523949498238978e-06,2.098368112183223e-06,2.1419316385202358e-06,2.1828943725720719e-06,2.2210739787809191e-06,2.2562982908278098e-06,2.2884066026330542e-06,2.3172508883031018e-06,2.3426969380814119e-06,2.3646253981149621e-06,2.3829327027699423e-06,2.3975318893089344e-06,2.4083532859636409e-06,2.4153450657857458e-06,2.418473660115426e-06,2.4177240270519563e-06,2.4130997719220258e-06,2.4046231183957525e-06,2.3923347305741849e-06,2.3762933880412303e-06,2.3565755175133956e-06,2.3332745863089812e-06,2.3065003643718198e-06,2.276378063001969e-06,2.2430473597474074e-06,2.2066613200790598e-06,2.1673852274911216e-06,2.1253953345268683e-06,2.0808775479168973e-06,2.0340260615248529e-06,1.9850419511209672e-06,1.9341317451448745e-06,1.8815059855779303e-06,1.8273777928261258e-06,1.7719614481249753e-06,1.7154710064272034e-06,1.6581189520347523e-06,1.6001149084026723e-06,1.5416644125896146e-06,1.4829677637751936e-06,1.4242189541265823e-06,1.3656046890944061e-06,1.3073035029705254e-06,1.249484974267051e-06,1.1923090441957914e-06,1.1359254402587482e-06,1.0804732057205573e-06,1.0260803345391973e-06,9.7286351019660018e-07,9.2092794580922403e-07,8.7036732192153182e-07,8.2126381750227721e-07,7.7368822888205254e-07,7.2770017069638413e-07,6.8334835233532377e-07,6.406709229498324e-07,5.9969587772700809e-07,5.6044151791864969e-07,5.2291695698716554e-07,4.8712266521464462e-07,4.5305104519867976e-07,4.2068703082508364e-07,3.9000870255469703e-07,3.6098791218024597e-07,3.3359091059021111e-07,3.0777897251028843e-07,2.8350901266941177e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We can noticed from the residuals and ACF plots that the model goodness of fit improved with the addition of a second trend feature. Yet, the ACF plot indicate that some correlation left on the residuals within the first lag. An AR model with order 1 can help to remove this correlation.</p>
</section>
</section>
</section>
<section id="create-a-forecast" class="level2">
<h2 class="anchored" data-anchor-id="create-a-forecast">Create a Forecast</h2>
<p>Once we have trained the model on our series, we can use the model object to forecast the series’ future. The main requirement is to create the future data frame with the same features we used to train the model.</p>
<p>In the case of the above model, we need to create a future data frame with the continuous elements of the trend feature. Let’s assume we want to predict the next 5 years:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next, we use the <code>new_data</code> function from the <strong>tsibble</strong> library to create a continues data frame with the series future index:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>future_data <span class="ot">&lt;-</span> <span class="fu">new_data</span>(ts1, <span class="at">n =</span> h)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>future_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 5 x 1 [1Y]
  index
  &lt;dbl&gt;
1  2025
2  2026
3  2027
4  2028
5  2029</code></pre>
</div>
</div>
<p>Let’s now add the trend:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(ts1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 6 x 6 [1Y]
  index        y series_id trend      fit1     res1
  &lt;int&gt;    &lt;int&gt; &lt;chr&gt;     &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1  2019 11112094 SCA          33 11225849. -113755.
2  2020 11186350 SCA          34 11319862. -133512.
3  2021 11232552 SCA          35 11413876. -181324.
4  2022 11280329 SCA          36 11507890. -227561.
5  2023 11359812 SCA          37 11601903. -242091.
6  2024 11428636 SCA          38 11695917. -267281.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>trend_start <span class="ot">&lt;-</span> <span class="fu">max</span>(ts1<span class="sc">$</span>trend) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>trend <span class="ot">&lt;-</span> trend_start<span class="sc">:</span>(trend_start <span class="sc">+</span> h <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>future_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 5 x 2 [1Y]
  index trend
  &lt;dbl&gt; &lt;int&gt;
1  2025    39
2  2026    40
3  2027    41
4  2028    42
5  2029    43</code></pre>
</div>
</div>
<p>Let’s now use the <code>predict.lm</code> function to generate the forecast:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fc1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">object =</span> md1,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> future_data,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">interval =</span> <span class="st">"prediction"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>yhat <span class="ot">&lt;-</span> fc1[, <span class="dv">1</span>]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>lower <span class="ot">&lt;-</span> fc1[, <span class="dv">2</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>upper <span class="ot">&lt;-</span> fc1[, <span class="dv">3</span>]</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>future_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 5 x 5 [1Y]
  index trend      yhat     lower     upper
  &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1  2025    39 11789931. 11432704. 12147157.
2  2026    40 11883944. 11525312. 12242577.
3  2027    41 11977958. 11617854. 12338061.
4  2028    42 12071971. 11710334. 12433609.
5  2029    43 12165985. 11802750. 12529220.</code></pre>
</div>
</div>
<p>Let’s plot the forecast</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_ribbons</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> future_data<span class="sc">$</span>index, <span class="at">ymin =</span> future_data<span class="sc">$</span>lower,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> future_data<span class="sc">$</span>upper, <span class="at">name =</span> <span class="st">"95% Prediction Interval"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"rgba(7, 164, 181, 0.05)"</span>),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillcolor =</span> <span class="st">"rgba(7, 164, 181, 0.2)"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_lines</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> future_data<span class="sc">$</span>index,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> future_data<span class="sc">$</span>yhat,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Forecast"</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-769bbeac74a1ffc60b7d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-769bbeac74a1ffc60b7d">{"x":{"visdat":{"3fae75473045":["function () ","plotlyVisDat"]},"cur_data":"3fae75473045","attrs":{"3fae75473045":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","inherit":true},"3fae75473045.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8217412.0769230779,8311425.7199912472,8405439.3630594164,8499453.0061275866,8593466.6491957549,8687480.2922639251,8781493.9353320953,8875507.5784002636,8969521.2214684337,9063534.8645366021,9157548.5076047722,9251562.1506729405,9345575.7937411107,9439589.4368092809,9533603.0798774492,9627616.7229456194,9721630.3660137877,9815644.0090819579,9909657.6521501262,10003671.295218296,10097684.938286467,10191698.581354635,10285712.224422805,10379725.867490973,10473739.510559143,10567753.153627314,10661766.796695482,10755780.439763652,10849794.08283182,10943807.725899991,11037821.368968159,11131835.012036329,11225848.655104499,11319862.298172668,11413875.941240838,11507889.584309006,11601903.227377176,11695916.870445345],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","inherit":true},"3fae75473045.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2025,2026,2027,2028,2029],"ymin":[11432704.362552909,11525311.59801279,11617854.424689284,11710333.628452022,11802750.015600279],"ymax":[12147156.66447412,12242576.71515058,12338061.174610423,12433609.256984025,12529220.155972105],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"95% Prediction Interval","line":{"color":"rgba(7, 164, 181, 0.05)"},"fillcolor":"rgba(7, 164, 181, 0.2)","inherit":true},"3fae75473045.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2025,2026,2027,2028,2029],"y":[11789930.513513515,11883944.156581685,11977957.799649853,12071971.442718023,12165985.085786192],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"black","dash":"dash"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Natural Gas Consumers in California","yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Consumers"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Period"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8217412.0769230779,8311425.7199912472,8405439.3630594164,8499453.0061275866,8593466.6491957549,8687480.2922639251,8781493.9353320953,8875507.5784002636,8969521.2214684337,9063534.8645366021,9157548.5076047722,9251562.1506729405,9345575.7937411107,9439589.4368092809,9533603.0798774492,9627616.7229456194,9721630.3660137877,9815644.0090819579,9909657.6521501262,10003671.295218296,10097684.938286467,10191698.581354635,10285712.224422805,10379725.867490973,10473739.510559143,10567753.153627314,10661766.796695482,10755780.439763652,10849794.08283182,10943807.725899991,11037821.368968159,11131835.012036329,11225848.655104499,11319862.298172668,11413875.941240838,11507889.584309006,11601903.227377176,11695916.870445345],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(7, 164, 181, 0.2)","x":[2025,2026,2027,2028,2029,2029,2029,2028,2027,2026,2025],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"95% Prediction Interval","line":{"color":"rgba(7, 164, 181, 0.05)"},"y":[11432704.362552909,11525311.59801279,11617854.424689284,11710333.628452022,11802750.015600279,11802750.015600279,12529220.155972105,12433609.256984025,12338061.174610423,12242576.71515058,12147156.66447412],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2025,2026,2027,2028,2029],"y":[11789930.513513515,11883944.156581685,11977957.799649853,12071971.442718023,12165985.085786192],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"black","dash":"dash"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>That does not look like a great model…🥴</p>
</section>
<section id="improving-the-model" class="level2">
<h2 class="anchored" data-anchor-id="improving-the-model">Improving the model</h2>
<p>Reviewing the results, there are two features we can use to improve the forecast:</p>
<ul>
<li>Piecewise linear trend</li>
<li>Adding AR model</li>
<li>Combing both approaches</li>
</ul>
<section id="piecewise-linear-trend" class="level3">
<h3 class="anchored" data-anchor-id="piecewise-linear-trend">Piecewise Linear Trend</h3>
<p>Eyeballing the series, you can notice a change in the trend at around 2008. We will use this information to create a piecewise linear trend.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> ts1<span class="sc">$</span>trend[<span class="fu">which</span>(ts1<span class="sc">$</span>index <span class="sc">==</span> <span class="dv">2008</span>)]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ts1<span class="sc">$</span>trend2 <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, ts1<span class="sc">$</span>trend <span class="sc">-</span> s)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>md2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> trend <span class="sc">+</span> trend2, <span class="at">data =</span> ts1)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(md2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ trend + trend2, data = ts1)

Residuals:
    Min      1Q  Median      3Q     Max 
-144207  -28626   -5966   20935  165086 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7888957      30324  260.15  &lt; 2e-16 ***
trend         116146       2060   56.38  &lt; 2e-16 ***
trend2        -55084       4383  -12.57 1.57e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 72230 on 35 degrees of freedom
Multiple R-squared:  0.9956,    Adjusted R-squared:  0.9953 
F-statistic:  3949 on 2 and 35 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Let’s fit the model and plot it:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> md2, <span class="at">newdata =</span> ts1, <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ts1<span class="sc">$</span>fit2 <span class="ot">&lt;-</span> fit2[, <span class="dv">1</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_lines</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>fit2, <span class="at">mode =</span> <span class="st">"lines"</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>), <span class="at">name =</span> <span class="st">"Fitted"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-15cb43a758efbf65b334" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-15cb43a758efbf65b334">{"x":{"visdat":{"3fae75473045":["function () ","plotlyVisDat"]},"cur_data":"3fae75473045","attrs":{"3fae75473045":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","inherit":true},"3fae75473045.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8353542.1359007414,8469688.3266999498,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9515004.0438928157,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Natural Gas Consumers in California","yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Consumers"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Period"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8353542.1359007414,8469688.3266999498,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9515004.0438928157,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We will add to the plot the features:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>trend1 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_lines</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>trend, <span class="at">name =</span> <span class="st">"Main Trend Feature"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>trend2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_lines</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>trend2, <span class="at">name =</span> <span class="st">"Piecewise Trend Feature"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subplot</span>(p2, trend1, trend2, <span class="at">nrows =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ef92bef35d8b12dfd78e" style="width:100%;height:928px;"></div>
<script type="application/json" data-for="htmlwidget-ef92bef35d8b12dfd78e">{"x":{"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8353542.1359007414,8469688.3266999498,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9515004.0438928157,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],"type":"scatter","mode":"lines","name":"Main Trend Feature","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"type":"scatter","mode":"lines","name":"Piecewise Trend Feature","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x3","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"anchor":"y2"},"xaxis3":{"domain":[0,1],"automargin":true,"anchor":"y3"},"yaxis3":{"domain":[0,0.31333333333333335],"automargin":true,"anchor":"x3"},"yaxis2":{"domain":[0.35333333333333339,0.64666666666666672],"automargin":true,"anchor":"x2"},"yaxis":{"domain":[0.68666666666666676,1],"automargin":true,"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Natural Gas Consumers in California","hovermode":"closest","showlegend":true},"attrs":{"3fae75473045":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","inherit":true},"3fae75473045.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8353542.1359007414,8469688.3266999498,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9515004.0438928157,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","inherit":true},"3fae7cd7f3a4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],"type":"scatter","mode":"lines","name":"Main Trend Feature","inherit":true},"3fae7ab0322":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"type":"scatter","mode":"lines","name":"Piecewise Trend Feature","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s check the model residuals:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_residuals</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ts1,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">index_col =</span> <span class="st">"index"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_col =</span> <span class="st">"y"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_col =</span> <span class="st">"fit2"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag_max =</span> <span class="dv">60</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-6cc93722323271b8427f" style="width:100%;height:780px;"></div>
<script type="application/json" data-for="htmlwidget-6cc93722323271b8427f">{"x":{"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#0072B5"},"showlegend":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1987,1988,1989,1992,1993,1994,1995,1996,1997,1998,1999,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6,"line":{"color":"rgba(255,127,14,1)"}},"name":"Fitted","showlegend":true,"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1990,1991,2000],"y":[8353542.1359007414,8469688.3266999498,9515004.0438928157],"type":"scatter","mode":"markers","marker":{"color":"orange","size":6,"line":{"color":"rgba(44,160,44,1)"}},"name":"Fitted (2-3 SD)","showlegend":true,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-100245.56350311916,-8215.7543023265898,76380.054898465984,144305.86409925856,165085.6733000502,94778.482500843704,24206.291701637208,-27393.899097571149,-68732.089896779507,-81111.280695986003,-106092.4714951925,-100783.66229440086,-67651.853093609214,-144207.04389281571,-28028.234692022204,-20654.425491230562,-60131.61629043892,-22176.807089645416,28698.002111148089,117342.81131193973,111192.62051273137,70988.429713524878,5714.4855684451759,-23713.458576634526,-2169.402721716091,-6505.3468667939305,5424.7089881263673,-28825.235156953335,97989.8206979651,-16301.123447112739,11121.932407807559,-29004.011737274006,-3760.9558823537081,9433.0999725665897,-5426.8441725112498,-18711.788317592815,-290.7324626725167,7471.3233922477812],"type":"scatter","mode":"markers","name":"Residuals","marker":{"color":"#0072B5","line":{"color":"rgba(214,39,40,1)"}},"showlegend":false,"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[140510.80745405925,140510.80745405925],"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"+2SD","showlegend":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-140510.80745405925,-140510.80745405925],"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"-2SD","showlegend":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[210766.21118108887,210766.21118108887],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"+3SD","showlegend":false,"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-210766.21118108887,-210766.21118108887],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"-3SD","showlegend":false,"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"y":[0.66727912590088878,0.39433072521635865,0.066837170795422285,-0.12528212699594296,-0.22443646927428507,-0.31131320215492581,-0.33085886857078795,-0.32067766961215488,-0.28831342785923375,-0.2688474305018001,-0.22376488769791514,-0.16312496879068664,-0.0047876879312503187,0.079133102557330734,0.1417251335917647,0.26494977099798028,0.17595447570725967,0.065051666856917864,-0.068536030188884822,-0.1048826362023567,-0.051084440507053269,0.018920317914700144,0.051764345873673394,0.071831684482943872,0.063579522784237313,0.025907666946471671,-0.009889915694685664,-0.070946864546330729,-0.0061924162915878078,-0.014695218790214067,-0.00032828113511730578,-0.011800545496111809,-0.0062356832030951688,0.0096027062910766254,0.013408991171477947,-0.00017652482566810632,-0.0041011108184156033],"marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"name":"ACF","showlegend":false,"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"scatter","x":[1,37],"y":[0.31794814293719936,0.31794814293719936],"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"scatter","x":[1,37],"y":[-0.31794814293719936,-0.31794814293719936],"mode":"lines","line":{"color":"black","dash":"dash"},"showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.0526114183774098,-1.51009695862548,-1.4345325334117485,-1.4268733532955482,-1.1545201705926558,-0.97831748521197526,-0.96294163159981117,-0.85590023116334901,-0.41283673850863273,-0.41029207189458422,-0.39894774216832152,-0.38991874851374508,-0.33753216576437245,-0.31565980569710106,-0.293990560092451,-0.26633948884979369,-0.23202661407297975,-0.11694124389702794,-0.092595679786710142,-0.077244509099924322,-0.05353262073571842,-0.030878802293204891,-0.0041382220761590925,0.077214117353924638,0.081338733610415118,0.10634517767881196,0.13426867503626927,0.15830714532679327,0.34454704431972522,0.40848106464025419,1.010433731038586,1.0871769407977916,1.349056121990216,1.394765605200913,1.5826913605785982,1.6702318268337535,2.0540180035110818,2.3497932478115704],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998,"line":{"color":"rgba(44,160,44,1)"}},"name":"Sample","showlegend":false,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x3","yaxis":"y4","frame":null},{"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x3","yaxis":"y4","frame":null},{"fillcolor":"rgba(0, 114, 181, 0.3)","x":[-192451.11456963804,-191657.0228699384,-190862.93117023879,-190068.83947053915,-189274.74777083952,-188480.65607113991,-187686.56437144027,-186892.47267174063,-186098.38097204099,-185304.28927234138,-184510.19757264174,-183716.10587294211,-182922.0141732425,-182127.92247354286,-181333.83077384322,-180539.73907414361,-179745.64737444397,-178951.55567474433,-178157.46397504472,-177363.37227534509,-176569.28057564545,-175775.18887594581,-174981.0971762462,-174187.00547654656,-173392.91377684695,-172598.82207714731,-171804.73037744767,-171010.63867774804,-170216.54697804843,-169422.45527834879,-168628.36357864915,-167834.27187894954,-167040.1801792499,-166246.08847955026,-165451.99677985066,-164657.90508015102,-163863.81338045138,-163069.72168075177,-162275.62998105213,-161481.53828135249,-160687.44658165285,-159893.35488195324,-159099.26318225361,-158305.171482554,-157511.07978285436,-156716.98808315472,-155922.89638345508,-155128.80468375547,-154334.71298405583,-153540.6212843562,-152746.52958465659,-151952.43788495695,-151158.34618525731,-150364.25448555767,-149570.16278585806,-148776.07108615842,-147981.97938645881,-147187.88768675918,-146393.79598705954,-145599.7042873599,-144805.61258766029,-144011.52088796065,-143217.42918826104,-142423.3374885614,-141629.24578886176,-140835.15408916213,-140041.06238946249,-139246.97068976288,-138452.87899006324,-137658.78729036363,-136864.69559066399,-136070.60389096435,-135276.51219126472,-134482.42049156511,-133688.32879186547,-132894.23709216586,-132100.14539246622,-131306.05369276658,-130511.96199306696,-129717.87029336733,-128923.7785936677,-128129.68689396806,-127335.59519426843,-126541.50349456881,-125747.41179486917,-124953.32009516955,-124159.22839546992,-123365.13669577028,-122571.04499607066,-121776.95329637104,-120982.8615966714,-120188.76989697177,-119394.67819727215,-118600.58649757251,-117806.49479787289,-117012.40309817325,-116218.31139847363,-115424.219698774,-114630.12799907436,-113836.03629937474,-113041.9445996751,-112247.85289997548,-111453.76120027585,-110659.66950057622,-109865.57780087659,-109071.48610117697,-108277.39440147733,-107483.30270177771,-106689.21100207808,-105895.11930237844,-105101.02760267882,-104306.93590297918,-103512.84420327956,-102718.75250357993,-101924.6608038803,-101130.56910418067,-100336.47740448103,-99542.385704781409,-98748.294005081785,-97954.202305382147,-97160.110605682523,-96366.018905982899,-95571.927206283261,-94777.835506583637,-93983.743806884013,-93189.652107184374,-92395.560407484751,-91601.468707785112,-90807.377008085488,-90013.285308385864,-89219.193608686226,-88425.101908986602,-87631.010209286964,-86836.91850958734,-86042.826809887716,-85248.735110188078,-84454.643410488454,-83660.55171078883,-82866.460011089192,-82072.368311389568,-81278.276611689944,-80484.184911990305,-79690.093212290682,-78896.001512591043,-78101.909812891419,-77307.818113191795,-76513.726413492157,-75719.634713792533,-74925.543014092895,-74131.451314393271,-73337.359614693647,-72543.267914994009,-71749.176215294385,-70955.084515594761,-70160.992815895122,-69366.901116195499,-68572.809416495875,-67778.717716796236,-66984.626017096612,-66190.534317396974,-65396.44261769735,-64602.350917997726,-63808.259218298088,-63014.167518598464,-62220.075818898826,-61425.984119199202,-60631.892419499578,-59837.80071979994,-59043.709020100301,-58249.617320400692,-57455.525620701053,-56661.433921001415,-55867.342221301806,-55073.250521602167,-54279.158821902529,-53485.06712220292,-52690.975422503281,-51896.883722803643,-51102.792023104033,-50308.700323404395,-49514.608623704757,-48720.516924005147,-47926.425224305509,-47132.33352460587,-46338.241824906261,-45544.150125206623,-44750.058425506984,-43955.966725807346,-43161.875026107737,-42367.783326408098,-41573.69162670846,-40779.59992700885,-39985.508227309212,-39191.416527609574,-38397.324827909964,-37603.233128210326,-36809.141428510688,-36015.049728811078,-35220.95802911144,-34426.866329411801,-33632.774629712163,-32838.682930012554,-32044.591230312915,-31250.499530613277,-30456.407830913668,-29662.316131214029,-28868.224431514391,-28074.132731814781,-27280.041032115143,-26485.949332415505,-25691.857632715895,-24897.765933016257,-24103.674233316618,-23309.582533617009,-22515.490833917371,-21721.399134217732,-20927.307434518123,-20133.215734818485,-19339.124035118846,-18545.032335419208,-17750.940635719599,-16956.84893601996,-16162.757236320322,-15368.665536620712,-14574.573836921074,-13780.482137221436,-12986.390437521826,-12192.298737822188,-11398.207038122549,-10604.11533842294,-9810.0236387233017,-9015.9319390236633,-8221.8402393240249,-7427.7485396244156,-6633.6568399247772,-5839.5651402251387,-5045.4734405255294,-4251.381740825891,-3457.2900411262526,-2663.1983414266433,-1869.1066417270049,-1075.0149420273665,-280.92324232775718,513.16845737188123,1307.2601570715196,2101.351856771129,2895.4435564707674,3689.5352561704058,4483.6269558700151,5277.7186555696535,6071.8103552692919,6865.9020549689303,7659.9937546685396,8454.085454368178,9248.1771540678164,10042.268853767426,10836.360553467064,11630.452253166703,12424.543952866312,13218.63565256595,14012.727352265589,14806.819051965198,15600.910751664836,16395.002451364475,17189.094151064113,17983.185850763723,18777.277550463361,19571.369250162999,20365.460949862609,21159.552649562247,21953.644349261886,22747.736048961495,23541.827748661133,24335.919448360772,25130.011148060381,25924.102847760019,26718.194547459658,27512.286247159267,28306.377946858905,29100.469646558544,29894.561346258153,30688.653045957792,31482.74474565743,32276.836445357068,33070.928145056678,33865.019844756316,34659.111544455955,35453.203244155564,36247.294943855202,37041.386643554841,37835.47834325445,38629.570042954088,39423.661742653727,40217.753442353336,41011.845142052975,41805.936841752613,42600.028541452251,43394.120241151861,44188.211940851499,44982.303640551138,45776.395340250747,46570.487039950385,47364.578739650024,48158.670439349633,48952.762139049271,49746.85383874891,50540.945538448519,51335.037238148157,52129.128937847796,52923.220637547405,53717.312337247044,54511.404036946682,55305.495736646291,56099.58743634593,56893.679136045568,57687.770835745207,58481.862535444816,59275.954235144454,60070.045934844093,60864.137634543702,61658.22933424334,62452.321033942979,63246.412733642588,64040.504433342227,64834.596133041865,65628.687832741474,66422.779532441113,67216.871232140751,68010.96293184039,68805.054631539999,69599.146331239637,70393.238030939247,71187.329730638885,71981.421430338523,72775.513130038162,73569.6048297378,74363.696529437439,75157.788229137019,75951.879928836657,76745.971628536296,77540.063328235934,78334.155027935572,79128.246727635211,79922.338427334791,80716.430127034429,81510.521826734068,82304.613526433706,83098.705226133345,83892.796925832983,84686.888625532563,85480.980325232202,86275.07202493184,87069.163724631479,87863.255424331117,88657.347124030755,89451.438823730394,90245.530523429974,91039.622223129612,91833.713922829251,92627.805622528889,93421.897322228528,94215.989021928166,95010.080721627746,95804.172421327385,96598.264121027023,97392.355820726661,98186.4475204263,98980.539220125938,99774.630919825519,100568.72261952516,101362.8143192248,102156.90601892443,102950.99771862407,103745.08941832371,104539.18111802335,105333.27281772293,106127.36451742257,106921.45621712221,107715.54791682184,108509.63961652148,109303.73131622112,110097.8230159207,110891.91471562034,111686.00641531998,112480.09811501962,113274.18981471926,114068.28151441889,114862.37321411853,115656.46491381811,116450.55661351775,117244.64831321739,118038.74001291703,118832.83171261667,119626.9234123163,120421.01511201588,121215.10681171552,122009.19851141516,122803.2902111148,123597.38191081444,124391.47361051408,125185.56531021371,125979.6570099133,126773.74870961293,127567.84040931257,128361.93210901221,129156.02380871185,129950.11550841149,130744.20720811107,131538.29890781071,132332.39060751034,133126.48230720998,133920.57400690962,134714.66570660926,135508.75740630884,136302.84910600848,137096.94080570812,137891.03250540775,138685.12420510739,139479.21590480703,140273.30760450667,141067.39930420625,141861.49100390589,142655.58270360553,143449.67440330517,144243.7661030048,145037.85780270444,145831.94950240402,146626.04120210366,147420.1329018033,148214.22460150294,149008.31630120258,149802.40800090221,150596.49970060179,151390.59140030143,152184.68310000107,152978.77479970071,153772.86649940035,154566.95819909999,155361.04989879963,156155.14159849921,156949.23329819884,157743.32499789848,158537.41669759812,159331.50839729776,160125.6000969974,160919.69179669698,161713.78349639662,162507.87519609625,163301.96689579589,164096.05859549553,164890.15029519517,165684.24199489481,166478.33369459439,167272.42539429403,168066.51709399367,168860.6087936933,169654.70049339294,170448.79219309258,171242.88389279216,172036.9755924918,172831.06729219144,173625.15899189108,174419.25069159071,175213.34239129035,176007.43409098999,176801.52579068957,177595.61749038921,178389.70919008885,179183.80088978849,179977.89258948812,180771.98428918776,181566.07598888734,182360.16768858698,183154.25938828662,183948.35108798626,184742.4427876859,185536.53448738554,186330.62618708512,187124.71788678475,187918.80958648439,188712.90128618403,189506.99298588367,190301.08468558331,191095.17638528295,191889.26808498253,192683.35978468216,193477.4514843818,194271.54318408144,195065.63488378108,195859.72658348072,196653.8182831803,197447.90998287994,198242.00168257958,199036.09338227921,199830.18508197885,200624.27678167849,201418.36848137807,202212.46018107771,203006.55188077735,203800.64358047699,204594.73528017662,205388.82697987626,206182.9186795759,206977.01037927548,207771.10207897512,208565.19377867476,209359.2854783744,210153.37717807404,210947.46887777367,211741.56057747325,212535.65227717289,213329.74397687253],"y":[7.3123970620532296e-09,8.4601862586359111e-09,9.7460776752355988e-09,1.1255879500261043e-08,1.2954557092405875e-08,1.4848330020281295e-08,1.6950772931364713e-08,1.936634059908155e-08,2.2073927498975135e-08,2.5062963716576082e-08,2.8350215695922853e-08,3.2051272255553785e-08,3.6177960927429055e-08,4.068769606656635e-08,4.5599077982789027e-08,5.1025117658264498e-08,5.7033804198685623e-08,6.353189404069476e-08,7.0537132676649895e-08,7.8141274887286996e-08,8.6490156940873834e-08,9.5421748426106401e-08,1.0494895520528328e-07,1.1512260915739398e-07,1.2617692348609769e-07,1.3787022817878902e-07,1.5020583735826953e-07,1.6318656878962136e-07,1.7710173748636517e-07,1.9165589721662243e-07,2.0683144409377627e-07,2.2261698581109558e-07,2.3920822715397954e-07,2.5638791055332848e-07,2.7408078955926375e-07,2.9225889527160954e-07,3.1100712311067907e-07,3.301780036131498e-07,3.496616662123495e-07,3.6941475845427369e-07,3.8941961266288753e-07,4.095606830503386e-07,4.2973900852431872e-07,4.4990161490524402e-07,4.699635556400545e-07,4.8978210269842232e-07,5.0932948853742585e-07,5.2855332726618731e-07,5.4735576479822626e-07,5.655081271626052e-07,5.8311163452810433e-07,6.001275741405513e-07,6.1650146114767464e-07,6.3189158172483679e-07,6.4655954433263384e-07,6.6049335952059388e-07,6.736824417123988e-07,6.8581456177990723e-07,6.9718668917036942e-07,7.0785826415023775e-07,7.1785508095293794e-07,7.2702254754771504e-07,7.3560011561549288e-07,7.4372363067907206e-07,7.5145701861134716e-07,7.5883065748644231e-07,7.6604966877918521e-07,7.7326201504770006e-07,7.8056233532447105e-07,7.8813159628101226e-07,7.9622894171786291e-07,8.0490568345629123e-07,8.142708436508007e-07,8.2456851221174789e-07,8.3623654016555685e-07,8.4910303877766609e-07,8.6326885041896763e-07,8.7892769832657817e-07,8.9680594810937484e-07,9.1640456656477983e-07,9.3779213642577562e-07,9.6103544992096637e-07,9.8711224060901476e-07,1.0152314977255727e-06,1.0453854914267386e-06,1.0775881295030837e-06,1.1126127929062193e-06,1.1498085161870049e-06,1.1889579959681067e-06,1.2300130059427268e-06,1.2734332669201636e-06,1.3187663872244725e-06,1.365626887132276e-06,1.4139086920602841e-06,1.4637429467746425e-06,1.5148205827248078e-06,1.5667108041835226e-06,1.6192677775109127e-06,1.6723734968891225e-06,1.7257140115789584e-06,1.7789896191078495e-06,1.8320431880335857e-06,1.8846521111361982e-06,1.9363140225666162e-06,1.9870395662652712e-06,2.0366924995356462e-06,2.0851055017834471e-06,2.1314448703456186e-06,2.1761544047334969e-06,2.2191463659897699e-06,2.2603355618099011e-06,2.2988041570076221e-06,2.3351643919316848e-06,2.3694867273440679e-06,2.4017501457203493e-06,2.4312366063501199e-06,2.4584395607064144e-06,2.4836470657834625e-06,2.5068998689586406e-06,2.5277655169610944e-06,2.5465428249473831e-06,2.5636760583580648e-06,2.5792491404382546e-06,2.5930955881157207e-06,2.605348729325607e-06,2.6164873304642535e-06,2.6266092712078575e-06,2.6357203773790406e-06,2.6438710399826335e-06,2.6514452187208336e-06,2.6585238199894448e-06,2.6651705224177337e-06,2.6714192200902279e-06,2.6774799291540725e-06,2.6833935871699048e-06,2.6891991647121272e-06,2.694912233808933e-06,2.7005769896590398e-06,2.7061876963096184e-06,2.7117359095261887e-06,2.7171508947352229e-06,2.7223960042695851e-06,2.7274361125246679e-06,2.732227315456765e-06,2.7365927016015144e-06,2.7404671198888299e-06,2.7438484753235976e-06,2.7466849730485213e-06,2.7487595157396758e-06,2.7499778977902251e-06,2.7504537480309685e-06,2.7501631113743391e-06,2.7489535948946721e-06,2.7467182509025985e-06,2.7437271466864703e-06,2.7400178889882894e-06,2.7355815357646189e-06,2.7304124855783274e-06,2.7248745914593098e-06,2.7190884448061335e-06,2.7131818552387384e-06,2.7075178245937186e-06,2.7023514395466034e-06,2.6978876077684915e-06,2.6943344298325644e-06,2.6926423231279411e-06,2.6928225323864345e-06,2.6950755246611575e-06,2.6996697286582874e-06,2.7080162177276826e-06,2.7200971020319491e-06,2.7358572472569148e-06,2.7555815413955722e-06,2.7808815411979022e-06,2.8120277717847345e-06,2.8484200967109285e-06,2.8903039578118798e-06,2.9391567101969441e-06,2.9958533863415712e-06,3.059009100925396e-06,3.1287741052099257e-06,3.2061799645992619e-06,3.2928829836778754e-06,3.3866203394729863e-06,3.4874047973645738e-06,3.5956309739548644e-06,3.713658720771101e-06,3.8384727139812438e-06,3.9699303881479754e-06,4.1078825845557989e-06,4.2547201336201266e-06,4.40733025434913e-06,4.5653303383617592e-06,4.7284296011399074e-06,4.8977924428797143e-06,5.0713782940010466e-06,5.2484009614403894e-06,5.4284695988158586e-06,5.6116817611606358e-06,5.7967724270678568e-06,5.9829255043481129e-06,6.1697091123531149e-06,6.3565027525392719e-06,6.5423199970955263e-06,6.726743433186829e-06,6.9093619154675489e-06,7.0892701178353998e-06,7.2652081184755602e-06,7.437533645484072e-06,7.6059057875498136e-06,7.7695418558314406e-06,7.9264381776773239e-06,8.0779678761415167e-06,8.2238869543321005e-06,8.3638362038105584e-06,8.4947644008543835e-06,8.6191299418784412e-06,8.7367868527214079e-06,8.847592952855436e-06,8.9484346304959287e-06,9.0416685855407484e-06,9.127597809322194e-06,9.2061578112930603e-06,9.2747328969257174e-06,9.33486645889645e-06,9.3874666636642257e-06,9.4325192240390628e-06,9.4679825809981882e-06,9.4944154520388642e-06,9.5133080965983845e-06,9.5246735484767997e-06,9.5270541015751202e-06,9.5199766577564028e-06,9.5054749014196415e-06,9.4835791445060682e-06,9.4534053645852866e-06,9.4134832366980741e-06,9.3663527074200888e-06,9.3120655841302439e-06,9.2502972166282378e-06,9.1786878528331224e-06,9.10023213851117e-06,9.0150166761225843e-06,8.9231298418927908e-06,8.8218624793156808e-06,8.7142218478387529e-06,8.6004560917871885e-06,8.4807024025628254e-06,8.3530681237353019e-06,8.2195360910374714e-06,8.0808048242707714e-06,7.9370647901551004e-06,7.7872072631698787e-06,7.632373559568201e-06,7.4735515745525321e-06,7.3109767178770079e-06,7.1442051956945133e-06,6.9738149735073609e-06,6.8008578615132663e-06,6.6255945257573424e-06,6.4480506626829043e-06,6.2685878687957028e-06,6.0880654300138036e-06,5.9067440075192801e-06,5.7248821482420457e-06,5.5429888473291638e-06,5.3614901329609407e-06,5.1806231721548857e-06,5.0006464288256838e-06,4.8225401598872108e-06,4.6461138826779589e-06,4.4715654193903201e-06,4.2990907033510764e-06,4.1299961049438349e-06,3.9637597904477527e-06,3.8004047595461068e-06,3.640081783087134e-06,3.4841231545677663e-06,3.3320997471363095e-06,3.1837121178576458e-06,3.0390689692071998e-06,2.8993619147854349e-06,2.7645187450659395e-06,2.6338462283544342e-06,2.5074182579445772e-06,2.386177171187805e-06,2.2705822504567304e-06,2.15951441478828e-06,2.0530196406600053e-06,1.9517242579587999e-06,1.8567168624477146e-06,1.7664458198344386e-06,1.6809325838463596e-06,1.6004491841711033e-06,1.526744542727431e-06,1.45784780780283e-06,1.3937550035183431e-06,1.3344610072669755e-06,1.2820654263865377e-06,1.2344911780654849e-06,1.1916136884482329e-06,1.1533984190618418e-06,1.121486600868885e-06,1.0944712981479414e-06,1.0718701887085559e-06,1.0536157179469002e-06,1.0408675628603038e-06,1.0328484372630157e-06,1.0287725551854679e-06,1.0285390837747287e-06,1.0328459920803907e-06,1.0414386108964486e-06,1.0533258660655241e-06,1.0683788436324448e-06,1.0869019245791947e-06,1.1089961532065725e-06,1.133600881743661e-06,1.1605701725728854e-06,1.1899246862048335e-06,1.221917217850759e-06,1.2555719589902828e-06,1.2907412857171628e-06,1.3272950015274539e-06,1.3654332087564744e-06,1.4044096657245923e-06,1.4440914457005516e-06,1.4843466273889459e-06,1.5250993880595675e-06,1.5659968172439805e-06,1.6069144230692464e-06,1.647748929082827e-06,1.6882653192730653e-06,1.7283371008963967e-06,1.7679249131805664e-06,1.8069606012607677e-06,1.8451822226870592e-06,1.8825207077196756e-06,1.9190682774811037e-06,1.9547901809135401e-06,1.9894775990518756e-06,2.0230131924630025e-06,2.0556207788984784e-06,2.087289978025044e-06,2.1178947239713411e-06,2.1472174548942613e-06,2.1755839377410124e-06,2.2029949106620434e-06,2.2294032022638696e-06,2.2544664106312158e-06,2.2785789199615035e-06,2.3017393820937905e-06,2.3239461393915068e-06,2.3447644012046456e-06,2.3645849880283573e-06,2.3834153377521394e-06,2.4012422406124365e-06,2.4176532449523305e-06,2.4328930726521568e-06,2.447030551135222e-06,2.4600387102766619e-06,2.4715181771978908e-06,2.4815576041508947e-06,2.4903134426717157e-06,2.4977495021420415e-06,2.503498888732983e-06,2.5074657266276532e-06,2.5099366089066185e-06,2.5108756731390622e-06,2.5099896249436224e-06,2.5069641167255093e-06,2.5022581360141877e-06,2.4958478313393162e-06,2.4875592050032944e-06,2.4768450312159071e-06,2.4643574106077389e-06,2.4500951769790417e-06,2.4340334813486753e-06,2.41542361932782e-06,2.3950911650190821e-06,2.3730645792010972e-06,2.349373659993256e-06,2.323437319303511e-06,2.2959093055509158e-06,2.2669407377807671e-06,2.2365922135803416e-06,2.2045477728372776e-06,2.1712295437997124e-06,2.1368867565437783e-06,2.1016054055735429e-06,2.0653077981554624e-06,2.0282582070974628e-06,1.9907184883247634e-06,1.95278898239139e-06,1.9145592062028431e-06,1.8762519703640039e-06,1.8380369533209221e-06,1.8000141677067522e-06,1.7623429161739571e-06,1.7253319270701685e-06,1.6889596490303061e-06,1.6533105238566714e-06,1.6185149373669009e-06,1.5850683711846627e-06,1.5526914875551984e-06,1.5214407203272652e-06,1.4913711268036351e-06,1.4631221041543611e-06,1.4362282019704395e-06,1.410682516350858e-06,1.3865050369190312e-06,1.3642265918118453e-06,1.3434629502032386e-06,1.324070215079687e-06,1.3060335932785598e-06,1.2897137912893969e-06,1.2748667200778904e-06,1.2612308222187663e-06,1.2487627818656526e-06,1.2376447213339084e-06,1.2277629604032131e-06,1.2187947980008835e-06,1.2106783888103952e-06,1.2034513182481713e-06,1.1970684866157442e-06,1.1912224226412539e-06,1.1858437257429784e-06,1.1808842766903453e-06,1.176279245315519e-06,1.1718135010352877e-06,1.1674197980070631e-06,1.1630296550719402e-06,1.1584698533380911e-06,1.1536800684625473e-06,1.1486025364354211e-06,1.1431800407915986e-06,1.1371408451855042e-06,1.1305401712870185e-06,1.1233606222884348e-06,1.1155595923857417e-06,1.1068462646260751e-06,1.0972897114795936e-06,1.0869534988875133e-06,1.0758126380966668e-06,1.0636163430791715e-06,1.0503806031102134e-06,1.0362679476647627e-06,1.0212726359603012e-06,1.0052222415078348e-06,9.8805141846854439e-07,9.7001573507700296e-07,9.5112885749643908e-07,9.3131120315925433e-07,9.1042882594544246e-07,8.8879980550076884e-07,8.6645542019524655e-07,8.4339876518830709e-07,8.1947689725133595e-07,7.9501804055758878e-07,7.7006694399503257e-07,7.446688132265506e-07,7.1875297588965468e-07,6.9256513790874406e-07,6.6616591425534845e-07,6.3960728585145016e-07,6.1295198182151881e-07,5.8632673698173903e-07,5.5978989525012491e-07,5.3339269308454968e-07,5.0727769511745613e-07,4.8152100755541278e-07,4.5613027253877122e-07,4.3114888796483504e-07,4.0674129233302024e-07,3.830004404413825e-07,3.5984564241135721e-07,3.3730729125165827e-07,3.1552243869994373e-07,2.9465095875002098e-07,2.7450590616148356e-07,2.5510237876427904e-07,2.3651847489780119e-07,2.1900394258534648e-07,2.0227043468695427e-07,1.8631845291382977e-07,1.711562144983448e-07,1.5711821942867291e-07,1.4383914675871748e-07,1.313079282761756e-07,1.1951311219762504e-07,1.0871748309448239e-07,9.8644863783737868e-08,8.9233561137441656e-08,8.0465033674916236e-08,7.2510254399574135e-08,6.5203675508514964e-08,5.8442999315029287e-08,5.2206853117419964e-08,4.6591461279655559e-08,4.1520821593319313e-08,3.6873541889285577e-08,3.2628836131313759e-08,2.8829755630291204e-08,2.5461938895782493e-08,2.240391398995084e-08,1.9637675436281286e-08,1.7173433418249031e-08,1.5031959330766758e-08,1.3105035393301012e-08,1.137842410267482e-08,9.8454279635830714e-09,8.5414203123255802e-09,7.3783634565511224e-09],"type":"scatter","mode":"lines","fill":"tozeroy","line":{"color":"#0072B5","width":2},"name":"Density","showlegend":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x4","yaxis":"y3","frame":null},{"x":[-144207.04389281571,-141082.87503228171,-137958.7061717477,-134834.5373112137,-131710.3684506797,-128586.19959014571,-125462.03072961171,-122337.86186907772,-119213.69300854372,-116089.52414800972,-112965.35528747572,-109841.18642694171,-106717.01756640771,-103592.84870587372,-100468.67984533972,-97344.510984805733,-94220.34212427173,-91096.173263737728,-87972.004403203726,-84847.835542669724,-81723.666682135721,-78599.497821601733,-75475.328961067731,-72351.160100533729,-69226.991239999727,-66102.822379465724,-62978.653518931736,-59854.484658397734,-56730.315797863732,-53606.14693732973,-50481.978076795742,-47357.809216261739,-44233.640355727737,-41109.471495193735,-37985.302634659733,-34861.133774125745,-31736.964913591743,-28612.79605305774,-25488.627192523738,-22364.45833198975,-19240.289471455748,-16116.120610921746,-12991.951750387758,-9867.7828898537555,-6743.6140293197532,-3619.4451687857509,-495.27630825174856,2628.8925522822537,5753.0614128162561,8877.2302733502584,12001.399133884261,15125.567994418234,18249.736854952236,21373.905715486238,24498.074576020241,27622.243436554243,30746.412297088245,33870.581157622248,36994.75001815625,40118.918878690252,43243.087739224226,46367.256599758228,49491.42546029223,52615.594320826232,55739.763181360235,58863.932041894237,61988.100902428239,65112.269762962242,68236.438623496244,71360.607484030217,74484.776344564219,77608.945205098222,80733.114065632224,83857.282926166226,86981.451786700229,90105.620647234231,93229.789507768233,96353.958368302236,99478.127228836209,102602.29608937021,105726.46494990421,108850.63381043822,111974.80267097222,115098.97153150622,118223.14039204019,121347.30925257422,124471.4781131082,127595.64697364223,130719.8158341762,133843.98469471023,136968.15355524421,140092.32241577824,143216.49127631221,146340.66013684619,149464.82899738022,152588.99785791419,155713.16671844822,158837.33557898219,161961.50443951623,165085.6733000502],"y":[6.9078455003263489e-07,7.5605662768336474e-07,8.2586151859663133e-07,9.0032919336186783e-07,9.7957260477263323e-07,1.0636852226583026e-06,1.1527385499995482e-06,1.2467796493644652e-06,1.3458287110750494e-06,1.4498766965735633e-06,1.5588830921406605e-06,1.6727738093596111e-06,1.7914392694654854e-06,1.9147327089118358e-06,2.0424687430849385e-06,2.1744222240601406e-06,2.3103274265999859e-06,2.4498775942244907e-06,2.5927248741381866e-06,2.7384806660876248e-06,2.8867164058727895e-06,3.0369647992864638e-06,3.1887215167620215e-06,3.3414473530413789e-06,3.4945708498136895e-06,3.6474913726166492e-06,3.7995826264420956e-06,3.9501965875610631e-06,4.0986678222025787e-06,4.2443181560123908e-06,4.3864616518111054e-06,4.5244098471942908e-06,4.6574771980944683e-06,4.7849866696749224e-06,4.9062754119565863e-06,5.0207004544889822e-06,5.1276443522465541e-06,5.2265207138282601e-06,5.3167795430079677e-06,5.3979123257524238e-06,5.4694567969978746e-06,5.531001324739122e-06,5.5821888532973338e-06,5.622720352935252e-06,5.6523577291999453e-06,5.6709261523940696e-06,5.678315775289906e-06,5.6744828154745617e-06,5.6594499874057768e-06,5.6333062782131754e-06,5.5962060703410223e-06,5.548367623134741e-06,5.4900709342653144e-06,5.4216550103079407e-06,5.3435145836973993e-06,5.2560963205363418e-06,5.1598945702124951e-06,5.0554467133810084e-06,4.9433281695020709e-06,4.8241471287246892e-06,4.6985390754297451e-06,4.5671611721655113e-06,4.4306865730252688e-06,4.2897987347492344e-06,4.1451857920225529e-06,3.9975350606472034e-06,3.847527728565684e-06,3.6958337902007966e-06,3.5431072743540677e-06,3.3899818100909121e-06,3.2370665687564654e-06,3.0849426136394775e-06,2.934159681961642e-06,2.785233416944286e-06,2.6386430608169908e-06,2.4948296129014524e-06,2.354194450437486e-06,2.2170984037153872e-06,2.0838612714264975e-06,1.9547617570152279e-06,1.8300378022705664e-06,1.7098872904779294e-06,1.5944690881937275e-06,1.4839043921207917e-06,1.3782783456551526e-06,1.2776418884324171e-06,1.1820138016023491e-06,1.0913829115694001e-06,1.0057104155122859e-06,9.2493229308627398e-07,8.4896177026138904e-07,7.7769180319671101e-07,7.1099755233170135e-07,6.4873881942441605e-07,5.907624230187589e-07,5.3690449071464104e-07,4.869926495853874e-07,4.4084809907862342e-07,3.9828755369760005e-07,3.5912504564226277e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x4","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"","anchor":"y"},"xaxis2":{"domain":[0,0.3133333333333333],"automargin":true,"title":"Lag","anchor":"y5"},"xaxis3":{"domain":[0.35333333333333333,0.64666666666666661],"automargin":true,"title":"Theoretical Quantiles","anchor":"y4"},"xaxis4":{"domain":[0.68666666666666665,1],"automargin":true,"title":"Residuals","anchor":"y3"},"yaxis3":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Density","anchor":"x4"},"yaxis4":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Sample Quantiles","anchor":"x3"},"yaxis5":{"domain":[0,0.47999999999999998],"automargin":true,"title":"ACF","anchor":"x2"},"yaxis":{"domain":[0.52000000000000002,0.75039999999999996],"automargin":true,"title":"Residuals","anchor":"x"},"yaxis2":{"domain":[0.76960000000000006,1],"automargin":true,"title":"Value","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"showlegend":true,"legend":{"orientation":"h"},"hovermode":"closest","title":"Residual Plots"},"attrs":{"3fae55c39b4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#0072B5"},"showlegend":true,"inherit":true},"3fae55c39b4.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1992,1993,1994,1995,1996,1997,1998,1999,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6},"name":"Fitted","showlegend":true,"inherit":true},"3fae55c39b4.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1990,1991,2000],"y":[8353542.1359007414,8469688.3266999498,9515004.0438928157],"type":"scatter","mode":"markers","marker":{"color":"orange","size":6},"name":"Fitted (2-3 SD)","showlegend":true,"inherit":true},"3fae2aa5c2be":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[-100245.56350311916,-8215.7543023265898,76380.054898465984,144305.86409925856,165085.6733000502,94778.482500843704,24206.291701637208,-27393.899097571149,-68732.089896779507,-81111.280695986003,-106092.4714951925,-100783.66229440086,-67651.853093609214,-144207.04389281571,-28028.234692022204,-20654.425491230562,-60131.61629043892,-22176.807089645416,28698.002111148089,117342.81131193973,111192.62051273137,70988.429713524878,5714.4855684451759,-23713.458576634526,-2169.402721716091,-6505.3468667939305,5424.7089881263673,-28825.235156953335,97989.8206979651,-16301.123447112739,11121.932407807559,-29004.011737274006,-3760.9558823537081,9433.0999725665897,-5426.8441725112498,-18711.788317592815,-290.7324626725167,7471.3233922477812],"type":"scatter","mode":"markers","name":"Residuals","marker":{"color":"#0072B5"},"showlegend":false,"inherit":true},"3fae2aa5c2be.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":140510.80745405925,"xend":2024,"yend":140510.80745405925,"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"+2SD","showlegend":false,"inherit":true},"3fae2aa5c2be.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":-140510.80745405925,"xend":2024,"yend":-140510.80745405925,"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"-2SD","showlegend":false,"inherit":true},"3fae2aa5c2be.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":210766.21118108887,"xend":2024,"yend":210766.21118108887,"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"+3SD","showlegend":false,"inherit":true},"3fae2aa5c2be.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":-210766.21118108887,"xend":2024,"yend":-210766.21118108887,"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"-3SD","showlegend":false,"inherit":true},"3fae39ecb580":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"3fae39ecb580.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37],"y":[0.66727912590088878,0.39433072521635865,0.066837170795422285,-0.12528212699594296,-0.22443646927428507,-0.31131320215492581,-0.33085886857078795,-0.32067766961215488,-0.28831342785923375,-0.2688474305018001,-0.22376488769791514,-0.16312496879068664,-0.0047876879312503187,0.079133102557330734,0.1417251335917647,0.26494977099798028,0.17595447570725967,0.065051666856917864,-0.068536030188884822,-0.1048826362023567,-0.051084440507053269,0.018920317914700144,0.051764345873673394,0.071831684482943872,0.063579522784237313,0.025907666946471671,-0.009889915694685664,-0.070946864546330729,-0.0061924162915878078,-0.014695218790214067,-0.00032828113511730578,-0.011800545496111809,-0.0062356832030951688,0.0096027062910766254,0.013408991171477947,-0.00017652482566810632,-0.0041011108184156033],"marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"name":"ACF","showlegend":false,"inherit":true},"3fae39ecb580.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":1,"y":0.31794814293719936,"xend":37,"yend":0.31794814293719936,"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"inherit":true},"3fae39ecb580.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":1,"y":-0.31794814293719936,"xend":37,"yend":-0.31794814293719936,"mode":"lines","line":{"color":"black","dash":"dash"},"showlegend":false,"inherit":true},"3fae2f178161":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.0526114183774098,-1.51009695862548,-1.4345325334117485,-1.4268733532955482,-1.1545201705926558,-0.97831748521197526,-0.96294163159981117,-0.85590023116334901,-0.41283673850863273,-0.41029207189458422,-0.39894774216832152,-0.38991874851374508,-0.33753216576437245,-0.31565980569710106,-0.293990560092451,-0.26633948884979369,-0.23202661407297975,-0.11694124389702794,-0.092595679786710142,-0.077244509099924322,-0.05353262073571842,-0.030878802293204891,-0.0041382220761590925,0.077214117353924638,0.081338733610415118,0.10634517767881196,0.13426867503626927,0.15830714532679327,0.34454704431972522,0.40848106464025419,1.010433731038586,1.0871769407977916,1.349056121990216,1.394765605200913,1.5826913605785982,1.6702318268337535,2.0540180035110818,2.3497932478115704],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998},"name":"Sample","showlegend":false,"inherit":true},"3fae2f178161.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"y":[-2.2215195883378369,-1.7568266072519048,-1.5079045914405589,-1.3279018717558335,-1.1829168441908855,-1.0592769170824314,-0.95001375566932145,-0.85105852683856886,-0.75980957100991842,-0.67448975019608171,-0.59382139299351966,-0.51684672765260953,-0.44282165759651115,-0.37114932320228383,-0.30133652085957607,-0.23296385427137245,-0.1656644138685531,-0.099107859822899172,-0.032987932937402764,0.03298793293740291,0.099107859822899172,0.1656644138685531,0.23296385427137228,0.30133652085957624,0.37114932320228383,0.44282165759651115,0.51684672765260942,0.59382139299351977,0.67448975019608171,0.75980957100991842,0.85105852683856908,0.95001375566932145,1.0592769170824314,1.1829168441908855,1.3279018717558337,1.5079045914405589,1.7568266072519048,2.2215195883378365],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"inherit":true},"3fae23689642":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-192451.11456963804,-191657.0228699384,-190862.93117023879,-190068.83947053915,-189274.74777083952,-188480.65607113991,-187686.56437144027,-186892.47267174063,-186098.38097204099,-185304.28927234138,-184510.19757264174,-183716.10587294211,-182922.0141732425,-182127.92247354286,-181333.83077384322,-180539.73907414361,-179745.64737444397,-178951.55567474433,-178157.46397504472,-177363.37227534509,-176569.28057564545,-175775.18887594581,-174981.0971762462,-174187.00547654656,-173392.91377684695,-172598.82207714731,-171804.73037744767,-171010.63867774804,-170216.54697804843,-169422.45527834879,-168628.36357864915,-167834.27187894954,-167040.1801792499,-166246.08847955026,-165451.99677985066,-164657.90508015102,-163863.81338045138,-163069.72168075177,-162275.62998105213,-161481.53828135249,-160687.44658165285,-159893.35488195324,-159099.26318225361,-158305.171482554,-157511.07978285436,-156716.98808315472,-155922.89638345508,-155128.80468375547,-154334.71298405583,-153540.6212843562,-152746.52958465659,-151952.43788495695,-151158.34618525731,-150364.25448555767,-149570.16278585806,-148776.07108615842,-147981.97938645881,-147187.88768675918,-146393.79598705954,-145599.7042873599,-144805.61258766029,-144011.52088796065,-143217.42918826104,-142423.3374885614,-141629.24578886176,-140835.15408916213,-140041.06238946249,-139246.97068976288,-138452.87899006324,-137658.78729036363,-136864.69559066399,-136070.60389096435,-135276.51219126472,-134482.42049156511,-133688.32879186547,-132894.23709216586,-132100.14539246622,-131306.05369276658,-130511.96199306696,-129717.87029336733,-128923.7785936677,-128129.68689396806,-127335.59519426843,-126541.50349456881,-125747.41179486917,-124953.32009516955,-124159.22839546992,-123365.13669577028,-122571.04499607066,-121776.95329637104,-120982.8615966714,-120188.76989697177,-119394.67819727215,-118600.58649757251,-117806.49479787289,-117012.40309817325,-116218.31139847363,-115424.219698774,-114630.12799907436,-113836.03629937474,-113041.9445996751,-112247.85289997548,-111453.76120027585,-110659.66950057622,-109865.57780087659,-109071.48610117697,-108277.39440147733,-107483.30270177771,-106689.21100207808,-105895.11930237844,-105101.02760267882,-104306.93590297918,-103512.84420327956,-102718.75250357993,-101924.6608038803,-101130.56910418067,-100336.47740448103,-99542.385704781409,-98748.294005081785,-97954.202305382147,-97160.110605682523,-96366.018905982899,-95571.927206283261,-94777.835506583637,-93983.743806884013,-93189.652107184374,-92395.560407484751,-91601.468707785112,-90807.377008085488,-90013.285308385864,-89219.193608686226,-88425.101908986602,-87631.010209286964,-86836.91850958734,-86042.826809887716,-85248.735110188078,-84454.643410488454,-83660.55171078883,-82866.460011089192,-82072.368311389568,-81278.276611689944,-80484.184911990305,-79690.093212290682,-78896.001512591043,-78101.909812891419,-77307.818113191795,-76513.726413492157,-75719.634713792533,-74925.543014092895,-74131.451314393271,-73337.359614693647,-72543.267914994009,-71749.176215294385,-70955.084515594761,-70160.992815895122,-69366.901116195499,-68572.809416495875,-67778.717716796236,-66984.626017096612,-66190.534317396974,-65396.44261769735,-64602.350917997726,-63808.259218298088,-63014.167518598464,-62220.075818898826,-61425.984119199202,-60631.892419499578,-59837.80071979994,-59043.709020100301,-58249.617320400692,-57455.525620701053,-56661.433921001415,-55867.342221301806,-55073.250521602167,-54279.158821902529,-53485.06712220292,-52690.975422503281,-51896.883722803643,-51102.792023104033,-50308.700323404395,-49514.608623704757,-48720.516924005147,-47926.425224305509,-47132.33352460587,-46338.241824906261,-45544.150125206623,-44750.058425506984,-43955.966725807346,-43161.875026107737,-42367.783326408098,-41573.69162670846,-40779.59992700885,-39985.508227309212,-39191.416527609574,-38397.324827909964,-37603.233128210326,-36809.141428510688,-36015.049728811078,-35220.95802911144,-34426.866329411801,-33632.774629712163,-32838.682930012554,-32044.591230312915,-31250.499530613277,-30456.407830913668,-29662.316131214029,-28868.224431514391,-28074.132731814781,-27280.041032115143,-26485.949332415505,-25691.857632715895,-24897.765933016257,-24103.674233316618,-23309.582533617009,-22515.490833917371,-21721.399134217732,-20927.307434518123,-20133.215734818485,-19339.124035118846,-18545.032335419208,-17750.940635719599,-16956.84893601996,-16162.757236320322,-15368.665536620712,-14574.573836921074,-13780.482137221436,-12986.390437521826,-12192.298737822188,-11398.207038122549,-10604.11533842294,-9810.0236387233017,-9015.9319390236633,-8221.8402393240249,-7427.7485396244156,-6633.6568399247772,-5839.5651402251387,-5045.4734405255294,-4251.381740825891,-3457.2900411262526,-2663.1983414266433,-1869.1066417270049,-1075.0149420273665,-280.92324232775718,513.16845737188123,1307.2601570715196,2101.351856771129,2895.4435564707674,3689.5352561704058,4483.6269558700151,5277.7186555696535,6071.8103552692919,6865.9020549689303,7659.9937546685396,8454.085454368178,9248.1771540678164,10042.268853767426,10836.360553467064,11630.452253166703,12424.543952866312,13218.63565256595,14012.727352265589,14806.819051965198,15600.910751664836,16395.002451364475,17189.094151064113,17983.185850763723,18777.277550463361,19571.369250162999,20365.460949862609,21159.552649562247,21953.644349261886,22747.736048961495,23541.827748661133,24335.919448360772,25130.011148060381,25924.102847760019,26718.194547459658,27512.286247159267,28306.377946858905,29100.469646558544,29894.561346258153,30688.653045957792,31482.74474565743,32276.836445357068,33070.928145056678,33865.019844756316,34659.111544455955,35453.203244155564,36247.294943855202,37041.386643554841,37835.47834325445,38629.570042954088,39423.661742653727,40217.753442353336,41011.845142052975,41805.936841752613,42600.028541452251,43394.120241151861,44188.211940851499,44982.303640551138,45776.395340250747,46570.487039950385,47364.578739650024,48158.670439349633,48952.762139049271,49746.85383874891,50540.945538448519,51335.037238148157,52129.128937847796,52923.220637547405,53717.312337247044,54511.404036946682,55305.495736646291,56099.58743634593,56893.679136045568,57687.770835745207,58481.862535444816,59275.954235144454,60070.045934844093,60864.137634543702,61658.22933424334,62452.321033942979,63246.412733642588,64040.504433342227,64834.596133041865,65628.687832741474,66422.779532441113,67216.871232140751,68010.96293184039,68805.054631539999,69599.146331239637,70393.238030939247,71187.329730638885,71981.421430338523,72775.513130038162,73569.6048297378,74363.696529437439,75157.788229137019,75951.879928836657,76745.971628536296,77540.063328235934,78334.155027935572,79128.246727635211,79922.338427334791,80716.430127034429,81510.521826734068,82304.613526433706,83098.705226133345,83892.796925832983,84686.888625532563,85480.980325232202,86275.07202493184,87069.163724631479,87863.255424331117,88657.347124030755,89451.438823730394,90245.530523429974,91039.622223129612,91833.713922829251,92627.805622528889,93421.897322228528,94215.989021928166,95010.080721627746,95804.172421327385,96598.264121027023,97392.355820726661,98186.4475204263,98980.539220125938,99774.630919825519,100568.72261952516,101362.8143192248,102156.90601892443,102950.99771862407,103745.08941832371,104539.18111802335,105333.27281772293,106127.36451742257,106921.45621712221,107715.54791682184,108509.63961652148,109303.73131622112,110097.8230159207,110891.91471562034,111686.00641531998,112480.09811501962,113274.18981471926,114068.28151441889,114862.37321411853,115656.46491381811,116450.55661351775,117244.64831321739,118038.74001291703,118832.83171261667,119626.9234123163,120421.01511201588,121215.10681171552,122009.19851141516,122803.2902111148,123597.38191081444,124391.47361051408,125185.56531021371,125979.6570099133,126773.74870961293,127567.84040931257,128361.93210901221,129156.02380871185,129950.11550841149,130744.20720811107,131538.29890781071,132332.39060751034,133126.48230720998,133920.57400690962,134714.66570660926,135508.75740630884,136302.84910600848,137096.94080570812,137891.03250540775,138685.12420510739,139479.21590480703,140273.30760450667,141067.39930420625,141861.49100390589,142655.58270360553,143449.67440330517,144243.7661030048,145037.85780270444,145831.94950240402,146626.04120210366,147420.1329018033,148214.22460150294,149008.31630120258,149802.40800090221,150596.49970060179,151390.59140030143,152184.68310000107,152978.77479970071,153772.86649940035,154566.95819909999,155361.04989879963,156155.14159849921,156949.23329819884,157743.32499789848,158537.41669759812,159331.50839729776,160125.6000969974,160919.69179669698,161713.78349639662,162507.87519609625,163301.96689579589,164096.05859549553,164890.15029519517,165684.24199489481,166478.33369459439,167272.42539429403,168066.51709399367,168860.6087936933,169654.70049339294,170448.79219309258,171242.88389279216,172036.9755924918,172831.06729219144,173625.15899189108,174419.25069159071,175213.34239129035,176007.43409098999,176801.52579068957,177595.61749038921,178389.70919008885,179183.80088978849,179977.89258948812,180771.98428918776,181566.07598888734,182360.16768858698,183154.25938828662,183948.35108798626,184742.4427876859,185536.53448738554,186330.62618708512,187124.71788678475,187918.80958648439,188712.90128618403,189506.99298588367,190301.08468558331,191095.17638528295,191889.26808498253,192683.35978468216,193477.4514843818,194271.54318408144,195065.63488378108,195859.72658348072,196653.8182831803,197447.90998287994,198242.00168257958,199036.09338227921,199830.18508197885,200624.27678167849,201418.36848137807,202212.46018107771,203006.55188077735,203800.64358047699,204594.73528017662,205388.82697987626,206182.9186795759,206977.01037927548,207771.10207897512,208565.19377867476,209359.2854783744,210153.37717807404,210947.46887777367,211741.56057747325,212535.65227717289,213329.74397687253],"y":[7.3123970620532296e-09,8.4601862586359111e-09,9.7460776752355988e-09,1.1255879500261043e-08,1.2954557092405875e-08,1.4848330020281295e-08,1.6950772931364713e-08,1.936634059908155e-08,2.2073927498975135e-08,2.5062963716576082e-08,2.8350215695922853e-08,3.2051272255553785e-08,3.6177960927429055e-08,4.068769606656635e-08,4.5599077982789027e-08,5.1025117658264498e-08,5.7033804198685623e-08,6.353189404069476e-08,7.0537132676649895e-08,7.8141274887286996e-08,8.6490156940873834e-08,9.5421748426106401e-08,1.0494895520528328e-07,1.1512260915739398e-07,1.2617692348609769e-07,1.3787022817878902e-07,1.5020583735826953e-07,1.6318656878962136e-07,1.7710173748636517e-07,1.9165589721662243e-07,2.0683144409377627e-07,2.2261698581109558e-07,2.3920822715397954e-07,2.5638791055332848e-07,2.7408078955926375e-07,2.9225889527160954e-07,3.1100712311067907e-07,3.301780036131498e-07,3.496616662123495e-07,3.6941475845427369e-07,3.8941961266288753e-07,4.095606830503386e-07,4.2973900852431872e-07,4.4990161490524402e-07,4.699635556400545e-07,4.8978210269842232e-07,5.0932948853742585e-07,5.2855332726618731e-07,5.4735576479822626e-07,5.655081271626052e-07,5.8311163452810433e-07,6.001275741405513e-07,6.1650146114767464e-07,6.3189158172483679e-07,6.4655954433263384e-07,6.6049335952059388e-07,6.736824417123988e-07,6.8581456177990723e-07,6.9718668917036942e-07,7.0785826415023775e-07,7.1785508095293794e-07,7.2702254754771504e-07,7.3560011561549288e-07,7.4372363067907206e-07,7.5145701861134716e-07,7.5883065748644231e-07,7.6604966877918521e-07,7.7326201504770006e-07,7.8056233532447105e-07,7.8813159628101226e-07,7.9622894171786291e-07,8.0490568345629123e-07,8.142708436508007e-07,8.2456851221174789e-07,8.3623654016555685e-07,8.4910303877766609e-07,8.6326885041896763e-07,8.7892769832657817e-07,8.9680594810937484e-07,9.1640456656477983e-07,9.3779213642577562e-07,9.6103544992096637e-07,9.8711224060901476e-07,1.0152314977255727e-06,1.0453854914267386e-06,1.0775881295030837e-06,1.1126127929062193e-06,1.1498085161870049e-06,1.1889579959681067e-06,1.2300130059427268e-06,1.2734332669201636e-06,1.3187663872244725e-06,1.365626887132276e-06,1.4139086920602841e-06,1.4637429467746425e-06,1.5148205827248078e-06,1.5667108041835226e-06,1.6192677775109127e-06,1.6723734968891225e-06,1.7257140115789584e-06,1.7789896191078495e-06,1.8320431880335857e-06,1.8846521111361982e-06,1.9363140225666162e-06,1.9870395662652712e-06,2.0366924995356462e-06,2.0851055017834471e-06,2.1314448703456186e-06,2.1761544047334969e-06,2.2191463659897699e-06,2.2603355618099011e-06,2.2988041570076221e-06,2.3351643919316848e-06,2.3694867273440679e-06,2.4017501457203493e-06,2.4312366063501199e-06,2.4584395607064144e-06,2.4836470657834625e-06,2.5068998689586406e-06,2.5277655169610944e-06,2.5465428249473831e-06,2.5636760583580648e-06,2.5792491404382546e-06,2.5930955881157207e-06,2.605348729325607e-06,2.6164873304642535e-06,2.6266092712078575e-06,2.6357203773790406e-06,2.6438710399826335e-06,2.6514452187208336e-06,2.6585238199894448e-06,2.6651705224177337e-06,2.6714192200902279e-06,2.6774799291540725e-06,2.6833935871699048e-06,2.6891991647121272e-06,2.694912233808933e-06,2.7005769896590398e-06,2.7061876963096184e-06,2.7117359095261887e-06,2.7171508947352229e-06,2.7223960042695851e-06,2.7274361125246679e-06,2.732227315456765e-06,2.7365927016015144e-06,2.7404671198888299e-06,2.7438484753235976e-06,2.7466849730485213e-06,2.7487595157396758e-06,2.7499778977902251e-06,2.7504537480309685e-06,2.7501631113743391e-06,2.7489535948946721e-06,2.7467182509025985e-06,2.7437271466864703e-06,2.7400178889882894e-06,2.7355815357646189e-06,2.7304124855783274e-06,2.7248745914593098e-06,2.7190884448061335e-06,2.7131818552387384e-06,2.7075178245937186e-06,2.7023514395466034e-06,2.6978876077684915e-06,2.6943344298325644e-06,2.6926423231279411e-06,2.6928225323864345e-06,2.6950755246611575e-06,2.6996697286582874e-06,2.7080162177276826e-06,2.7200971020319491e-06,2.7358572472569148e-06,2.7555815413955722e-06,2.7808815411979022e-06,2.8120277717847345e-06,2.8484200967109285e-06,2.8903039578118798e-06,2.9391567101969441e-06,2.9958533863415712e-06,3.059009100925396e-06,3.1287741052099257e-06,3.2061799645992619e-06,3.2928829836778754e-06,3.3866203394729863e-06,3.4874047973645738e-06,3.5956309739548644e-06,3.713658720771101e-06,3.8384727139812438e-06,3.9699303881479754e-06,4.1078825845557989e-06,4.2547201336201266e-06,4.40733025434913e-06,4.5653303383617592e-06,4.7284296011399074e-06,4.8977924428797143e-06,5.0713782940010466e-06,5.2484009614403894e-06,5.4284695988158586e-06,5.6116817611606358e-06,5.7967724270678568e-06,5.9829255043481129e-06,6.1697091123531149e-06,6.3565027525392719e-06,6.5423199970955263e-06,6.726743433186829e-06,6.9093619154675489e-06,7.0892701178353998e-06,7.2652081184755602e-06,7.437533645484072e-06,7.6059057875498136e-06,7.7695418558314406e-06,7.9264381776773239e-06,8.0779678761415167e-06,8.2238869543321005e-06,8.3638362038105584e-06,8.4947644008543835e-06,8.6191299418784412e-06,8.7367868527214079e-06,8.847592952855436e-06,8.9484346304959287e-06,9.0416685855407484e-06,9.127597809322194e-06,9.2061578112930603e-06,9.2747328969257174e-06,9.33486645889645e-06,9.3874666636642257e-06,9.4325192240390628e-06,9.4679825809981882e-06,9.4944154520388642e-06,9.5133080965983845e-06,9.5246735484767997e-06,9.5270541015751202e-06,9.5199766577564028e-06,9.5054749014196415e-06,9.4835791445060682e-06,9.4534053645852866e-06,9.4134832366980741e-06,9.3663527074200888e-06,9.3120655841302439e-06,9.2502972166282378e-06,9.1786878528331224e-06,9.10023213851117e-06,9.0150166761225843e-06,8.9231298418927908e-06,8.8218624793156808e-06,8.7142218478387529e-06,8.6004560917871885e-06,8.4807024025628254e-06,8.3530681237353019e-06,8.2195360910374714e-06,8.0808048242707714e-06,7.9370647901551004e-06,7.7872072631698787e-06,7.632373559568201e-06,7.4735515745525321e-06,7.3109767178770079e-06,7.1442051956945133e-06,6.9738149735073609e-06,6.8008578615132663e-06,6.6255945257573424e-06,6.4480506626829043e-06,6.2685878687957028e-06,6.0880654300138036e-06,5.9067440075192801e-06,5.7248821482420457e-06,5.5429888473291638e-06,5.3614901329609407e-06,5.1806231721548857e-06,5.0006464288256838e-06,4.8225401598872108e-06,4.6461138826779589e-06,4.4715654193903201e-06,4.2990907033510764e-06,4.1299961049438349e-06,3.9637597904477527e-06,3.8004047595461068e-06,3.640081783087134e-06,3.4841231545677663e-06,3.3320997471363095e-06,3.1837121178576458e-06,3.0390689692071998e-06,2.8993619147854349e-06,2.7645187450659395e-06,2.6338462283544342e-06,2.5074182579445772e-06,2.386177171187805e-06,2.2705822504567304e-06,2.15951441478828e-06,2.0530196406600053e-06,1.9517242579587999e-06,1.8567168624477146e-06,1.7664458198344386e-06,1.6809325838463596e-06,1.6004491841711033e-06,1.526744542727431e-06,1.45784780780283e-06,1.3937550035183431e-06,1.3344610072669755e-06,1.2820654263865377e-06,1.2344911780654849e-06,1.1916136884482329e-06,1.1533984190618418e-06,1.121486600868885e-06,1.0944712981479414e-06,1.0718701887085559e-06,1.0536157179469002e-06,1.0408675628603038e-06,1.0328484372630157e-06,1.0287725551854679e-06,1.0285390837747287e-06,1.0328459920803907e-06,1.0414386108964486e-06,1.0533258660655241e-06,1.0683788436324448e-06,1.0869019245791947e-06,1.1089961532065725e-06,1.133600881743661e-06,1.1605701725728854e-06,1.1899246862048335e-06,1.221917217850759e-06,1.2555719589902828e-06,1.2907412857171628e-06,1.3272950015274539e-06,1.3654332087564744e-06,1.4044096657245923e-06,1.4440914457005516e-06,1.4843466273889459e-06,1.5250993880595675e-06,1.5659968172439805e-06,1.6069144230692464e-06,1.647748929082827e-06,1.6882653192730653e-06,1.7283371008963967e-06,1.7679249131805664e-06,1.8069606012607677e-06,1.8451822226870592e-06,1.8825207077196756e-06,1.9190682774811037e-06,1.9547901809135401e-06,1.9894775990518756e-06,2.0230131924630025e-06,2.0556207788984784e-06,2.087289978025044e-06,2.1178947239713411e-06,2.1472174548942613e-06,2.1755839377410124e-06,2.2029949106620434e-06,2.2294032022638696e-06,2.2544664106312158e-06,2.2785789199615035e-06,2.3017393820937905e-06,2.3239461393915068e-06,2.3447644012046456e-06,2.3645849880283573e-06,2.3834153377521394e-06,2.4012422406124365e-06,2.4176532449523305e-06,2.4328930726521568e-06,2.447030551135222e-06,2.4600387102766619e-06,2.4715181771978908e-06,2.4815576041508947e-06,2.4903134426717157e-06,2.4977495021420415e-06,2.503498888732983e-06,2.5074657266276532e-06,2.5099366089066185e-06,2.5108756731390622e-06,2.5099896249436224e-06,2.5069641167255093e-06,2.5022581360141877e-06,2.4958478313393162e-06,2.4875592050032944e-06,2.4768450312159071e-06,2.4643574106077389e-06,2.4500951769790417e-06,2.4340334813486753e-06,2.41542361932782e-06,2.3950911650190821e-06,2.3730645792010972e-06,2.349373659993256e-06,2.323437319303511e-06,2.2959093055509158e-06,2.2669407377807671e-06,2.2365922135803416e-06,2.2045477728372776e-06,2.1712295437997124e-06,2.1368867565437783e-06,2.1016054055735429e-06,2.0653077981554624e-06,2.0282582070974628e-06,1.9907184883247634e-06,1.95278898239139e-06,1.9145592062028431e-06,1.8762519703640039e-06,1.8380369533209221e-06,1.8000141677067522e-06,1.7623429161739571e-06,1.7253319270701685e-06,1.6889596490303061e-06,1.6533105238566714e-06,1.6185149373669009e-06,1.5850683711846627e-06,1.5526914875551984e-06,1.5214407203272652e-06,1.4913711268036351e-06,1.4631221041543611e-06,1.4362282019704395e-06,1.410682516350858e-06,1.3865050369190312e-06,1.3642265918118453e-06,1.3434629502032386e-06,1.324070215079687e-06,1.3060335932785598e-06,1.2897137912893969e-06,1.2748667200778904e-06,1.2612308222187663e-06,1.2487627818656526e-06,1.2376447213339084e-06,1.2277629604032131e-06,1.2187947980008835e-06,1.2106783888103952e-06,1.2034513182481713e-06,1.1970684866157442e-06,1.1912224226412539e-06,1.1858437257429784e-06,1.1808842766903453e-06,1.176279245315519e-06,1.1718135010352877e-06,1.1674197980070631e-06,1.1630296550719402e-06,1.1584698533380911e-06,1.1536800684625473e-06,1.1486025364354211e-06,1.1431800407915986e-06,1.1371408451855042e-06,1.1305401712870185e-06,1.1233606222884348e-06,1.1155595923857417e-06,1.1068462646260751e-06,1.0972897114795936e-06,1.0869534988875133e-06,1.0758126380966668e-06,1.0636163430791715e-06,1.0503806031102134e-06,1.0362679476647627e-06,1.0212726359603012e-06,1.0052222415078348e-06,9.8805141846854439e-07,9.7001573507700296e-07,9.5112885749643908e-07,9.3131120315925433e-07,9.1042882594544246e-07,8.8879980550076884e-07,8.6645542019524655e-07,8.4339876518830709e-07,8.1947689725133595e-07,7.9501804055758878e-07,7.7006694399503257e-07,7.446688132265506e-07,7.1875297588965468e-07,6.9256513790874406e-07,6.6616591425534845e-07,6.3960728585145016e-07,6.1295198182151881e-07,5.8632673698173903e-07,5.5978989525012491e-07,5.3339269308454968e-07,5.0727769511745613e-07,4.8152100755541278e-07,4.5613027253877122e-07,4.3114888796483504e-07,4.0674129233302024e-07,3.830004404413825e-07,3.5984564241135721e-07,3.3730729125165827e-07,3.1552243869994373e-07,2.9465095875002098e-07,2.7450590616148356e-07,2.5510237876427904e-07,2.3651847489780119e-07,2.1900394258534648e-07,2.0227043468695427e-07,1.8631845291382977e-07,1.711562144983448e-07,1.5711821942867291e-07,1.4383914675871748e-07,1.313079282761756e-07,1.1951311219762504e-07,1.0871748309448239e-07,9.8644863783737868e-08,8.9233561137441656e-08,8.0465033674916236e-08,7.2510254399574135e-08,6.5203675508514964e-08,5.8442999315029287e-08,5.2206853117419964e-08,4.6591461279655559e-08,4.1520821593319313e-08,3.6873541889285577e-08,3.2628836131313759e-08,2.8829755630291204e-08,2.5461938895782493e-08,2.240391398995084e-08,1.9637675436281286e-08,1.7173433418249031e-08,1.5031959330766758e-08,1.3105035393301012e-08,1.137842410267482e-08,9.8454279635830714e-09,8.5414203123255802e-09,7.3783634565511224e-09],"type":"scatter","mode":"lines","fill":"tozeroy","fillcolor":"rgba(0, 114, 181, 0.3)","line":{"color":"#0072B5","width":2},"name":"Density","showlegend":false,"inherit":true},"3fae23689642.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-144207.04389281571,-141082.87503228171,-137958.7061717477,-134834.5373112137,-131710.3684506797,-128586.19959014571,-125462.03072961171,-122337.86186907772,-119213.69300854372,-116089.52414800972,-112965.35528747572,-109841.18642694171,-106717.01756640771,-103592.84870587372,-100468.67984533972,-97344.510984805733,-94220.34212427173,-91096.173263737728,-87972.004403203726,-84847.835542669724,-81723.666682135721,-78599.497821601733,-75475.328961067731,-72351.160100533729,-69226.991239999727,-66102.822379465724,-62978.653518931736,-59854.484658397734,-56730.315797863732,-53606.14693732973,-50481.978076795742,-47357.809216261739,-44233.640355727737,-41109.471495193735,-37985.302634659733,-34861.133774125745,-31736.964913591743,-28612.79605305774,-25488.627192523738,-22364.45833198975,-19240.289471455748,-16116.120610921746,-12991.951750387758,-9867.7828898537555,-6743.6140293197532,-3619.4451687857509,-495.27630825174856,2628.8925522822537,5753.0614128162561,8877.2302733502584,12001.399133884261,15125.567994418234,18249.736854952236,21373.905715486238,24498.074576020241,27622.243436554243,30746.412297088245,33870.581157622248,36994.75001815625,40118.918878690252,43243.087739224226,46367.256599758228,49491.42546029223,52615.594320826232,55739.763181360235,58863.932041894237,61988.100902428239,65112.269762962242,68236.438623496244,71360.607484030217,74484.776344564219,77608.945205098222,80733.114065632224,83857.282926166226,86981.451786700229,90105.620647234231,93229.789507768233,96353.958368302236,99478.127228836209,102602.29608937021,105726.46494990421,108850.63381043822,111974.80267097222,115098.97153150622,118223.14039204019,121347.30925257422,124471.4781131082,127595.64697364223,130719.8158341762,133843.98469471023,136968.15355524421,140092.32241577824,143216.49127631221,146340.66013684619,149464.82899738022,152588.99785791419,155713.16671844822,158837.33557898219,161961.50443951623,165085.6733000502],"y":[6.9078455003263489e-07,7.5605662768336474e-07,8.2586151859663133e-07,9.0032919336186783e-07,9.7957260477263323e-07,1.0636852226583026e-06,1.1527385499995482e-06,1.2467796493644652e-06,1.3458287110750494e-06,1.4498766965735633e-06,1.5588830921406605e-06,1.6727738093596111e-06,1.7914392694654854e-06,1.9147327089118358e-06,2.0424687430849385e-06,2.1744222240601406e-06,2.3103274265999859e-06,2.4498775942244907e-06,2.5927248741381866e-06,2.7384806660876248e-06,2.8867164058727895e-06,3.0369647992864638e-06,3.1887215167620215e-06,3.3414473530413789e-06,3.4945708498136895e-06,3.6474913726166492e-06,3.7995826264420956e-06,3.9501965875610631e-06,4.0986678222025787e-06,4.2443181560123908e-06,4.3864616518111054e-06,4.5244098471942908e-06,4.6574771980944683e-06,4.7849866696749224e-06,4.9062754119565863e-06,5.0207004544889822e-06,5.1276443522465541e-06,5.2265207138282601e-06,5.3167795430079677e-06,5.3979123257524238e-06,5.4694567969978746e-06,5.531001324739122e-06,5.5821888532973338e-06,5.622720352935252e-06,5.6523577291999453e-06,5.6709261523940696e-06,5.678315775289906e-06,5.6744828154745617e-06,5.6594499874057768e-06,5.6333062782131754e-06,5.5962060703410223e-06,5.548367623134741e-06,5.4900709342653144e-06,5.4216550103079407e-06,5.3435145836973993e-06,5.2560963205363418e-06,5.1598945702124951e-06,5.0554467133810084e-06,4.9433281695020709e-06,4.8241471287246892e-06,4.6985390754297451e-06,4.5671611721655113e-06,4.4306865730252688e-06,4.2897987347492344e-06,4.1451857920225529e-06,3.9975350606472034e-06,3.847527728565684e-06,3.6958337902007966e-06,3.5431072743540677e-06,3.3899818100909121e-06,3.2370665687564654e-06,3.0849426136394775e-06,2.934159681961642e-06,2.785233416944286e-06,2.6386430608169908e-06,2.4948296129014524e-06,2.354194450437486e-06,2.2170984037153872e-06,2.0838612714264975e-06,1.9547617570152279e-06,1.8300378022705664e-06,1.7098872904779294e-06,1.5944690881937275e-06,1.4839043921207917e-06,1.3782783456551526e-06,1.2776418884324171e-06,1.1820138016023491e-06,1.0913829115694001e-06,1.0057104155122859e-06,9.2493229308627398e-07,8.4896177026138904e-07,7.7769180319671101e-07,7.1099755233170135e-07,6.4873881942441605e-07,5.907624230187589e-07,5.3690449071464104e-07,4.869926495853874e-07,4.4084809907862342e-07,3.9828755369760005e-07,3.5912504564226277e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s update the future data frame with the new feature and create a forecast:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>trend_start2 <span class="ot">&lt;-</span> <span class="fu">max</span>(ts1<span class="sc">$</span>trend2) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>trend2 <span class="ot">&lt;-</span> trend_start2<span class="sc">:</span>(trend_start2 <span class="sc">+</span> h <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>future_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 5 x 6 [1Y]
  index trend      yhat     lower     upper trend2
  &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;
1  2025    39 11789931. 11432704. 12147157.     17
2  2026    40 11883944. 11525312. 12242577.     18
3  2027    41 11977958. 11617854. 12338061.     19
4  2028    42 12071971. 11710334. 12433609.     20
5  2029    43 12165985. 11802750. 12529220.     21</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fc2 <span class="ot">&lt;-</span> <span class="fu">lm_forecast</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> md2,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual =</span> ts1,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">future_data =</span> future_data,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_col =</span> <span class="st">"y"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag_col =</span> <span class="cn">NULL</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Let’s plot the forecast</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lm_forecast</span>(fc2, <span class="at">actual_col =</span> <span class="st">"y"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-81373b8d3e4516f34aed" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-81373b8d3e4516f34aed">{"x":{"visdat":{"3fae5453f509":["function () ","plotlyVisDat"]},"cur_data":"3fae5453f509","attrs":{"3fae5453f509":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#1f77b4"},"showlegend":true,"inherit":true},"3fae5453f509.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1992,1993,1994,1995,1996,1997,1998,1999,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6},"name":"Fitted","showlegend":true,"inherit":true},"3fae5453f509.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1990,1991,2000],"y":[8353542.1359007414,8469688.3266999498,9515004.0438928157],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6},"showlegend":false,"inherit":true},"3fae5453f509.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2025,2026,2027,2028,2029],"ymin":[11319958.450164588,11378738.381003117,11437351.548088063,11495805.174432991,11554106.502527181],"ymax":[11644494.791341076,11707838.748792706,11771349.469997924,11835019.731943151,11898842.29213912],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"95% PI","line":{"color":"rgba(7, 164, 181, 0.05)"},"fillcolor":"rgba(7, 164, 181, 0.2)","showlegend":true,"inherit":true},"3fae5453f509.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2025,2026,2027,2028,2029],"y":[11482226.620752832,11543288.564897912,11604350.509042993,11665412.453188071,11726474.397333151],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"black","dash":"dash"},"showlegend":true,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Value"},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"legend":{"orientation":"h","xanchor":"center","x":0.5,"y":-0.20000000000000001},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#1f77b4"},"showlegend":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,1988,1989,1992,1993,1994,1995,1996,1997,1998,1999,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8005103.5635031192,8121249.7543023266,8237395.945101534,8585834.5174991563,8701980.7082983628,8818126.8990975711,8934273.0898967795,9050419.280695986,9166565.4714951925,9282711.6622944009,9398857.8530936092,9631150.2346920222,9747296.4254912306,9863442.6162904389,9979588.8070896454,10095734.997888852,10211881.18868806,10328027.379487269,10444173.570286475,10505235.514431555,10566297.458576635,10627359.402721716,10688421.346866794,10749483.291011874,10810545.235156953,10871607.179302035,10932669.123447113,10993731.067592192,11054793.011737274,11115854.955882354,11176916.900027433,11237978.844172511,11299040.788317593,11360102.732462673,11421164.676607752],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6,"line":{"color":"rgba(255,127,14,1)"}},"name":"Fitted","showlegend":true,"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1990,1991,2000],"y":[8353542.1359007414,8469688.3266999498,9515004.0438928157],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6,"line":{"color":"rgba(44,160,44,1)"}},"showlegend":false,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(7, 164, 181, 0.2)","x":[2025,2026,2027,2028,2029,2029,2029,2028,2027,2026,2025],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"95% PI","line":{"color":"rgba(7, 164, 181, 0.05)"},"showlegend":true,"y":[11319958.450164588,11378738.381003117,11437351.548088063,11495805.174432991,11554106.502527181,11554106.502527181,11898842.29213912,11835019.731943151,11771349.469997924,11707838.748792706,11644494.791341076],"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2025,2026,2027,2028,2029],"y":[11482226.620752832,11543288.564897912,11604350.509042993,11665412.453188071,11726474.397333151],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"black","dash":"dash"},"showlegend":true,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Looks much better! 😎</p>
</section>
<section id="using-grid-search-to-identify-the-optimal-knots" class="level3">
<h3 class="anchored" data-anchor-id="using-grid-search-to-identify-the-optimal-knots">Using Grid Search to Identify the Optimal Knots</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">piecewise_regression</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ts1,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_col =</span> <span class="st">"index"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_col =</span> <span class="st">"y"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_knots =</span> <span class="dv">3</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_segment_length =</span> <span class="dv">8</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge_buffer =</span> <span class="fl">0.05</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid_resolution =</span> <span class="dv">20</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing 0 knot(s)...
  Best BIC: 919.28 | RSS: 1.006639e+12 | Tested 1 configurations
Testing 1 knot(s)...
  Best BIC: 858.05 | RSS: 182625404855 | Tested 18 configurations
Testing 2 knot(s)...
  Best BIC: 844.26 | RSS: 115452860424 | Tested 25 configurations
Testing 3 knot(s)...
  Best BIC: 852.94 | RSS: 131838198802 | Tested 5 configurations

Optimal model:  2 knot(s) with BIC = 844.26 </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_bic_scores</span>(result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-83252c523e9b0e15c8f2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-83252c523e9b0e15c8f2">{"x":{"visdat":{"3fae7b36cc05":["function () ","plotlyVisDat"],"3fae362a24dc":["function () ","data"],"3fae40b373db":["function () ","data"]},"cur_data":"3fae40b373db","attrs":{"3fae362a24dc":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","line":{"color":"steelblue","width":2},"marker":{"size":8,"color":"steelblue"},"name":"BIC Score","showlegend":false,"inherit":true},"3fae40b373db":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","marker":{"size":12,"color":"red"},"name":"Optimal","showlegend":true,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":{"text":"BIC Scores by Number of Knots<br><sub>Lower BIC = Better Model<\/sub>","font":{"size":16}},"xaxis":{"domain":[0,1],"automargin":true,"title":"Number of Knots","dtick":1},"yaxis":{"domain":[0,1],"automargin":true,"title":"BIC"},"annotations":[{"x":2,"y":844.26294022132231,"text":"Optimal","xanchor":"left","xshift":10,"showarrow":true,"arrowhead":2,"arrowsize":1,"arrowwidth":2,"arrowcolor":"red","ax":40,"ay":0,"font":{"size":12,"color":"red","family":"Arial Black"}}],"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0,1,2,3],"y":[919.27713125638843,858.05119551709322,844.26294022132231,852.94362388768263],"type":"scatter","mode":"lines+markers","line":{"color":"steelblue","width":2},"marker":{"color":"steelblue","size":8,"line":{"color":"rgba(31,119,180,1)"}},"name":"BIC Score","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2],"y":[844.26294022132231],"type":"scatter","mode":"markers","marker":{"color":"red","size":12,"line":{"color":"rgba(255,127,14,1)"}},"name":"Optimal","showlegend":true,"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_knots</span>(result, <span class="at">time_col =</span> <span class="st">"index"</span>, <span class="at">value_col =</span> <span class="st">"y"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-71b510d2c7b687040d63" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-71b510d2c7b687040d63">{"x":{"visdat":{"3fae48f30e96":["function () ","plotlyVisDat"]},"cur_data":"3fae48f30e96","attrs":{"3fae48f30e96":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.5},"name":"Actual","showlegend":true,"inherit":true},"3fae48f30e96.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8083717.1616370743,8185172.949722074,8286628.7378070652,8388084.5258920575,8489540.3139770497,8590996.1020620428,8692451.8901470341,8793907.6782320254,8895363.4663170185,8996819.2544020098,9098275.0424870029,9199730.8305719942,9301186.6186569873,9439580.6793988068,9577974.7401406262,9716368.8008824475,9854762.861624267,9993156.9223660864,10131550.983107906,10269945.043849727,10408339.104591547,10467279.833441682,10526220.56229182,10585161.291141955,10644102.019992093,10703042.748842228,10761983.477692364,10820924.206542501,10879864.935392637,10938805.664242774,10997746.39309291,11056687.121943047,11115627.850793183,11174568.579643318,11233509.308493456,11292450.037343591,11351390.766193729,11410331.495043864],"type":"scatter","mode":"lines","line":{"color":"red","width":2},"name":"Fitted (Piecewise)","showlegend":true,"inherit":true},"3fae48f30e96.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1999,"y":7904858,"xend":1999,"yend":11428636,"type":"scatter","mode":"lines","line":{"color":"darkgreen","dash":"dash","width":2},"name":"Knots","showlegend":true,"legendgroup":"knots","inherit":true},"3fae48f30e96.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":2007,"y":7904858,"xend":2007,"yend":11428636,"type":"scatter","mode":"lines","line":{"color":"darkgreen","dash":"dash","width":2},"showlegend":false,"legendgroup":"knots","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":{"text":"Piecewise Linear Regression<br><sub>Optimal: 2 knots<\/sub>","font":{"size":16}},"xaxis":{"domain":[0,1],"automargin":true,"title":"index"},"yaxis":{"domain":[0,1],"automargin":true,"title":"y"},"hovermode":"x unified","legend":{"orientation":"h","y":-0.20000000000000001},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.5,"line":{"color":"rgba(31,119,180,1)"}},"name":"Actual","showlegend":true,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8083717.1616370743,8185172.949722074,8286628.7378070652,8388084.5258920575,8489540.3139770497,8590996.1020620428,8692451.8901470341,8793907.6782320254,8895363.4663170185,8996819.2544020098,9098275.0424870029,9199730.8305719942,9301186.6186569873,9439580.6793988068,9577974.7401406262,9716368.8008824475,9854762.861624267,9993156.9223660864,10131550.983107906,10269945.043849727,10408339.104591547,10467279.833441682,10526220.56229182,10585161.291141955,10644102.019992093,10703042.748842228,10761983.477692364,10820924.206542501,10879864.935392637,10938805.664242774,10997746.39309291,11056687.121943047,11115627.850793183,11174568.579643318,11233509.308493456,11292450.037343591,11351390.766193729,11410331.495043864],"type":"scatter","mode":"lines","line":{"color":"red","width":2},"name":"Fitted (Piecewise)","showlegend":true,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1999,1999],"y":[7904858,11428636],"type":"scatter","mode":"lines","line":{"color":"darkgreen","dash":"dash","width":2},"name":"Knots","showlegend":true,"legendgroup":"knots","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2007,2007],"y":[7904858,11428636],"type":"scatter","mode":"lines","line":{"color":"darkgreen","dash":"dash","width":2},"showlegend":false,"legendgroup":"knots","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># record &lt;- record_piecewise_search(</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     data = ts1,</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     time_col = "index",</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     value_col = "y",</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     max_knots = 3,</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_segment_length = 8,</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     edge_buffer = 0.05,</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     grid_resolution = 25,</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     output_dir = "animation_frames",</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     dpi = 100,</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     gif_width = 800</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># browseURL(record$gif_path)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="ar-model" class="level3">
<h3 class="anchored" data-anchor-id="ar-model">AR model</h3>
<p>The Auto Regressive (AR) model is a common approach in time series forecasting to model time series with high correlation with its past lags. The AR model is part of a family of models that construct the ARIMA family of models.</p>
<p>At its core, AR model is a regression of the series with its previous lags. For example, AR 1 model would be a regression of the series with its lag one:</p>
<p><span class="math display">\[
Y_t = \beta_0 + \beta_1 * Y_{t-1}
\]</span></p>
<p>Let’s update the above model formula:</p>
<p><span class="math display">\[
Y_t = \beta_0 + \beta_1 * trend +  \beta_2 * Y_{t-1}
\]</span></p>
<p>And create a lag 1 feature:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ts1<span class="sc">$</span>lag1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(ts1<span class="sc">$</span>y, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ts1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 38 x 9 [1Y]
   index       y series_id trend     fit1     res1 trend2     fit2    lag1
   &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;int&gt;
 1  1987 7904858 SCA           1 8217412. -312554.      0 8005104.      NA
 2  1988 8113034 SCA           2 8311426. -198392.      0 8121250. 7904858
 3  1989 8313776 SCA           3 8405439.  -91663.      0 8237396. 8113034
 4  1990 8497848 SCA           4 8499453.   -1605.      0 8353542. 8313776
 5  1991 8634774 SCA           5 8593467.   41307.      0 8469688. 8497848
 6  1992 8680613 SCA           6 8687480.   -6867.      0 8585835. 8634774
 7  1993 8726187 SCA           7 8781494.  -55307.      0 8701981. 8680613
 8  1994 8790733 SCA           8 8875508.  -84775.      0 8818127. 8726187
 9  1995 8865541 SCA           9 8969521. -103980.      0 8934273. 8790733
10  1996 8969308 SCA          10 9063535.  -94227.      0 9050419. 8865541
# ℹ 28 more rows</code></pre>
</div>
</div>
<p>Let’s now fit the model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>md3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> trend <span class="sc">+</span> lag1, <span class="at">data =</span> ts1)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> md3, <span class="at">newdata =</span> ts1, <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>ts1<span class="sc">$</span>fit3 <span class="ot">&lt;-</span> fit3[, <span class="dv">1</span>]</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(md3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ trend + lag1, data = ts1)

Residuals:
    Min      1Q  Median      3Q     Max 
-114148  -35769    3264   30177  126480 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 8.009e+05  4.862e+05   1.647    0.109    
trend       5.153e+03  5.842e+03   0.882    0.384    
lag1        9.184e-01  6.062e-02  15.150   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 58370 on 34 degrees of freedom
  (1 observation deleted due to missingness)
Multiple R-squared:  0.9969,    Adjusted R-squared:  0.9967 
F-statistic:  5423 on 2 and 34 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_lines</span>(<span class="at">x =</span> ts1<span class="sc">$</span>index, <span class="at">y =</span> ts1<span class="sc">$</span>fit3, <span class="at">mode =</span> <span class="st">"lines"</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">dash =</span> <span class="st">"dash"</span>), <span class="at">name =</span> <span class="st">"Fitted"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-65e5e3ceb401c4a615bf" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-65e5e3ceb401c4a615bf">{"x":{"visdat":{"3fae75473045":["function () ","plotlyVisDat"]},"cur_data":"3fae75473045","attrs":{"3fae75473045":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","inherit":true},"3fae75473045.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[null,8071420.3384115035,8267772.383452327,8457296.6928584166,8631510.4893466961,8762423.1795348469,8809677.2800322585,8856687.9920519721,8921123.4821806662,8994984.076302316,9095441.9795773495,9184325.6126790009,9301029.0080050379,9443286.3565951567,9484801.999701418,9703333.6234136391,9821933.6119715478,9897503.4361195955,10044190.455003811,10202743.810234645,10395986.911890538,10502165.822062096,10577067.935178874,10578352.84059234,10612560.400238072,10693583.044733632,10750836.278652532,10823028.972866639,10852807.780665359,11030516.26831454,10986781.652930627,11073203.847842732,11097585.860566163,11182005.84083155,11255359.452161919,11302946.948951423,11351980.999900825,11430135.334147897],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Natural Gas Consumers in California","yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Consumers"},"xaxis":{"domain":[0,1],"automargin":true,"title":"Period"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8071420.3384115035,8267772.383452327,8457296.6928584166,8631510.4893466961,8762423.1795348469,8809677.2800322585,8856687.9920519721,8921123.4821806662,8994984.076302316,9095441.9795773495,9184325.6126790009,9301029.0080050379,9443286.3565951567,9484801.999701418,9703333.6234136391,9821933.6119715478,9897503.4361195955,10044190.455003811,10202743.810234645,10395986.911890538,10502165.822062096,10577067.935178874,10578352.84059234,10612560.400238072,10693583.044733632,10750836.278652532,10823028.972866639,10852807.780665359,11030516.26831454,10986781.652930627,11073203.847842732,11097585.860566163,11182005.84083155,11255359.452161919,11302946.948951423,11351980.999900825,11430135.334147897],"type":"scatter","mode":"lines","line":{"color":"black","dash":"dash"},"name":"Fitted","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Let’s check the model residuals:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_residuals</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ts1,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">index_col =</span> <span class="st">"index"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_col =</span> <span class="st">"y"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted_col =</span> <span class="st">"fit3"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag_max =</span> <span class="dv">60</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.05</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-dd9412915f7ed774ed1e" style="width:100%;height:780px;"></div>
<script type="application/json" data-for="htmlwidget-dd9412915f7ed774ed1e">{"x":{"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#0072B5"},"showlegend":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2002,2003,2004,2005,2007,2008,2009,2010,2011,2012,2013,2014,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8071420.3384115035,8267772.383452327,8457296.6928584166,8631510.4893466961,8762423.1795348469,8809677.2800322585,8856687.9920519721,8921123.4821806662,8994984.076302316,9095441.9795773495,9184325.6126790009,9301029.0080050379,9443286.3565951567,9703333.6234136391,9821933.6119715478,9897503.4361195955,10044190.455003811,10395986.911890538,10502165.822062096,10577067.935178874,10578352.84059234,10612560.400238072,10693583.044733632,10750836.278652532,10823028.972866639,10986781.652930627,11073203.847842732,11097585.860566163,11182005.84083155,11255359.452161919,11302946.948951423,11351980.999900825,11430135.334147897],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6,"line":{"color":"rgba(255,127,14,1)"}},"name":"Fitted","showlegend":true,"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[2001,2006,2015,2016],"y":[9484801.999701418,10202743.810234645,10852807.780665359,11030516.26831454],"type":"scatter","mode":"markers","marker":{"color":"orange","size":6,"line":{"color":"rgba(44,160,44,1)"}},"name":"Fitted (2-3 SD)","showlegend":true,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[41613.661588496529,46003.616547673009,40551.307141583413,3263.5106533039361,-81810.179534846917,-83490.280032258481,-65954.992051972076,-55582.482180666178,-25676.07630231604,-34968.979577349499,-2397.6126790009439,30176.991994962096,-72489.356595156714,118320.00029858202,23308.376586360857,-18622.611971547827,59908.563880404457,80242.544996188954,126480.18976535462,43233.088109461591,12996.177937904373,-66117.935178874061,-35768.840592339635,12629.5997619275,-11667.044733632356,4071.7213474679738,-41308.972866639495,116789.21933464147,-114148.26831454039,18071.347069373354,-47414.847842732444,14508.139433836564,4344.1591684501618,-22807.452161919326,-22617.948951423168,7831.0000991746783,-1499.3341478966177],"type":"scatter","mode":"markers","name":"Residuals","marker":{"color":"#0072B5","line":{"color":"rgba(214,39,40,1)"}},"showlegend":false,"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[113456.17694823549,113456.17694823549],"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"+2SD","showlegend":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-113456.17694823549,-113456.17694823549],"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"-2SD","showlegend":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[170184.26542235323,170184.26542235323],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"+3SD","showlegend":false,"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1987,2024],"y":[-170184.26542235323,-170184.26542235323],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"-3SD","showlegend":false,"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[0.10904669878159877,0.27931943671508308,-0.024518966167160695,-0.024542050965209953,-0.026760628796319342,-0.14309037091410129,-0.063031262403081226,-0.17068248054855378,-0.087018901837643534,-0.18554331586423636,-0.15982551860818689,-0.23019198981284625,-0.11074658906348303,0.027947766711208435,-0.14596006580935095,0.22680100511187856,0.067855512226231443,0.10822098866590113,0.0067928863633869366,-0.06895389616657141,-0.014564301823144412,0.011465016891090514,-0.0039615134787843245,0.083241721109871492,0.045117842391227521,0.026268462413390637,0.010790186985259151,-0.027193312713944515,0.021530855579555506,0.00078985311704106833,-0.0061335628385413132,-0.014133867477344604,-0.014475046907849502,-0.0055395530927803997,0.0022175240480069298,-0.00053856182159734399],"marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"name":"ACF","showlegend":false,"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"scatter","x":[1,36],"y":[0.32221609421335773,0.32221609421335773],"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"type":"scatter","x":[1,36],"y":[-0.32221609421335773,-0.32221609421335773],"mode":"lines","line":{"color":"black","dash":"dash"},"showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y5","frame":null},{"x":[-2.2111272410853271,-1.7444475421409684,-1.4941549086209043,-1.3129814789733738,-1.1669186011353174,-1.0422467418324088,-0.93197131234319031,-0.83200627001647287,-0.73973721941388981,-0.65337661097153532,-0.57163752516508581,-0.49355339508954554,-0.41837128791165423,-0.34548507371979864,-0.27439148786003692,-0.20465991857047608,-0.13591068064648049,-0.067798615441235707,0,0.067798615441235568,0.13591068064648049,0.20465991857047591,0.27439148786003692,0.34548507371979831,0.41837128791165423,0.49355339508954527,0.57163752516508581,0.6533766109715351,0.73973721941388981,0.83200627001647287,0.93197131234319031,1.0422467418324088,1.1669186011353174,1.3129814789733738,1.4941549086209047,1.7444475421409684,2.2111272410853284],"y":[-2.0122001531326341,-1.4717626184487422,-1.4421458881374765,-1.2778388721529199,-1.1655237635768638,-1.1626514100164873,-0.97980530766564966,-0.83582664457954503,-0.72819257580815044,-0.63053139202214026,-0.61643148073471732,-0.45261663124841123,-0.4020486636408736,-0.39870811021146235,-0.32827850316242141,-0.20566610029450252,-0.042265000346271384,-0.026430189844694786,0.057529007958587577,0.071776106986660496,0.076578627718634176,0.1380444910063667,0.22263397377982891,0.22909599613660414,0.25574878026173864,0.3185608321284697,0.41087893516797019,0.53195855539411363,0.71483648105090025,0.73356361386091573,0.76211078624984485,0.81094952756360295,1.0560652666401205,1.4145117023077334,2.0587547099868475,2.0857392427838404,2.2295866680411836],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998,"line":{"color":"rgba(44,160,44,1)"}},"name":"Sample","showlegend":false,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x3","yaxis":"y4","frame":null},{"x":[-2.2111272410853271,-1.7444475421409684,-1.4941549086209043,-1.3129814789733738,-1.1669186011353174,-1.0422467418324088,-0.93197131234319031,-0.83200627001647287,-0.73973721941388981,-0.65337661097153532,-0.57163752516508581,-0.49355339508954554,-0.41837128791165423,-0.34548507371979864,-0.27439148786003692,-0.20465991857047608,-0.13591068064648049,-0.067798615441235707,0,0.067798615441235568,0.13591068064648049,0.20465991857047591,0.27439148786003692,0.34548507371979831,0.41837128791165423,0.49355339508954527,0.57163752516508581,0.6533766109715351,0.73973721941388981,0.83200627001647287,0.93197131234319031,1.0422467418324088,1.1669186011353174,1.3129814789733738,1.4941549086209047,1.7444475421409684,2.2111272410853284],"y":[-2.2111272410853271,-1.7444475421409684,-1.4941549086209043,-1.3129814789733738,-1.1669186011353174,-1.0422467418324088,-0.93197131234319031,-0.83200627001647287,-0.73973721941388981,-0.65337661097153532,-0.57163752516508581,-0.49355339508954554,-0.41837128791165423,-0.34548507371979864,-0.27439148786003692,-0.20465991857047608,-0.13591068064648049,-0.067798615441235707,0,0.067798615441235568,0.13591068064648049,0.20465991857047591,0.27439148786003692,0.34548507371979831,0.41837128791165423,0.49355339508954527,0.57163752516508581,0.6533766109715351,0.73973721941388981,0.83200627001647287,0.93197131234319031,1.0422467418324088,1.1669186011353174,1.3129814789733738,1.4941549086209047,1.7444475421409684,2.2111272410853284],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x3","yaxis":"y4","frame":null},{"fillcolor":"rgba(0, 114, 181, 0.3)","x":[-178684.85272696431,-177961.36617724856,-177237.87962753282,-176514.39307781711,-175790.90652810136,-175067.41997838562,-174343.93342866987,-173620.44687895413,-172896.96032923838,-172173.47377952264,-171449.98722980692,-170726.50068009118,-170003.01413037544,-169279.52758065969,-168556.04103094395,-167832.55448122823,-167109.06793151249,-166385.58138179674,-165662.094832081,-164938.60828236525,-164215.12173264951,-163491.63518293377,-162768.14863321805,-162044.66208350231,-161321.17553378656,-160597.68898407082,-159874.20243435507,-159150.71588463936,-158427.22933492361,-157703.74278520787,-156980.25623549212,-156256.76968577638,-155533.28313606064,-154809.79658634489,-154086.31003662918,-153362.82348691343,-152639.33693719769,-151915.85038748194,-151192.3638377662,-150468.87728805048,-149745.39073833474,-149021.904188619,-148298.41763890325,-147574.93108918751,-146851.44453947176,-146127.95798975602,-145404.4714400403,-144680.98489032456,-143957.49834060881,-143234.01179089307,-142510.52524117735,-141787.03869146161,-141063.55214174587,-140340.06559203012,-139616.57904231438,-138893.09249259863,-138169.60594288289,-137446.11939316714,-136722.63284345143,-135999.14629373568,-135275.65974401994,-134552.1731943042,-133828.68664458848,-133105.20009487274,-132381.71354515699,-131658.22699544125,-130934.7404457255,-130211.25389600976,-129487.76734629403,-128764.28079657828,-128040.79424686256,-127317.30769714681,-126593.82114743107,-125870.33459771532,-125146.84804799959,-124423.36149828385,-123699.87494856812,-122976.38839885237,-122252.90184913663,-121529.41529942089,-120805.92874970516,-120082.44219998941,-119358.95565027368,-118635.46910055794,-117911.98255084219,-117188.49600112645,-116465.00945141072,-115741.52290169497,-115018.03635197924,-114294.5498022635,-113571.06325254776,-112847.57670283203,-112124.09015311628,-111400.60360340054,-110677.11705368481,-109953.63050396906,-109230.14395425332,-108506.65740453759,-107783.17085482184,-107059.6843051061,-106336.19775539037,-105612.71120567463,-104889.22465595888,-104165.73810624315,-103442.25155652741,-102718.76500681166,-101995.27845709593,-101271.79190738019,-100548.30535766445,-99824.818807948715,-99101.332258232971,-98377.845708517227,-97654.359158801497,-96930.872609085753,-96207.386059370008,-95483.899509654279,-94760.412959938534,-94036.92641022279,-93313.43986050706,-92589.953310791316,-91866.466761075571,-91142.980211359842,-90419.493661644097,-89696.007111928353,-88972.520562212623,-88249.034012496879,-87525.547462781135,-86802.060913065405,-86078.57436334966,-85355.087813633916,-84631.601263918186,-83908.114714202442,-83184.628164486698,-82461.141614770968,-81737.655065055224,-81014.168515339479,-80290.681965623749,-79567.195415908005,-78843.708866192261,-78120.222316476531,-77396.735766760787,-76673.249217045042,-75949.762667329313,-75226.276117613568,-74502.789567897824,-73779.303018182094,-73055.81646846635,-72332.329918750605,-71608.843369034876,-70885.356819319131,-70161.870269603387,-69438.383719887657,-68714.897170171913,-67991.410620456169,-67267.924070740439,-66544.437521024694,-65820.95097130895,-65097.46442159322,-64373.977871877476,-63650.491322161732,-62927.004772446002,-62203.518222730258,-61480.031673014513,-60756.545123298783,-60033.058573583039,-59309.572023867295,-58586.085474151565,-57862.598924435821,-57139.112374720076,-56415.625825004347,-55692.139275288602,-54968.652725572858,-54245.166175857128,-53521.679626141384,-52798.193076425639,-52074.70652670991,-51351.219976994165,-50627.733427278421,-49904.246877562691,-49180.760327846947,-48457.273778131203,-47733.787228415473,-47010.300678699743,-46286.814128983999,-45563.327579268254,-44839.84102955251,-44116.354479836766,-43392.867930121021,-42669.381380405306,-41945.894830689562,-41222.408280973817,-40498.921731258073,-39775.435181542329,-39051.948631826584,-38328.462082110869,-37604.975532395125,-36881.488982679381,-36158.002432963636,-35434.515883247892,-34711.029333532148,-33987.542783816432,-33264.056234100688,-32540.569684384944,-31817.083134669199,-31093.596584953455,-30370.110035237711,-29646.623485521995,-28923.136935806251,-28199.650386090507,-27476.163836374762,-26752.677286659018,-26029.190736943274,-25305.704187227559,-24582.217637511814,-23858.73108779607,-23135.244538080326,-22411.757988364581,-21688.271438648837,-20964.784888933122,-20241.298339217377,-19517.811789501633,-18794.325239785889,-18070.838690070144,-17347.3521403544,-16623.865590638685,-15900.37904092294,-15176.892491207196,-14453.405941491452,-13729.919391775707,-13006.432842059963,-12282.946292344248,-11559.459742628504,-10835.973192912759,-10112.486643197015,-9389.0000934812706,-8665.5135437655263,-7942.026994049811,-7218.5404443340667,-6495.0538946183224,-5771.567344902578,-5048.0807951868337,-4324.5942454710894,-3601.1076957553742,-2877.6211460396298,-2154.1345963238855,-1430.6480466081412,-707.16149689239683,16.325052823347505,739.81160253906273,1463.2981522548071,2186.7847019705514,2910.2712516862957,3633.7578014020401,4357.2443511177844,5080.7309008334996,5804.2174505492439,6527.7040002649883,7251.1905499807326,7974.6770996964769,8698.1636494121922,9421.6501991279365,10145.136748843681,10868.623298559425,11592.109848275169,12315.596397990914,13039.082947706629,13762.569497422373,14486.056047138118,15209.542596853862,15933.029146569606,16656.515696285351,17380.002246001066,18103.48879571681,18826.975345432555,19550.461895148299,20273.948444864043,20997.434994579788,21720.921544295503,22444.408094011247,23167.894643726991,23891.381193442736,24614.86774315848,25338.354292874224,26061.84084258994,26785.327392305684,27508.813942021428,28232.300491737173,28955.787041452917,29679.273591168661,30402.760140884377,31126.246690600121,31849.733240315865,32573.21979003161,33296.706339747354,34020.192889463098,34743.679439178813,35467.165988894558,36190.652538610302,36914.139088326046,37637.625638041791,38361.112187757535,39084.59873747325,39808.085287188995,40531.571836904739,41255.058386620483,41978.544936336228,42702.031486051972,43425.518035767687,44149.004585483432,44872.491135199176,45595.97768491492,46319.464234630665,47042.950784346409,47766.437334062124,48489.923883777868,49213.410433493613,49936.896983209357,50660.383532925101,51383.870082640846,52107.356632356561,52830.843182072305,53554.32973178805,54277.816281503794,55001.302831219538,55724.789380935283,56448.275930650998,57171.762480366742,57895.249030082487,58618.735579798231,59342.222129513975,60065.70867922972,60789.195228945435,61512.681778661179,62236.168328376923,62959.654878092668,63683.141427808412,64406.627977524156,65130.114527239872,65853.601076955616,66577.08762667136,67300.574176387105,68024.060726102849,68747.547275818593,69471.033825534309,70194.520375250053,70918.006924965797,71641.493474681542,72364.980024397286,73088.46657411303,73811.953123828745,74535.43967354449,75258.926223260234,75982.412772975978,76705.899322691723,77429.385872407467,78152.872422123182,78876.358971838927,79599.845521554671,80323.332071270415,81046.81862098616,81770.305170701904,82493.791720417619,83217.278270133364,83940.764819849137,84664.251369564823,85387.737919280567,86111.224468996312,86834.711018712056,87558.1975684278,88281.684118143545,89005.170667859289,89728.657217575033,90452.143767290778,91175.630317006522,91899.116866722266,92622.603416438011,93346.089966153697,94069.576515869441,94793.063065585186,95516.54961530093,96240.036165016674,96963.522714732419,97687.009264448163,98410.495814163907,99133.982363879652,99857.468913595396,100580.95546331114,101304.44201302683,102027.92856274257,102751.41511245831,103474.90166217406,104198.3882118898,104921.87476160555,105645.36131132129,106368.84786103704,107092.33441075278,107815.82096046853,108539.30751018427,109262.79405990001,109986.2806096157,110709.76715933144,111433.25370904719,112156.74025876293,112880.22680847868,113603.71335819442,114327.19990791017,115050.68645762591,115774.17300734165,116497.6595570574,117221.14610677314,117944.63265648889,118668.11920620457,119391.60575592032,120115.09230563606,120838.57885535181,121562.06540506755,122285.5519547833,123009.03850449904,123732.52505421478,124456.01160393053,125179.49815364627,125902.98470336202,126626.47125307776,127349.95780279345,128073.44435250919,128796.93090222494,129520.41745194068,130243.90400165642,130967.39055137217,131690.87710108791,132414.36365080366,133137.8502005194,133861.33675023515,134584.82329995089,135308.30984966664,136031.79639938232,136755.28294909807,137478.76949881381,138202.25604852955,138925.7425982453,139649.22914796104,140372.71569767679,141096.20224739253,141819.68879710828,142543.17534682402,143266.66189653976,143990.14844625551,144713.6349959712,145437.12154568694,146160.60809540268,146884.09464511843,147607.58119483417,148331.06774454992,149054.55429426566,149778.04084398141,150501.52739369715,151225.01394341289,151948.50049312864,152671.98704284438,153395.47359256007,154118.96014227581,154842.44669199156,155565.9332417073,156289.41979142305,157012.90634113879,157736.39289085453,158459.87944057028,159183.36599028602,159906.85254000177,160630.33908971751,161353.82563943326,162077.31218914894,162800.79873886469,163524.28528858043,164247.77183829618,164971.25838801192,165694.74493772766,166418.23148744341,167141.71803715915,167865.2045868749,168588.69113659064,169312.17768630639,170035.66423602213,170759.15078573782,171482.63733545356,172206.12388516931,172929.61043488505,173653.09698460079,174376.58353431654,175100.07008403228,175823.55663374803,176547.04318346377,177270.52973317952,177994.01628289526,178717.502832611,179440.98938232669,180164.47593204243,180887.96248175818,181611.44903147392,182334.93558118967,183058.42213090541,183781.90868062116,184505.3952303369,185228.88178005264,185952.36832976839,186675.85487948413,187399.34142919988,188122.82797891556,188846.31452863131,189569.80107834705,190293.2876280628,191016.77417777854],"y":[5.6285264277744005e-09,6.2249760145433192e-09,6.8849148864194077e-09,7.5920709726210138e-09,8.3640522328365455e-09,9.2217984326913607e-09,1.0138609774231647e-08,1.1127395873240869e-08,1.2229848553097351e-08,1.3405164571835711e-08,1.4658476316392297e-08,1.6059716287311916e-08,1.7549587655422798e-08,1.9129114259453513e-08,2.088294578047041e-08,2.2750506104641661e-08,2.4725538613651816e-08,2.6891304913489455e-08,2.9206291744521999e-08,3.1648250366962599e-08,3.4295037724874285e-08,3.7132904709838665e-08,4.0118604175037317e-08,4.3319922166556193e-08,4.6760518720055035e-08,5.0370724169619909e-08,5.4203094084454587e-08,5.8328922975209176e-08,6.2646494369733623e-08,6.7187701249681827e-08,7.2081806746153991e-08,7.718949826308131e-08,8.2516575218176183e-08,8.826016225416063e-08,9.4238191892412967e-08,1.0045186385777833e-07,1.0709517926289998e-07,1.1401873246957253e-07,1.2119691791757974e-07,1.2880113702649208e-07,1.3673801078818975e-07,1.4494614613079865e-07,1.5356890888194164e-07,1.6257753275897989e-07,1.7187122850290966e-07,1.8156076328546057e-07,1.9168884460042847e-07,2.0211275241873365e-07,2.1290715440294254e-07,2.2419118031262691e-07,2.3577877819504845e-07,2.4770613043467166e-07,2.6017191579373334e-07,2.7294638110761953e-07,2.8602978415669923e-07,2.9969023480321081e-07,3.1366649153897956e-07,3.2795475030937184e-07,3.4278415051419852e-07,3.5797206646511188e-07,3.73474281434701e-07,3.8948069594556273e-07,4.0588927562944475e-07,4.2261499161076253e-07,4.3980872165655947e-07,4.5745100290534306e-07,4.7541523873695386e-07,4.9381335451083508e-07,5.1271158549196687e-07,5.3193999913235597e-07,5.5157081955869834e-07,5.717613850650863e-07,5.9229501762206974e-07,6.1320205427510545e-07,6.3473955198384914e-07,6.5663854117042921e-07,6.7890031020867857e-07,7.0184324858039287e-07,7.251889070091081e-07,7.4892215270715936e-07,7.7333167321436126e-07,7.9822639829784186e-07,8.235389834900886e-07,8.4952349073918305e-07,8.7608811254647774e-07,9.0310513157799375e-07,9.3078672535512107e-07,9.5915510056026447e-07,9.8801268245382199e-07,1.0175207846903501e-06,1.0478316946567893e-06,1.0786681778498013e-06,1.1101310138300096e-06,1.1425177015192359e-06,1.1754625986246718e-06,1.208996960647153e-06,1.2435749175298721e-06,1.2787363591488425e-06,1.3144824545768889e-06,1.3512901525891897e-06,1.3887417306417487e-06,1.4267910359366476e-06,1.4658375401142699e-06,1.5056056350291568e-06,1.5459697654696781e-06,1.5872432913953938e-06,1.6292960403833695e-06,1.6719256977757106e-06,1.7153561636945948e-06,1.7595951939065356e-06,1.8043728749503516e-06,1.8498267198236158e-06,1.8960826255756751e-06,1.9428193187514117e-06,1.9900979588057844e-06,2.0381302529842346e-06,2.0865667620675784e-06,2.135409121100765e-06,2.184911055602589e-06,2.2347242317672262e-06,2.2848424449350337e-06,2.3354217338837955e-06,2.3862354947529779e-06,2.4372477691056899e-06,2.4885186176057781e-06,2.5399192178327661e-06,2.5914043920521202e-06,2.6429649447895518e-06,2.6945195785654985e-06,2.7460430596499619e-06,2.7974866068565343e-06,2.8487641062721184e-06,2.8998989149613261e-06,2.9508326485712018e-06,3.0014248253795063e-06,3.0517728368619152e-06,3.101836305073666e-06,3.1513783902909929e-06,3.2005902228662155e-06,3.2494670041467177e-06,3.2976608849946032e-06,3.3454529721195363e-06,3.3928455316432309e-06,3.4395133197035489e-06,3.4856809134814426e-06,3.5314075430896459e-06,3.5764145630505159e-06,3.6208397412894923e-06,3.6648069012152772e-06,3.7080994403191872e-06,3.7507535954343069e-06,3.7929567888100052e-06,3.8345609168355427e-06,3.8755016556679534e-06,3.9160207769660752e-06,3.956036562776233e-06,3.9953993999862428e-06,4.0343890696699894e-06,4.0729807443112061e-06,4.1109663861054759e-06,4.1486421779981999e-06,4.18601229575892e-06,4.2228834425324988e-06,4.2595052160116009e-06,4.2958951541133989e-06,4.3319429074560822e-06,4.3677966453091174e-06,4.403496627186736e-06,4.438995961466275e-06,4.4743755690484305e-06,4.5096788071727635e-06,4.5449011281479844e-06,4.5800915661505107e-06,4.6152779930766749e-06,4.6504776651565363e-06,4.6857405760325308e-06,4.7210633537538737e-06,4.7564668741587543e-06,4.7920295429494145e-06,4.827705080148635e-06,4.8635033911979755e-06,4.8995514878586123e-06,4.9357532862305331e-06,4.9721108148478553e-06,5.0087715001299355e-06,5.045627722303508e-06,5.0826670341672815e-06,5.1200229517734885e-06,5.1576171995178097e-06,5.195410133730314e-06,5.2335121571108892e-06,5.2718866128631499e-06,5.3104647356965464e-06,5.3493288463946534e-06,5.3884887010048676e-06,5.4278478946342043e-06,5.4674592878137301e-06,5.507377279917658e-06,5.5474821018191613e-06,5.587798742732005e-06,5.6284186840596868e-06,5.6692054143560878e-06,5.7101601990707121e-06,5.7513985534487062e-06,5.7927760819206789e-06,5.8342907659261963e-06,5.8760218829308355e-06,5.9178699396366935e-06,5.9598183099776932e-06,6.001905323802861e-06,6.0440699899199224e-06,6.0862879115608234e-06,6.1285619835049078e-06,6.1708488836893127e-06,6.2131295614377371e-06,6.2553802656199597e-06,6.2975462851381201e-06,6.33963176171543e-06,6.3815994768332037e-06,6.4233442107815828e-06,6.4649170009748591e-06,6.5062858509958753e-06,6.5472442298749351e-06,6.5879205749586282e-06,6.6283077619372041e-06,6.6680507843976658e-06,6.7073770290102482e-06,6.746283163080403e-06,6.7843647604089711e-06,6.821818186073349e-06,6.8587023864320148e-06,6.8945908005655094e-06,6.9295859038217786e-06,6.9638472403556001e-06,6.9969607314074712e-06,7.0288614396000544e-06,7.0598528602728111e-06,7.0895739883572979e-06,7.1177117114609582e-06,7.1447596605315983e-06,7.1704542056493295e-06,7.1941509917121543e-06,7.2165798016862326e-06,7.2376193815858104e-06,7.2562148476339799e-06,7.2733744169535872e-06,7.2890883884093304e-06,7.3020416499348706e-06,7.3133364733759221e-06,7.3230382130429467e-06,7.3299558829768568e-06,7.3348732390910576e-06,7.3380768092005665e-06,7.3385469516359708e-06,7.3366820084897972e-06,7.3330156190912186e-06,7.3267372691075555e-06,7.317813058526011e-06,7.3070372592065755e-06,7.2938341388724604e-06,7.2777147559339166e-06,7.2597334730968674e-06,7.2395612494435281e-06,7.21625721774494e-06,7.1911207773455648e-06,7.1640673514033719e-06,7.1337327937705203e-06,7.1016327888802111e-06,7.0677726333134145e-06,7.0308336907696528e-06,6.9920902870792835e-06,6.95168926418426e-06,6.9086090721004896e-06,6.8636520117527469e-06,6.8171662226795646e-06,6.7684057257583382e-06,6.7177508179060382e-06,6.6657153431565146e-06,6.6117977099355962e-06,6.5560209291935161e-06,6.4990236376959274e-06,6.4405111234661936e-06,6.3802225425869084e-06,6.3188783725041283e-06,6.2563502422891657e-06,6.1921698978664234e-06,6.1270976277204499e-06,6.0611307217550039e-06,5.9936681739002261e-06,5.9254713092435087e-06,5.856549306652282e-06,5.7864633160281011e-06,5.7157161779570514e-06,5.6443913189336333e-06,5.5722072969972525e-06,5.4994467821733147e-06,5.4262450694587562e-06,5.3524395632012976e-06,5.2781624247761157e-06,5.203569817270509e-06,5.1285837222734124e-06,5.0532486679601929e-06,4.9777143714362596e-06,4.9019570742138756e-06,4.8259905504441653e-06,4.7499336068812567e-06,4.6737895236908801e-06,4.5975937932624985e-06,4.5214115335512523e-06,4.4452489625345648e-06,4.3692098696126527e-06,4.2932867707987378e-06,4.2174846428549195e-06,4.1419609155500896e-06,4.0666765495971463e-06,3.9916141386890387e-06,3.9169610036725899e-06,3.8426960459934024e-06,3.7687550016772549e-06,3.6953311829195905e-06,3.6224708173132065e-06,3.5500377601505242e-06,3.4782067625681382e-06,3.407141219276885e-06,3.3366074633500965e-06,3.2667364331174791e-06,3.1978587737803928e-06,3.1296173910503554e-06,3.0620738251285755e-06,2.995775395747083e-06,2.9302161159495502e-06,2.8654021324852256e-06,2.8020270681465511e-06,2.7395296774333414e-06,2.6778764387276217e-06,2.6177139166314618e-06,2.5586408682476923e-06,2.500504892264799e-06,2.4438786685794198e-06,2.3885675575383219e-06,2.3342784388149928e-06,2.2814852226923076e-06,2.2302416272993518e-06,2.1800950457644763e-06,2.1313985811543149e-06,2.0844895722334008e-06,2.0387410178897104e-06,1.9943668092985004e-06,1.9520152135320868e-06,1.9108744531115155e-06,1.8710051004223976e-06,1.8333844171513013e-06,1.7970105571312073e-06,1.7618851427864482e-06,1.729011286246423e-06,1.6975081838057363e-06,1.6672724361785127e-06,1.6391450885015364e-06,1.6125568461123367e-06,1.5872377985320122e-06,1.5638572187512229e-06,1.5421635725148237e-06,1.5217225723546177e-06,1.5030277813089802e-06,1.48613934634491e-06,1.4704672804911146e-06,1.456331860849996e-06,1.4440854044532535e-06,1.4329980448593227e-06,1.423226158492578e-06,1.4153802993281376e-06,1.4086142328702678e-06,1.4029373016686603e-06,1.3991692422755325e-06,1.3963790447437314e-06,1.3945595619176964e-06,1.3943577374135997e-06,1.3951151800213745e-06,1.3967169907075797e-06,1.3996117924537853e-06,1.4034079019628375e-06,1.4079007009231593e-06,1.4133669830814929e-06,1.4196176966238277e-06,1.4263983643552537e-06,1.4338483190964324e-06,1.4419042796432697e-06,1.4503079238694755e-06,1.4591022191028258e-06,1.4682629601445806e-06,1.4775783517484065e-06,1.4870409945074591e-06,1.4965733897961014e-06,1.5060625487702155e-06,1.5154964558072045e-06,1.5246596015017648e-06,1.5335808759033515e-06,1.5422515021323712e-06,1.550359094412273e-06,1.557992684185881e-06,1.5651903491455985e-06,1.5715976766067313e-06,1.5772722295276906e-06,1.5823431414301043e-06,1.5864659541413795e-06,1.5895846421188692e-06,1.5919565323255595e-06,1.5932928546622118e-06,1.5933572536125466e-06,1.5925623289006651e-06,1.5907114621766188e-06,1.5873416218573457e-06,1.5830352681069779e-06,1.5777127428546349e-06,1.5706620427533674e-06,1.5626359651063259e-06,1.553633346091125e-06,1.5428471680860059e-06,1.5310360248295234e-06,1.5182521885437762e-06,1.5038424833534801e-06,1.4883235290455201e-06,1.4718738600361163e-06,1.4540027356469227e-06,1.4349884899364348e-06,1.4151204677816696e-06,1.3940648141344218e-06,1.3718892692484344e-06,1.3489669753645484e-06,1.3251029446854357e-06,1.300202271100295e-06,1.2746857450986712e-06,1.2484692442768383e-06,1.2213583115214601e-06,1.193779159051715e-06,1.1657235898695797e-06,1.1369698589326081e-06,1.1079047129022118e-06,1.0785377776461947e-06,1.0487537706754349e-06,1.0187972718521533e-06,9.8869715127195125e-07,9.5845420248435113e-07,9.2819309604081376e-07,8.979405052200961e-07,8.6777005883133848e-07,8.3775981533221667e-07,8.0789821907766352e-07,7.782907335289441e-07,7.4903582132681101e-07,7.2005290816141553e-07,6.9144303810615664e-07,6.6338163100166616e-07,6.3569538352107168e-07,6.0845122181210645e-07,5.8194475593960732e-07,5.5589442110979943e-07,5.303109478420735e-07,5.0563857892406387e-07,4.8148048739925016e-07,4.5783923281344131e-07,4.3513478223456676e-07,4.1304265578137624e-07,3.9150147093152879e-07,3.7086805934093048e-07,3.5093720032357982e-07,3.3157101025852537e-07,3.1305122249980545e-07,2.9530581099074253e-07,2.7812088392584098e-07,2.6169841809847769e-07,2.4610105386479546e-07,2.3104502885341464e-07,2.1665398167042026e-07,2.0311659568841848e-07,1.9008963099566805e-07,1.7762448761574549e-07,1.660198003823153e-07,1.5488604603574697e-07,1.4422066966763991e-07,1.3438454888322378e-07,1.2498326205373585e-07,1.1600499402262883e-07,1.0772248793657037e-07,9.9878253495771396e-08,9.240912817134442e-08,8.5511331474513456e-08,7.9043005763494078e-08,7.2901592693454031e-08,6.7219275765059037e-08,6.1947424739412046e-08,5.6955813867654283e-08,5.232500889291652e-08,4.807775081456431e-08,4.4066938384355064e-08,4.03331673567688e-08,3.6950447029231097e-08,3.376417907601509e-08,3.0785398444940705e-08,2.812181014607073e-08,2.5619022165945708e-08,2.3275011768297319e-08,2.1193755490185172e-08,1.924980082756946e-08,1.7433921026541728e-08,1.5816352747125643e-08,1.4323240583940268e-08,1.2932000176289121e-08,1.1687748162347211e-08,1.0553618509916396e-08,9.4994096042472377e-09,8.5521102506096278e-09],"type":"scatter","mode":"lines","fill":"tozeroy","line":{"color":"#0072B5","width":2},"name":"Density","showlegend":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x4","yaxis":"y3","frame":null},{"x":[-114148.26831454039,-111717.67782888489,-109287.08734322937,-106856.49685757387,-104425.90637191836,-101995.31588626286,-99564.725400607349,-97134.13491495185,-94703.544429296337,-92272.953943640838,-89842.363457985339,-87411.772972329825,-84981.182486674326,-82550.592001018813,-80120.001515363314,-77689.411029707815,-75258.820544052302,-72828.230058396788,-70397.639572741289,-67967.04908708579,-65536.458601430277,-63105.868115774778,-60675.277630119272,-58244.687144463765,-55814.096658808259,-53383.506173152753,-50952.915687497247,-48522.325201841741,-46091.734716186242,-43661.144230530728,-41230.553744875229,-38799.963259219716,-36369.372773564217,-33938.782287908718,-31508.191802253205,-29077.601316597706,-26647.010830942192,-24216.420345286693,-21785.82985963118,-19355.239373975681,-16924.648888320167,-14494.058402664668,-12063.467917009169,-9632.877431353656,-7202.2869456981571,-4771.6964600426436,-2341.1059743871447,89.484511268368806,2520.0749969238677,4950.6654825793667,7381.2559682348801,9811.8464538903791,12242.436939545893,14673.027425201391,17103.617910856905,19534.208396512404,21964.798882167903,24395.389367823402,26825.97985347893,29256.570339134429,31687.160824789928,34117.751310445426,36548.341796100955,38978.932281756453,41409.522767411952,43840.113253067451,46270.70373872295,48701.294224378478,51131.884710033977,53562.475195689476,55993.065681344975,58423.656167000503,60854.246652656002,63284.837138311501,65715.427623967,68146.018109622499,70576.608595278027,73007.199080933526,75437.789566589025,77868.380052244524,80298.970537900052,82729.56102355555,85160.151509211049,87590.741994866548,90021.332480522047,92451.922966177575,94882.513451833074,97313.103937488573,99743.694423144072,102174.28490879957,104604.8753944551,107035.4658801106,109466.0563657661,111896.6468514216,114327.23733707712,116757.82782273262,119188.41830838812,121619.00879404362,124049.59927969912,126480.18976535462],"y":[9.2873906400876005e-07,1.0114349173237109e-06,1.0994738151474515e-06,1.1929838312890762e-06,1.2920726784651315e-06,1.3968251547129331e-06,1.507300594015507e-06,1.6235303506601936e-06,1.745515348823008e-06,1.8732237305206576e-06,2.0065886363479059e-06,2.1455061542685981e-06,2.2898334721073936e-06,2.4393872692546399e-06,2.5939423824141022e-06,2.7532307789657914e-06,2.9169408696659414e-06,3.0847171899557436e-06,3.2561604761026892e-06,3.4308281587678753e-06,3.6082352924058598e-06,3.7878559341991228e-06,3.9691249810572049e-06,4.1514404676332792e-06,4.334166322401245e-06,4.5166355726772672e-06,4.6981539831528503e-06,4.8780041061311758e-06,5.0554497153291502e-06,5.2297405889330631e-06,5.4001176016859442e-06,5.5658180802493323e-06,5.7260813710280923e-06,5.8801545651758088e-06,6.0272983217046247e-06,6.1667927265920456e-06,6.297943123581462e-06,6.4200858510729085e-06,6.5325938191408494e-06,6.6348818613249963e-06,6.726411797429915e-06,6.8066971461326716e-06,6.8753074297104893e-06,6.9318720176196987e-06,6.9760834609230378e-06,7.0077002755983704e-06,7.0265491394763739e-06,7.0325264748430605e-06,7.0255993964885102e-06,7.0058060130607691e-06,6.9732550778610617e-06,6.9281249935574816e-06,6.8706621835614421e-06,6.8011788508686996e-06,6.7200501528828403e-06,6.6277108279889818e-06,6.5246513163134145e-06,6.4114134230871396e-06,6.288585578237133e-06,6.156797750183562e-06,6.0167160752652173e-06,5.8690372667078726e-06,5.7144828685678375e-06,5.5537934206202064e-06,5.3877225997311711e-06,5.217031401885872e-06,5.0424824267837181e-06,4.864834323823037e-06,4.6848364544502767e-06,4.5032238213316586e-06,4.3207123097121714e-06,4.1379942807600406e-06,3.9557345507618835e-06,3.7745667838439228e-06,3.5950903195584597e-06,3.4178674503000718e-06,3.2434211572075948e-06,3.0722333070640986e-06,2.9047433068191e-06,2.741347206807506e-06,2.5823972386001906e-06,2.4282017687531567e-06,2.2790256455751924e-06,2.1350909124456941e-06,1.9965778582101197e-06,1.8636263727743399e-06,1.7363375742130175e-06,1.6147756724926854e-06,1.4989700342688841e-06,1.3889174131211555e-06,1.2845843100046419e-06,1.1859094295806745e-06,1.09280619939378e-06,1.0051653205378493e-06,9.2285732044561859e-07,8.457350806877593e-07,7.7363631512472169e-07,7.0638597636111394e-07,6.4379857115537314e-07,5.8568036818629018e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x4","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"","anchor":"y"},"xaxis2":{"domain":[0,0.3133333333333333],"automargin":true,"title":"Lag","anchor":"y5"},"xaxis3":{"domain":[0.35333333333333333,0.64666666666666661],"automargin":true,"title":"Theoretical Quantiles","anchor":"y4"},"xaxis4":{"domain":[0.68666666666666665,1],"automargin":true,"title":"Residuals","anchor":"y3"},"yaxis3":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Density","anchor":"x4"},"yaxis4":{"domain":[0,0.47999999999999998],"automargin":true,"title":"Sample Quantiles","anchor":"x3"},"yaxis5":{"domain":[0,0.47999999999999998],"automargin":true,"title":"ACF","anchor":"x2"},"yaxis":{"domain":[0.52000000000000002,0.75039999999999996],"automargin":true,"title":"Residuals","anchor":"x"},"yaxis2":{"domain":[0.76960000000000006,1],"automargin":true,"title":"Value","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"showlegend":true,"legend":{"orientation":"h"},"hovermode":"closest","title":"Residual Plots"},"attrs":{"3fae10a776a1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#0072B5"},"showlegend":true,"inherit":true},"3fae10a776a1.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2002,2003,2004,2005,2007,2008,2009,2010,2011,2012,2013,2014,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8071420.3384115035,8267772.383452327,8457296.6928584166,8631510.4893466961,8762423.1795348469,8809677.2800322585,8856687.9920519721,8921123.4821806662,8994984.076302316,9095441.9795773495,9184325.6126790009,9301029.0080050379,9443286.3565951567,9703333.6234136391,9821933.6119715478,9897503.4361195955,10044190.455003811,10395986.911890538,10502165.822062096,10577067.935178874,10578352.84059234,10612560.400238072,10693583.044733632,10750836.278652532,10823028.972866639,10986781.652930627,11073203.847842732,11097585.860566163,11182005.84083155,11255359.452161919,11302946.948951423,11351980.999900825,11430135.334147897],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6},"name":"Fitted","showlegend":true,"inherit":true},"3fae10a776a1.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2001,2006,2015,2016],"y":[9484801.999701418,10202743.810234645,10852807.780665359,11030516.26831454],"type":"scatter","mode":"markers","marker":{"color":"orange","size":6},"name":"Fitted (2-3 SD)","showlegend":true,"inherit":true},"3fae331ff49":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[null,41613.661588496529,46003.616547673009,40551.307141583413,3263.5106533039361,-81810.179534846917,-83490.280032258481,-65954.992051972076,-55582.482180666178,-25676.07630231604,-34968.979577349499,-2397.6126790009439,30176.991994962096,-72489.356595156714,118320.00029858202,23308.376586360857,-18622.611971547827,59908.563880404457,80242.544996188954,126480.18976535462,43233.088109461591,12996.177937904373,-66117.935178874061,-35768.840592339635,12629.5997619275,-11667.044733632356,4071.7213474679738,-41308.972866639495,116789.21933464147,-114148.26831454039,18071.347069373354,-47414.847842732444,14508.139433836564,4344.1591684501618,-22807.452161919326,-22617.948951423168,7831.0000991746783,-1499.3341478966177],"type":"scatter","mode":"markers","name":"Residuals","marker":{"color":"#0072B5"},"showlegend":false,"inherit":true},"3fae331ff49.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":113456.17694823549,"xend":2024,"yend":113456.17694823549,"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"+2SD","showlegend":false,"inherit":true},"3fae331ff49.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":-113456.17694823549,"xend":2024,"yend":-113456.17694823549,"type":"scatter","mode":"lines","line":{"color":"orange","dash":"dash","width":2},"name":"-2SD","showlegend":false,"inherit":true},"3fae331ff49.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":170184.26542235323,"xend":2024,"yend":170184.26542235323,"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"+3SD","showlegend":false,"inherit":true},"3fae331ff49.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1987,"y":-170184.26542235323,"xend":2024,"yend":-170184.26542235323,"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"-3SD","showlegend":false,"inherit":true},"3fae40724b67":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"3fae40724b67.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[0.10904669878159877,0.27931943671508308,-0.024518966167160695,-0.024542050965209953,-0.026760628796319342,-0.14309037091410129,-0.063031262403081226,-0.17068248054855378,-0.087018901837643534,-0.18554331586423636,-0.15982551860818689,-0.23019198981284625,-0.11074658906348303,0.027947766711208435,-0.14596006580935095,0.22680100511187856,0.067855512226231443,0.10822098866590113,0.0067928863633869366,-0.06895389616657141,-0.014564301823144412,0.011465016891090514,-0.0039615134787843245,0.083241721109871492,0.045117842391227521,0.026268462413390637,0.010790186985259151,-0.027193312713944515,0.021530855579555506,0.00078985311704106833,-0.0061335628385413132,-0.014133867477344604,-0.014475046907849502,-0.0055395530927803997,0.0022175240480069298,-0.00053856182159734399],"marker":{"color":"#0072B5","line":{"color":"rgb(8,48,107)","width":1.5}},"name":"ACF","showlegend":false,"inherit":true},"3fae40724b67.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":1,"y":0.32221609421335773,"xend":36,"yend":0.32221609421335773,"mode":"lines","line":{"color":"black","dash":"dash"},"name":"95% CI","showlegend":false,"inherit":true},"3fae40724b67.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":1,"y":-0.32221609421335773,"xend":36,"yend":-0.32221609421335773,"mode":"lines","line":{"color":"black","dash":"dash"},"showlegend":false,"inherit":true},"3fae4c621333":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2111272410853271,-1.7444475421409684,-1.4941549086209043,-1.3129814789733738,-1.1669186011353174,-1.0422467418324088,-0.93197131234319031,-0.83200627001647287,-0.73973721941388981,-0.65337661097153532,-0.57163752516508581,-0.49355339508954554,-0.41837128791165423,-0.34548507371979864,-0.27439148786003692,-0.20465991857047608,-0.13591068064648049,-0.067798615441235707,0,0.067798615441235568,0.13591068064648049,0.20465991857047591,0.27439148786003692,0.34548507371979831,0.41837128791165423,0.49355339508954527,0.57163752516508581,0.6533766109715351,0.73973721941388981,0.83200627001647287,0.93197131234319031,1.0422467418324088,1.1669186011353174,1.3129814789733738,1.4941549086209047,1.7444475421409684,2.2111272410853284],"y":[-2.0122001531326341,-1.4717626184487422,-1.4421458881374765,-1.2778388721529199,-1.1655237635768638,-1.1626514100164873,-0.97980530766564966,-0.83582664457954503,-0.72819257580815044,-0.63053139202214026,-0.61643148073471732,-0.45261663124841123,-0.4020486636408736,-0.39870811021146235,-0.32827850316242141,-0.20566610029450252,-0.042265000346271384,-0.026430189844694786,0.057529007958587577,0.071776106986660496,0.076578627718634176,0.1380444910063667,0.22263397377982891,0.22909599613660414,0.25574878026173864,0.3185608321284697,0.41087893516797019,0.53195855539411363,0.71483648105090025,0.73356361386091573,0.76211078624984485,0.81094952756360295,1.0560652666401205,1.4145117023077334,2.0587547099868475,2.0857392427838404,2.2295866680411836],"type":"scatter","mode":"markers","marker":{"color":"#0072B5","size":6,"opacity":0.59999999999999998},"name":"Sample","showlegend":false,"inherit":true},"3fae4c621333.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-2.2111272410853271,-1.7444475421409684,-1.4941549086209043,-1.3129814789733738,-1.1669186011353174,-1.0422467418324088,-0.93197131234319031,-0.83200627001647287,-0.73973721941388981,-0.65337661097153532,-0.57163752516508581,-0.49355339508954554,-0.41837128791165423,-0.34548507371979864,-0.27439148786003692,-0.20465991857047608,-0.13591068064648049,-0.067798615441235707,0,0.067798615441235568,0.13591068064648049,0.20465991857047591,0.27439148786003692,0.34548507371979831,0.41837128791165423,0.49355339508954527,0.57163752516508581,0.6533766109715351,0.73973721941388981,0.83200627001647287,0.93197131234319031,1.0422467418324088,1.1669186011353174,1.3129814789733738,1.4941549086209047,1.7444475421409684,2.2111272410853284],"y":[-2.2111272410853271,-1.7444475421409684,-1.4941549086209043,-1.3129814789733738,-1.1669186011353174,-1.0422467418324088,-0.93197131234319031,-0.83200627001647287,-0.73973721941388981,-0.65337661097153532,-0.57163752516508581,-0.49355339508954554,-0.41837128791165423,-0.34548507371979864,-0.27439148786003692,-0.20465991857047608,-0.13591068064648049,-0.067798615441235707,0,0.067798615441235568,0.13591068064648049,0.20465991857047591,0.27439148786003692,0.34548507371979831,0.41837128791165423,0.49355339508954527,0.57163752516508581,0.6533766109715351,0.73973721941388981,0.83200627001647287,0.93197131234319031,1.0422467418324088,1.1669186011353174,1.3129814789733738,1.4941549086209047,1.7444475421409684,2.2111272410853284],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"inherit":true},"3fae101c4bb1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-178684.85272696431,-177961.36617724856,-177237.87962753282,-176514.39307781711,-175790.90652810136,-175067.41997838562,-174343.93342866987,-173620.44687895413,-172896.96032923838,-172173.47377952264,-171449.98722980692,-170726.50068009118,-170003.01413037544,-169279.52758065969,-168556.04103094395,-167832.55448122823,-167109.06793151249,-166385.58138179674,-165662.094832081,-164938.60828236525,-164215.12173264951,-163491.63518293377,-162768.14863321805,-162044.66208350231,-161321.17553378656,-160597.68898407082,-159874.20243435507,-159150.71588463936,-158427.22933492361,-157703.74278520787,-156980.25623549212,-156256.76968577638,-155533.28313606064,-154809.79658634489,-154086.31003662918,-153362.82348691343,-152639.33693719769,-151915.85038748194,-151192.3638377662,-150468.87728805048,-149745.39073833474,-149021.904188619,-148298.41763890325,-147574.93108918751,-146851.44453947176,-146127.95798975602,-145404.4714400403,-144680.98489032456,-143957.49834060881,-143234.01179089307,-142510.52524117735,-141787.03869146161,-141063.55214174587,-140340.06559203012,-139616.57904231438,-138893.09249259863,-138169.60594288289,-137446.11939316714,-136722.63284345143,-135999.14629373568,-135275.65974401994,-134552.1731943042,-133828.68664458848,-133105.20009487274,-132381.71354515699,-131658.22699544125,-130934.7404457255,-130211.25389600976,-129487.76734629403,-128764.28079657828,-128040.79424686256,-127317.30769714681,-126593.82114743107,-125870.33459771532,-125146.84804799959,-124423.36149828385,-123699.87494856812,-122976.38839885237,-122252.90184913663,-121529.41529942089,-120805.92874970516,-120082.44219998941,-119358.95565027368,-118635.46910055794,-117911.98255084219,-117188.49600112645,-116465.00945141072,-115741.52290169497,-115018.03635197924,-114294.5498022635,-113571.06325254776,-112847.57670283203,-112124.09015311628,-111400.60360340054,-110677.11705368481,-109953.63050396906,-109230.14395425332,-108506.65740453759,-107783.17085482184,-107059.6843051061,-106336.19775539037,-105612.71120567463,-104889.22465595888,-104165.73810624315,-103442.25155652741,-102718.76500681166,-101995.27845709593,-101271.79190738019,-100548.30535766445,-99824.818807948715,-99101.332258232971,-98377.845708517227,-97654.359158801497,-96930.872609085753,-96207.386059370008,-95483.899509654279,-94760.412959938534,-94036.92641022279,-93313.43986050706,-92589.953310791316,-91866.466761075571,-91142.980211359842,-90419.493661644097,-89696.007111928353,-88972.520562212623,-88249.034012496879,-87525.547462781135,-86802.060913065405,-86078.57436334966,-85355.087813633916,-84631.601263918186,-83908.114714202442,-83184.628164486698,-82461.141614770968,-81737.655065055224,-81014.168515339479,-80290.681965623749,-79567.195415908005,-78843.708866192261,-78120.222316476531,-77396.735766760787,-76673.249217045042,-75949.762667329313,-75226.276117613568,-74502.789567897824,-73779.303018182094,-73055.81646846635,-72332.329918750605,-71608.843369034876,-70885.356819319131,-70161.870269603387,-69438.383719887657,-68714.897170171913,-67991.410620456169,-67267.924070740439,-66544.437521024694,-65820.95097130895,-65097.46442159322,-64373.977871877476,-63650.491322161732,-62927.004772446002,-62203.518222730258,-61480.031673014513,-60756.545123298783,-60033.058573583039,-59309.572023867295,-58586.085474151565,-57862.598924435821,-57139.112374720076,-56415.625825004347,-55692.139275288602,-54968.652725572858,-54245.166175857128,-53521.679626141384,-52798.193076425639,-52074.70652670991,-51351.219976994165,-50627.733427278421,-49904.246877562691,-49180.760327846947,-48457.273778131203,-47733.787228415473,-47010.300678699743,-46286.814128983999,-45563.327579268254,-44839.84102955251,-44116.354479836766,-43392.867930121021,-42669.381380405306,-41945.894830689562,-41222.408280973817,-40498.921731258073,-39775.435181542329,-39051.948631826584,-38328.462082110869,-37604.975532395125,-36881.488982679381,-36158.002432963636,-35434.515883247892,-34711.029333532148,-33987.542783816432,-33264.056234100688,-32540.569684384944,-31817.083134669199,-31093.596584953455,-30370.110035237711,-29646.623485521995,-28923.136935806251,-28199.650386090507,-27476.163836374762,-26752.677286659018,-26029.190736943274,-25305.704187227559,-24582.217637511814,-23858.73108779607,-23135.244538080326,-22411.757988364581,-21688.271438648837,-20964.784888933122,-20241.298339217377,-19517.811789501633,-18794.325239785889,-18070.838690070144,-17347.3521403544,-16623.865590638685,-15900.37904092294,-15176.892491207196,-14453.405941491452,-13729.919391775707,-13006.432842059963,-12282.946292344248,-11559.459742628504,-10835.973192912759,-10112.486643197015,-9389.0000934812706,-8665.5135437655263,-7942.026994049811,-7218.5404443340667,-6495.0538946183224,-5771.567344902578,-5048.0807951868337,-4324.5942454710894,-3601.1076957553742,-2877.6211460396298,-2154.1345963238855,-1430.6480466081412,-707.16149689239683,16.325052823347505,739.81160253906273,1463.2981522548071,2186.7847019705514,2910.2712516862957,3633.7578014020401,4357.2443511177844,5080.7309008334996,5804.2174505492439,6527.7040002649883,7251.1905499807326,7974.6770996964769,8698.1636494121922,9421.6501991279365,10145.136748843681,10868.623298559425,11592.109848275169,12315.596397990914,13039.082947706629,13762.569497422373,14486.056047138118,15209.542596853862,15933.029146569606,16656.515696285351,17380.002246001066,18103.48879571681,18826.975345432555,19550.461895148299,20273.948444864043,20997.434994579788,21720.921544295503,22444.408094011247,23167.894643726991,23891.381193442736,24614.86774315848,25338.354292874224,26061.84084258994,26785.327392305684,27508.813942021428,28232.300491737173,28955.787041452917,29679.273591168661,30402.760140884377,31126.246690600121,31849.733240315865,32573.21979003161,33296.706339747354,34020.192889463098,34743.679439178813,35467.165988894558,36190.652538610302,36914.139088326046,37637.625638041791,38361.112187757535,39084.59873747325,39808.085287188995,40531.571836904739,41255.058386620483,41978.544936336228,42702.031486051972,43425.518035767687,44149.004585483432,44872.491135199176,45595.97768491492,46319.464234630665,47042.950784346409,47766.437334062124,48489.923883777868,49213.410433493613,49936.896983209357,50660.383532925101,51383.870082640846,52107.356632356561,52830.843182072305,53554.32973178805,54277.816281503794,55001.302831219538,55724.789380935283,56448.275930650998,57171.762480366742,57895.249030082487,58618.735579798231,59342.222129513975,60065.70867922972,60789.195228945435,61512.681778661179,62236.168328376923,62959.654878092668,63683.141427808412,64406.627977524156,65130.114527239872,65853.601076955616,66577.08762667136,67300.574176387105,68024.060726102849,68747.547275818593,69471.033825534309,70194.520375250053,70918.006924965797,71641.493474681542,72364.980024397286,73088.46657411303,73811.953123828745,74535.43967354449,75258.926223260234,75982.412772975978,76705.899322691723,77429.385872407467,78152.872422123182,78876.358971838927,79599.845521554671,80323.332071270415,81046.81862098616,81770.305170701904,82493.791720417619,83217.278270133364,83940.764819849137,84664.251369564823,85387.737919280567,86111.224468996312,86834.711018712056,87558.1975684278,88281.684118143545,89005.170667859289,89728.657217575033,90452.143767290778,91175.630317006522,91899.116866722266,92622.603416438011,93346.089966153697,94069.576515869441,94793.063065585186,95516.54961530093,96240.036165016674,96963.522714732419,97687.009264448163,98410.495814163907,99133.982363879652,99857.468913595396,100580.95546331114,101304.44201302683,102027.92856274257,102751.41511245831,103474.90166217406,104198.3882118898,104921.87476160555,105645.36131132129,106368.84786103704,107092.33441075278,107815.82096046853,108539.30751018427,109262.79405990001,109986.2806096157,110709.76715933144,111433.25370904719,112156.74025876293,112880.22680847868,113603.71335819442,114327.19990791017,115050.68645762591,115774.17300734165,116497.6595570574,117221.14610677314,117944.63265648889,118668.11920620457,119391.60575592032,120115.09230563606,120838.57885535181,121562.06540506755,122285.5519547833,123009.03850449904,123732.52505421478,124456.01160393053,125179.49815364627,125902.98470336202,126626.47125307776,127349.95780279345,128073.44435250919,128796.93090222494,129520.41745194068,130243.90400165642,130967.39055137217,131690.87710108791,132414.36365080366,133137.8502005194,133861.33675023515,134584.82329995089,135308.30984966664,136031.79639938232,136755.28294909807,137478.76949881381,138202.25604852955,138925.7425982453,139649.22914796104,140372.71569767679,141096.20224739253,141819.68879710828,142543.17534682402,143266.66189653976,143990.14844625551,144713.6349959712,145437.12154568694,146160.60809540268,146884.09464511843,147607.58119483417,148331.06774454992,149054.55429426566,149778.04084398141,150501.52739369715,151225.01394341289,151948.50049312864,152671.98704284438,153395.47359256007,154118.96014227581,154842.44669199156,155565.9332417073,156289.41979142305,157012.90634113879,157736.39289085453,158459.87944057028,159183.36599028602,159906.85254000177,160630.33908971751,161353.82563943326,162077.31218914894,162800.79873886469,163524.28528858043,164247.77183829618,164971.25838801192,165694.74493772766,166418.23148744341,167141.71803715915,167865.2045868749,168588.69113659064,169312.17768630639,170035.66423602213,170759.15078573782,171482.63733545356,172206.12388516931,172929.61043488505,173653.09698460079,174376.58353431654,175100.07008403228,175823.55663374803,176547.04318346377,177270.52973317952,177994.01628289526,178717.502832611,179440.98938232669,180164.47593204243,180887.96248175818,181611.44903147392,182334.93558118967,183058.42213090541,183781.90868062116,184505.3952303369,185228.88178005264,185952.36832976839,186675.85487948413,187399.34142919988,188122.82797891556,188846.31452863131,189569.80107834705,190293.2876280628,191016.77417777854],"y":[5.6285264277744005e-09,6.2249760145433192e-09,6.8849148864194077e-09,7.5920709726210138e-09,8.3640522328365455e-09,9.2217984326913607e-09,1.0138609774231647e-08,1.1127395873240869e-08,1.2229848553097351e-08,1.3405164571835711e-08,1.4658476316392297e-08,1.6059716287311916e-08,1.7549587655422798e-08,1.9129114259453513e-08,2.088294578047041e-08,2.2750506104641661e-08,2.4725538613651816e-08,2.6891304913489455e-08,2.9206291744521999e-08,3.1648250366962599e-08,3.4295037724874285e-08,3.7132904709838665e-08,4.0118604175037317e-08,4.3319922166556193e-08,4.6760518720055035e-08,5.0370724169619909e-08,5.4203094084454587e-08,5.8328922975209176e-08,6.2646494369733623e-08,6.7187701249681827e-08,7.2081806746153991e-08,7.718949826308131e-08,8.2516575218176183e-08,8.826016225416063e-08,9.4238191892412967e-08,1.0045186385777833e-07,1.0709517926289998e-07,1.1401873246957253e-07,1.2119691791757974e-07,1.2880113702649208e-07,1.3673801078818975e-07,1.4494614613079865e-07,1.5356890888194164e-07,1.6257753275897989e-07,1.7187122850290966e-07,1.8156076328546057e-07,1.9168884460042847e-07,2.0211275241873365e-07,2.1290715440294254e-07,2.2419118031262691e-07,2.3577877819504845e-07,2.4770613043467166e-07,2.6017191579373334e-07,2.7294638110761953e-07,2.8602978415669923e-07,2.9969023480321081e-07,3.1366649153897956e-07,3.2795475030937184e-07,3.4278415051419852e-07,3.5797206646511188e-07,3.73474281434701e-07,3.8948069594556273e-07,4.0588927562944475e-07,4.2261499161076253e-07,4.3980872165655947e-07,4.5745100290534306e-07,4.7541523873695386e-07,4.9381335451083508e-07,5.1271158549196687e-07,5.3193999913235597e-07,5.5157081955869834e-07,5.717613850650863e-07,5.9229501762206974e-07,6.1320205427510545e-07,6.3473955198384914e-07,6.5663854117042921e-07,6.7890031020867857e-07,7.0184324858039287e-07,7.251889070091081e-07,7.4892215270715936e-07,7.7333167321436126e-07,7.9822639829784186e-07,8.235389834900886e-07,8.4952349073918305e-07,8.7608811254647774e-07,9.0310513157799375e-07,9.3078672535512107e-07,9.5915510056026447e-07,9.8801268245382199e-07,1.0175207846903501e-06,1.0478316946567893e-06,1.0786681778498013e-06,1.1101310138300096e-06,1.1425177015192359e-06,1.1754625986246718e-06,1.208996960647153e-06,1.2435749175298721e-06,1.2787363591488425e-06,1.3144824545768889e-06,1.3512901525891897e-06,1.3887417306417487e-06,1.4267910359366476e-06,1.4658375401142699e-06,1.5056056350291568e-06,1.5459697654696781e-06,1.5872432913953938e-06,1.6292960403833695e-06,1.6719256977757106e-06,1.7153561636945948e-06,1.7595951939065356e-06,1.8043728749503516e-06,1.8498267198236158e-06,1.8960826255756751e-06,1.9428193187514117e-06,1.9900979588057844e-06,2.0381302529842346e-06,2.0865667620675784e-06,2.135409121100765e-06,2.184911055602589e-06,2.2347242317672262e-06,2.2848424449350337e-06,2.3354217338837955e-06,2.3862354947529779e-06,2.4372477691056899e-06,2.4885186176057781e-06,2.5399192178327661e-06,2.5914043920521202e-06,2.6429649447895518e-06,2.6945195785654985e-06,2.7460430596499619e-06,2.7974866068565343e-06,2.8487641062721184e-06,2.8998989149613261e-06,2.9508326485712018e-06,3.0014248253795063e-06,3.0517728368619152e-06,3.101836305073666e-06,3.1513783902909929e-06,3.2005902228662155e-06,3.2494670041467177e-06,3.2976608849946032e-06,3.3454529721195363e-06,3.3928455316432309e-06,3.4395133197035489e-06,3.4856809134814426e-06,3.5314075430896459e-06,3.5764145630505159e-06,3.6208397412894923e-06,3.6648069012152772e-06,3.7080994403191872e-06,3.7507535954343069e-06,3.7929567888100052e-06,3.8345609168355427e-06,3.8755016556679534e-06,3.9160207769660752e-06,3.956036562776233e-06,3.9953993999862428e-06,4.0343890696699894e-06,4.0729807443112061e-06,4.1109663861054759e-06,4.1486421779981999e-06,4.18601229575892e-06,4.2228834425324988e-06,4.2595052160116009e-06,4.2958951541133989e-06,4.3319429074560822e-06,4.3677966453091174e-06,4.403496627186736e-06,4.438995961466275e-06,4.4743755690484305e-06,4.5096788071727635e-06,4.5449011281479844e-06,4.5800915661505107e-06,4.6152779930766749e-06,4.6504776651565363e-06,4.6857405760325308e-06,4.7210633537538737e-06,4.7564668741587543e-06,4.7920295429494145e-06,4.827705080148635e-06,4.8635033911979755e-06,4.8995514878586123e-06,4.9357532862305331e-06,4.9721108148478553e-06,5.0087715001299355e-06,5.045627722303508e-06,5.0826670341672815e-06,5.1200229517734885e-06,5.1576171995178097e-06,5.195410133730314e-06,5.2335121571108892e-06,5.2718866128631499e-06,5.3104647356965464e-06,5.3493288463946534e-06,5.3884887010048676e-06,5.4278478946342043e-06,5.4674592878137301e-06,5.507377279917658e-06,5.5474821018191613e-06,5.587798742732005e-06,5.6284186840596868e-06,5.6692054143560878e-06,5.7101601990707121e-06,5.7513985534487062e-06,5.7927760819206789e-06,5.8342907659261963e-06,5.8760218829308355e-06,5.9178699396366935e-06,5.9598183099776932e-06,6.001905323802861e-06,6.0440699899199224e-06,6.0862879115608234e-06,6.1285619835049078e-06,6.1708488836893127e-06,6.2131295614377371e-06,6.2553802656199597e-06,6.2975462851381201e-06,6.33963176171543e-06,6.3815994768332037e-06,6.4233442107815828e-06,6.4649170009748591e-06,6.5062858509958753e-06,6.5472442298749351e-06,6.5879205749586282e-06,6.6283077619372041e-06,6.6680507843976658e-06,6.7073770290102482e-06,6.746283163080403e-06,6.7843647604089711e-06,6.821818186073349e-06,6.8587023864320148e-06,6.8945908005655094e-06,6.9295859038217786e-06,6.9638472403556001e-06,6.9969607314074712e-06,7.0288614396000544e-06,7.0598528602728111e-06,7.0895739883572979e-06,7.1177117114609582e-06,7.1447596605315983e-06,7.1704542056493295e-06,7.1941509917121543e-06,7.2165798016862326e-06,7.2376193815858104e-06,7.2562148476339799e-06,7.2733744169535872e-06,7.2890883884093304e-06,7.3020416499348706e-06,7.3133364733759221e-06,7.3230382130429467e-06,7.3299558829768568e-06,7.3348732390910576e-06,7.3380768092005665e-06,7.3385469516359708e-06,7.3366820084897972e-06,7.3330156190912186e-06,7.3267372691075555e-06,7.317813058526011e-06,7.3070372592065755e-06,7.2938341388724604e-06,7.2777147559339166e-06,7.2597334730968674e-06,7.2395612494435281e-06,7.21625721774494e-06,7.1911207773455648e-06,7.1640673514033719e-06,7.1337327937705203e-06,7.1016327888802111e-06,7.0677726333134145e-06,7.0308336907696528e-06,6.9920902870792835e-06,6.95168926418426e-06,6.9086090721004896e-06,6.8636520117527469e-06,6.8171662226795646e-06,6.7684057257583382e-06,6.7177508179060382e-06,6.6657153431565146e-06,6.6117977099355962e-06,6.5560209291935161e-06,6.4990236376959274e-06,6.4405111234661936e-06,6.3802225425869084e-06,6.3188783725041283e-06,6.2563502422891657e-06,6.1921698978664234e-06,6.1270976277204499e-06,6.0611307217550039e-06,5.9936681739002261e-06,5.9254713092435087e-06,5.856549306652282e-06,5.7864633160281011e-06,5.7157161779570514e-06,5.6443913189336333e-06,5.5722072969972525e-06,5.4994467821733147e-06,5.4262450694587562e-06,5.3524395632012976e-06,5.2781624247761157e-06,5.203569817270509e-06,5.1285837222734124e-06,5.0532486679601929e-06,4.9777143714362596e-06,4.9019570742138756e-06,4.8259905504441653e-06,4.7499336068812567e-06,4.6737895236908801e-06,4.5975937932624985e-06,4.5214115335512523e-06,4.4452489625345648e-06,4.3692098696126527e-06,4.2932867707987378e-06,4.2174846428549195e-06,4.1419609155500896e-06,4.0666765495971463e-06,3.9916141386890387e-06,3.9169610036725899e-06,3.8426960459934024e-06,3.7687550016772549e-06,3.6953311829195905e-06,3.6224708173132065e-06,3.5500377601505242e-06,3.4782067625681382e-06,3.407141219276885e-06,3.3366074633500965e-06,3.2667364331174791e-06,3.1978587737803928e-06,3.1296173910503554e-06,3.0620738251285755e-06,2.995775395747083e-06,2.9302161159495502e-06,2.8654021324852256e-06,2.8020270681465511e-06,2.7395296774333414e-06,2.6778764387276217e-06,2.6177139166314618e-06,2.5586408682476923e-06,2.500504892264799e-06,2.4438786685794198e-06,2.3885675575383219e-06,2.3342784388149928e-06,2.2814852226923076e-06,2.2302416272993518e-06,2.1800950457644763e-06,2.1313985811543149e-06,2.0844895722334008e-06,2.0387410178897104e-06,1.9943668092985004e-06,1.9520152135320868e-06,1.9108744531115155e-06,1.8710051004223976e-06,1.8333844171513013e-06,1.7970105571312073e-06,1.7618851427864482e-06,1.729011286246423e-06,1.6975081838057363e-06,1.6672724361785127e-06,1.6391450885015364e-06,1.6125568461123367e-06,1.5872377985320122e-06,1.5638572187512229e-06,1.5421635725148237e-06,1.5217225723546177e-06,1.5030277813089802e-06,1.48613934634491e-06,1.4704672804911146e-06,1.456331860849996e-06,1.4440854044532535e-06,1.4329980448593227e-06,1.423226158492578e-06,1.4153802993281376e-06,1.4086142328702678e-06,1.4029373016686603e-06,1.3991692422755325e-06,1.3963790447437314e-06,1.3945595619176964e-06,1.3943577374135997e-06,1.3951151800213745e-06,1.3967169907075797e-06,1.3996117924537853e-06,1.4034079019628375e-06,1.4079007009231593e-06,1.4133669830814929e-06,1.4196176966238277e-06,1.4263983643552537e-06,1.4338483190964324e-06,1.4419042796432697e-06,1.4503079238694755e-06,1.4591022191028258e-06,1.4682629601445806e-06,1.4775783517484065e-06,1.4870409945074591e-06,1.4965733897961014e-06,1.5060625487702155e-06,1.5154964558072045e-06,1.5246596015017648e-06,1.5335808759033515e-06,1.5422515021323712e-06,1.550359094412273e-06,1.557992684185881e-06,1.5651903491455985e-06,1.5715976766067313e-06,1.5772722295276906e-06,1.5823431414301043e-06,1.5864659541413795e-06,1.5895846421188692e-06,1.5919565323255595e-06,1.5932928546622118e-06,1.5933572536125466e-06,1.5925623289006651e-06,1.5907114621766188e-06,1.5873416218573457e-06,1.5830352681069779e-06,1.5777127428546349e-06,1.5706620427533674e-06,1.5626359651063259e-06,1.553633346091125e-06,1.5428471680860059e-06,1.5310360248295234e-06,1.5182521885437762e-06,1.5038424833534801e-06,1.4883235290455201e-06,1.4718738600361163e-06,1.4540027356469227e-06,1.4349884899364348e-06,1.4151204677816696e-06,1.3940648141344218e-06,1.3718892692484344e-06,1.3489669753645484e-06,1.3251029446854357e-06,1.300202271100295e-06,1.2746857450986712e-06,1.2484692442768383e-06,1.2213583115214601e-06,1.193779159051715e-06,1.1657235898695797e-06,1.1369698589326081e-06,1.1079047129022118e-06,1.0785377776461947e-06,1.0487537706754349e-06,1.0187972718521533e-06,9.8869715127195125e-07,9.5845420248435113e-07,9.2819309604081376e-07,8.979405052200961e-07,8.6777005883133848e-07,8.3775981533221667e-07,8.0789821907766352e-07,7.782907335289441e-07,7.4903582132681101e-07,7.2005290816141553e-07,6.9144303810615664e-07,6.6338163100166616e-07,6.3569538352107168e-07,6.0845122181210645e-07,5.8194475593960732e-07,5.5589442110979943e-07,5.303109478420735e-07,5.0563857892406387e-07,4.8148048739925016e-07,4.5783923281344131e-07,4.3513478223456676e-07,4.1304265578137624e-07,3.9150147093152879e-07,3.7086805934093048e-07,3.5093720032357982e-07,3.3157101025852537e-07,3.1305122249980545e-07,2.9530581099074253e-07,2.7812088392584098e-07,2.6169841809847769e-07,2.4610105386479546e-07,2.3104502885341464e-07,2.1665398167042026e-07,2.0311659568841848e-07,1.9008963099566805e-07,1.7762448761574549e-07,1.660198003823153e-07,1.5488604603574697e-07,1.4422066966763991e-07,1.3438454888322378e-07,1.2498326205373585e-07,1.1600499402262883e-07,1.0772248793657037e-07,9.9878253495771396e-08,9.240912817134442e-08,8.5511331474513456e-08,7.9043005763494078e-08,7.2901592693454031e-08,6.7219275765059037e-08,6.1947424739412046e-08,5.6955813867654283e-08,5.232500889291652e-08,4.807775081456431e-08,4.4066938384355064e-08,4.03331673567688e-08,3.6950447029231097e-08,3.376417907601509e-08,3.0785398444940705e-08,2.812181014607073e-08,2.5619022165945708e-08,2.3275011768297319e-08,2.1193755490185172e-08,1.924980082756946e-08,1.7433921026541728e-08,1.5816352747125643e-08,1.4323240583940268e-08,1.2932000176289121e-08,1.1687748162347211e-08,1.0553618509916396e-08,9.4994096042472377e-09,8.5521102506096278e-09],"type":"scatter","mode":"lines","fill":"tozeroy","fillcolor":"rgba(0, 114, 181, 0.3)","line":{"color":"#0072B5","width":2},"name":"Density","showlegend":false,"inherit":true},"3fae101c4bb1.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[-114148.26831454039,-111717.67782888489,-109287.08734322937,-106856.49685757387,-104425.90637191836,-101995.31588626286,-99564.725400607349,-97134.13491495185,-94703.544429296337,-92272.953943640838,-89842.363457985339,-87411.772972329825,-84981.182486674326,-82550.592001018813,-80120.001515363314,-77689.411029707815,-75258.820544052302,-72828.230058396788,-70397.639572741289,-67967.04908708579,-65536.458601430277,-63105.868115774778,-60675.277630119272,-58244.687144463765,-55814.096658808259,-53383.506173152753,-50952.915687497247,-48522.325201841741,-46091.734716186242,-43661.144230530728,-41230.553744875229,-38799.963259219716,-36369.372773564217,-33938.782287908718,-31508.191802253205,-29077.601316597706,-26647.010830942192,-24216.420345286693,-21785.82985963118,-19355.239373975681,-16924.648888320167,-14494.058402664668,-12063.467917009169,-9632.877431353656,-7202.2869456981571,-4771.6964600426436,-2341.1059743871447,89.484511268368806,2520.0749969238677,4950.6654825793667,7381.2559682348801,9811.8464538903791,12242.436939545893,14673.027425201391,17103.617910856905,19534.208396512404,21964.798882167903,24395.389367823402,26825.97985347893,29256.570339134429,31687.160824789928,34117.751310445426,36548.341796100955,38978.932281756453,41409.522767411952,43840.113253067451,46270.70373872295,48701.294224378478,51131.884710033977,53562.475195689476,55993.065681344975,58423.656167000503,60854.246652656002,63284.837138311501,65715.427623967,68146.018109622499,70576.608595278027,73007.199080933526,75437.789566589025,77868.380052244524,80298.970537900052,82729.56102355555,85160.151509211049,87590.741994866548,90021.332480522047,92451.922966177575,94882.513451833074,97313.103937488573,99743.694423144072,102174.28490879957,104604.8753944551,107035.4658801106,109466.0563657661,111896.6468514216,114327.23733707712,116757.82782273262,119188.41830838812,121619.00879404362,124049.59927969912,126480.18976535462],"y":[9.2873906400876005e-07,1.0114349173237109e-06,1.0994738151474515e-06,1.1929838312890762e-06,1.2920726784651315e-06,1.3968251547129331e-06,1.507300594015507e-06,1.6235303506601936e-06,1.745515348823008e-06,1.8732237305206576e-06,2.0065886363479059e-06,2.1455061542685981e-06,2.2898334721073936e-06,2.4393872692546399e-06,2.5939423824141022e-06,2.7532307789657914e-06,2.9169408696659414e-06,3.0847171899557436e-06,3.2561604761026892e-06,3.4308281587678753e-06,3.6082352924058598e-06,3.7878559341991228e-06,3.9691249810572049e-06,4.1514404676332792e-06,4.334166322401245e-06,4.5166355726772672e-06,4.6981539831528503e-06,4.8780041061311758e-06,5.0554497153291502e-06,5.2297405889330631e-06,5.4001176016859442e-06,5.5658180802493323e-06,5.7260813710280923e-06,5.8801545651758088e-06,6.0272983217046247e-06,6.1667927265920456e-06,6.297943123581462e-06,6.4200858510729085e-06,6.5325938191408494e-06,6.6348818613249963e-06,6.726411797429915e-06,6.8066971461326716e-06,6.8753074297104893e-06,6.9318720176196987e-06,6.9760834609230378e-06,7.0077002755983704e-06,7.0265491394763739e-06,7.0325264748430605e-06,7.0255993964885102e-06,7.0058060130607691e-06,6.9732550778610617e-06,6.9281249935574816e-06,6.8706621835614421e-06,6.8011788508686996e-06,6.7200501528828403e-06,6.6277108279889818e-06,6.5246513163134145e-06,6.4114134230871396e-06,6.288585578237133e-06,6.156797750183562e-06,6.0167160752652173e-06,5.8690372667078726e-06,5.7144828685678375e-06,5.5537934206202064e-06,5.3877225997311711e-06,5.217031401885872e-06,5.0424824267837181e-06,4.864834323823037e-06,4.6848364544502767e-06,4.5032238213316586e-06,4.3207123097121714e-06,4.1379942807600406e-06,3.9557345507618835e-06,3.7745667838439228e-06,3.5950903195584597e-06,3.4178674503000718e-06,3.2434211572075948e-06,3.0722333070640986e-06,2.9047433068191e-06,2.741347206807506e-06,2.5823972386001906e-06,2.4282017687531567e-06,2.2790256455751924e-06,2.1350909124456941e-06,1.9965778582101197e-06,1.8636263727743399e-06,1.7363375742130175e-06,1.6147756724926854e-06,1.4989700342688841e-06,1.3889174131211555e-06,1.2845843100046419e-06,1.1859094295806745e-06,1.09280619939378e-06,1.0051653205378493e-06,9.2285732044561859e-07,8.457350806877593e-07,7.7363631512472169e-07,7.0638597636111394e-07,6.4379857115537314e-07,5.8568036818629018e-07],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":2},"name":"Normal","showlegend":false,"inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Using lags in our model requires us to use a recursive function to create a forecast if the lag index is smaller than forecast horizon. In the above example, we train a model with lag 1, this mean we can use the last observation in the actual series as the first lag in the future data frame:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>lag1 <span class="ot">&lt;-</span> <span class="fu">c</span>(ts1<span class="sc">$</span>y[<span class="fu">nrow</span>(ts1)], <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">4</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>future_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 5 x 7 [1Y]
  index trend      yhat     lower     upper trend2     lag1
  &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;
1  2025    39 11789931. 11432704. 12147157.     17 11428636
2  2026    40 11883944. 11525312. 12242577.     18       NA
3  2027    41 11977958. 11617854. 12338061.     19       NA
4  2028    42 12071971. 11710334. 12433609.     20       NA
5  2029    43 12165985. 11802750. 12529220.     21       NA</code></pre>
</div>
</div>
<p>Let’s now create a place holder for the forecast fields:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>yhat3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>lower3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>upper3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we can create the forecast for the first row and update the <code>lag1</code> field of the second row with the prediction of the first row, and then repeat this process recursively:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fc3_temp <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">object =</span> md3,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">newdata =</span> future_data[<span class="dv">1</span>, ],</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">interval =</span> <span class="st">"prediction"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>yhat3[<span class="dv">1</span>] <span class="ot">&lt;-</span> fc3_temp[, <span class="dv">1</span>]</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>lower3[<span class="dv">1</span>] <span class="ot">&lt;-</span> fc3_temp[, <span class="dv">2</span>]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>upper3[<span class="dv">1</span>] <span class="ot">&lt;-</span> fc3_temp[, <span class="dv">3</span>]</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>future_data<span class="sc">$</span>lag1[<span class="dv">2</span>] <span class="ot">&lt;-</span> future_data<span class="sc">$</span>yhat3[<span class="dv">1</span>]</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>future_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 5 x 10 [1Y]
  index trend      yhat     lower   upper trend2    lag1   yhat3  lower3  upper3
  &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1  2025    39 11789931. 11432704.  1.21e7     17  1.14e7  1.15e7  1.14e7  1.16e7
2  2026    40 11883944. 11525312.  1.22e7     18  1.15e7 NA      NA      NA     
3  2027    41 11977958. 11617854.  1.23e7     19 NA      NA      NA      NA     
4  2028    42 12071971. 11710334.  1.24e7     20 NA      NA      NA      NA     
5  2029    43 12165985. 11802750.  1.25e7     21 NA      NA      NA      NA     </code></pre>
</div>
</div>
<p>Let’s generalize it with a <code>for</code> loop:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>min_lag <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> (min_lag <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>h) {</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    fc3_temp <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">object =</span> md3,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata =</span> future_data[i, ],</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    future_data<span class="sc">$</span>yhat3[i] <span class="ot">&lt;-</span> fc3_temp[, <span class="dv">1</span>]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    future_data<span class="sc">$</span>lower3[i] <span class="ot">&lt;-</span> fc3_temp[, <span class="dv">2</span>]</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    future_data<span class="sc">$</span>upper3[i] <span class="ot">&lt;-</span> fc3_temp[, <span class="dv">3</span>]</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&lt;</span> h) {</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>        future_data<span class="sc">$</span>lag1[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> future_data<span class="sc">$</span>yhat3[i]</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>future_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 5 x 10 [1Y]
  index trend      yhat     lower     upper trend2     lag1  yhat3 lower3 upper3
  &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1  2025    39 11789931. 11432704. 12147157.     17   1.14e7 1.15e7 1.14e7 1.16e7
2  2026    40 11883944. 11525312. 12242577.     18   1.15e7 1.16e7 1.14e7 1.17e7
3  2027    41 11977958. 11617854. 12338061.     19   1.16e7 1.16e7 1.15e7 1.18e7
4  2028    42 12071971. 11710334. 12433609.     20   1.16e7 1.17e7 1.16e7 1.18e7
5  2029    43 12165985. 11802750. 12529220.     21   1.17e7 1.18e7 1.16e7 1.19e7</code></pre>
</div>
</div>
<p>Likewise, we can use the <code>lm_forecast</code> to create the forecast:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>fc3 <span class="ot">&lt;-</span> <span class="fu">lm_forecast</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> md3,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual =</span> ts1,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">future_data =</span> future_data,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_col =</span> <span class="st">"y"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag_col =</span> <span class="st">"lag1"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Let’s plot the forecast</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_lm_forecast</span>(fc3, <span class="at">actual_col =</span> <span class="st">"y"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e7c5aaa1aa1021c1672a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e7c5aaa1aa1021c1672a">{"x":{"visdat":{"3fae322e7db2":["function () ","plotlyVisDat"]},"cur_data":"3fae322e7db2","attrs":{"3fae322e7db2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#1f77b4"},"showlegend":true,"inherit":true},"3fae322e7db2.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2002,2003,2004,2005,2007,2008,2009,2010,2011,2012,2013,2014,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8071420.3384115035,8267772.383452327,8457296.6928584166,8631510.4893466961,8762423.1795348469,8809677.2800322585,8856687.9920519721,8921123.4821806662,8994984.076302316,9095441.9795773495,9184325.6126790009,9301029.0080050379,9443286.3565951567,9703333.6234136391,9821933.6119715478,9897503.4361195955,10044190.455003811,10395986.911890538,10502165.822062096,10577067.935178874,10578352.84059234,10612560.400238072,10693583.044733632,10750836.278652532,10823028.972866639,10986781.652930627,11073203.847842732,11097585.860566163,11182005.84083155,11255359.452161919,11302946.948951423,11351980.999900825,11430135.334147897],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6},"name":"Fitted","showlegend":true,"inherit":true},"3fae322e7db2.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2001,2006,2015,2016],"y":[9484801.999701418,10202743.810234645,10852807.780665359,11030516.26831454],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6},"showlegend":false,"inherit":true},"3fae322e7db2.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2025,2026,2027,2028,2029],"ymin":[11368117.651403897,11436030.866513023,11503339.25135049,11570084.21318049,11636304.31520105],"ymax":[11628882.230414119,11699608.490221472,11769939.936153768,11839916.684840284,11909575.048465373],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"95% PI","line":{"color":"rgba(7, 164, 181, 0.05)"},"fillcolor":"rgba(7, 164, 181, 0.2)","showlegend":true,"inherit":true},"3fae322e7db2.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2025,2026,2027,2028,2029],"y":[11498499.940909008,11567819.678367248,11636639.593752129,11705000.449010387,11772939.681833211],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"black","dash":"dash"},"showlegend":true,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Value"},"xaxis":{"domain":[0,1],"automargin":true,"title":""},"legend":{"orientation":"h","xanchor":"center","x":0.5,"y":-0.20000000000000001},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024],"y":[7904858,8113034,8313776,8497848,8634774,8680613,8726187,8790733,8865541,8969308,9060473,9181928,9331206,9370797,9603122,9726642,9803311,9957412,10124433,10329224,10439220,10515162,10510950,10542584,10625190,10681916,10754908,10781720,10969597,10916368,11004853,11025789,11112094,11186350,11232552,11280329,11359812,11428636],"type":"scatter","mode":"lines","name":"Actual","line":{"color":"#1f77b4"},"showlegend":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2002,2003,2004,2005,2007,2008,2009,2010,2011,2012,2013,2014,2017,2018,2019,2020,2021,2022,2023,2024],"y":[8071420.3384115035,8267772.383452327,8457296.6928584166,8631510.4893466961,8762423.1795348469,8809677.2800322585,8856687.9920519721,8921123.4821806662,8994984.076302316,9095441.9795773495,9184325.6126790009,9301029.0080050379,9443286.3565951567,9703333.6234136391,9821933.6119715478,9897503.4361195955,10044190.455003811,10395986.911890538,10502165.822062096,10577067.935178874,10578352.84059234,10612560.400238072,10693583.044733632,10750836.278652532,10823028.972866639,10986781.652930627,11073203.847842732,11097585.860566163,11182005.84083155,11255359.452161919,11302946.948951423,11351980.999900825,11430135.334147897],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6,"line":{"color":"rgba(255,127,14,1)"}},"name":"Fitted","showlegend":true,"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2001,2006,2015,2016],"y":[9484801.999701418,10202743.810234645,10852807.780665359,11030516.26831454],"type":"scatter","mode":"markers","marker":{"color":"rgba(135, 206, 250, 0.6)","size":6,"line":{"color":"rgba(44,160,44,1)"}},"showlegend":false,"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(7, 164, 181, 0.2)","x":[2025,2026,2027,2028,2029,2029,2029,2028,2027,2026,2025],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","name":"95% PI","line":{"color":"rgba(7, 164, 181, 0.05)"},"showlegend":true,"y":[11368117.651403897,11436030.866513023,11503339.25135049,11570084.21318049,11636304.31520105,11636304.31520105,11909575.048465373,11839916.684840284,11769939.936153768,11699608.490221472,11628882.230414119],"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2025,2026,2027,2028,2029],"y":[11498499.940909008,11567819.678367248,11636639.593752129,11705000.449010387,11772939.681833211],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"black","dash":"dash"},"showlegend":true,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>